<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Diagnostics · VortexPasta</title><meta name="title" content="Diagnostics · VortexPasta"/><meta property="og:title" content="Diagnostics · VortexPasta"/><meta property="twitter:title" content="Diagnostics · VortexPasta"/><meta name="description" content="Documentation for VortexPasta."/><meta property="og:description" content="Documentation for VortexPasta."/><meta property="twitter:description" content="Documentation for VortexPasta."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/fonts.css" rel="stylesheet" type="text/css"/><script src="../../assets/sa.js" data-collect-dnt="true" async></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">VortexPasta</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">VortexPasta.jl</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/01-vortex_ring/">Vortex ring</a></li><li><a class="tocitem" href="../../tutorials/02-kelvin_waves/">Kelvin waves</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../methods/VFM/">The vortex filament model</a></li><li><a class="tocitem" href="../../methods/Ewald/">Ewald summation for Biot–Savart</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tips and tricks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tips/parallelisation/">Parallelisation</a></li><li><a class="tocitem" href="../../tips/gpu/">GPU usage</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Modules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PaddedArrays/">PaddedArrays</a></li><li><a class="tocitem" href="../PredefinedCurves/">PredefinedCurves</a></li><li><a class="tocitem" href="../CellLists/">CellLists</a></li><li><a class="tocitem" href="../Quadratures/">Quadratures</a></li><li><a class="tocitem" href="../Filaments/">Filaments</a></li><li><a class="tocitem" href="../FilamentIO/">FilamentIO</a></li><li><a class="tocitem" href="../FindNearbySegments/">FindNearbySegments</a></li><li><a class="tocitem" href="../Constants/">Constants</a></li><li><a class="tocitem" href="../BiotSavart/">BiotSavart</a></li><li><a class="tocitem" href="../SyntheticFields/">SyntheticFields</a></li><li><a class="tocitem" href="../Forcing/">Forcing</a></li><li><a class="tocitem" href="../Containers/">Containers</a></li><li><a class="tocitem" href="../Reconnections/">Reconnections</a></li><li><a class="tocitem" href="../Timestepping/">Timestepping</a></li><li class="is-active"><a class="tocitem" href>Diagnostics</a><ul class="internal"><li><a class="tocitem" href="#Kinetic-energy"><span>Kinetic energy</span></a></li><li><a class="tocitem" href="#Helicity"><span>Helicity</span></a></li><li><a class="tocitem" href="#Filament-length"><span>Filament length</span></a></li><li><a class="tocitem" href="#Stretching-rate"><span>Stretching rate</span></a></li><li><a class="tocitem" href="#Vortex-impulse"><span>Vortex impulse</span></a></li><li><a class="tocitem" href="#Energy-spectrum"><span>Energy spectrum</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Modules</a></li><li class="is-active"><a href>Diagnostics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Diagnostics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jipolanco/VortexPasta.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jipolanco/VortexPasta.jl/blob/master/docs/src/modules/Diagnostics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Diagnostics"><a class="docs-heading-anchor" href="#Diagnostics">Diagnostics</a><a id="Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics" href="#VortexPasta.Diagnostics"><code>VortexPasta.Diagnostics</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Diagnostics</code></pre><p>Contains tools for computing different diagnostics (total energy, energy spectra, ...) from simulation data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/Diagnostics.jl#L1-L6">source</a></section></article><h2 id="Kinetic-energy"><a class="docs-heading-anchor" href="#Kinetic-energy">Kinetic energy</a><a id="Kinetic-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Kinetic-energy" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.kinetic_energy" href="#VortexPasta.Diagnostics.kinetic_energy"><code>VortexPasta.Diagnostics.kinetic_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kinetic_energy(iter::VortexFilamentSolver; quad = nothing) -&gt; Real
kinetic_energy(fs, ψs, Γ::Real, [Ls]; quad = nothing) -&gt; Real
kinetic_energy(fs, ψs, p::ParamsBiotSavart; quad = nothing) -&gt; Real</code></pre><p>Compute kinetic energy of velocity field induced by a set of vortex filaments.</p><p>This function simply calls <a href="#VortexPasta.Diagnostics.kinetic_energy_from_streamfunction"><code>kinetic_energy_from_streamfunction</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/energy.jl#L7-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.kinetic_energy_from_streamfunction" href="#VortexPasta.Diagnostics.kinetic_energy_from_streamfunction"><code>VortexPasta.Diagnostics.kinetic_energy_from_streamfunction</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kinetic_energy_from_streamfunction(iter::VortexFilamentSolver; quad = nothing)
kinetic_energy_from_streamfunction(fs, ψs, Γ::Real, [Ls]; quad = nothing)
kinetic_energy_from_streamfunction(fs, ψs, p::ParamsBiotSavart; quad = nothing)</code></pre><p>Compute kinetic energy per unit mass (units <span>$L^2 T^{-2}$</span>) from streamfunction values at filament nodes in a periodic domain.</p><p>The kinetic energy per unit mass of the velocity field induced by a set of vortex filaments can be obtained as:</p><p class="math-container">\[E = \frac{Γ}{2V} ∮ \bm{ψ}(\bm{s}) ⋅ \mathrm{d}\bm{s}\]</p><p>where <span>$Γ$</span> is the vortex circulation and <span>$V$</span> is the volume of interest (e.g. the volume of a periodic cell in periodic domains).</p><p><strong>Arguments</strong></p><p><strong>Mandatory arguments</strong></p><ul><li><p><code>ψs</code>: streamfunction values at filament nodes;</p></li><li><p><code>fs</code>: vortex filament locations;</p></li><li><p><code>Γ::Real</code>: quantum of circulation.</p></li></ul><p><strong>Optional arguments</strong></p><ul><li><code>Ls::Tuple = (Lx, Ly, Lz)</code>: domain size in each direction. If not given, the domain volume <span>$V$</span> is taken to be 1 (see <strong>Non-periodic domains</strong> below).</li></ul><p><strong>Optional keyword arguments</strong></p><ul><li><code>quad = nothing</code>: optional quadrature rule (e.g. <code>quad = GaussLegendre(4)</code>) used to evaluate line integrals. If <code>nothing</code>, only values at nodes are used (cheaper). Otherwise, if a quadrature rule is passed, interpolations are performed and extra allocations are needed.</li></ul><p><strong>Non-periodic domains</strong></p><p>If the domain is not periodic, that is, if one or more values in <code>Ls</code> is <a href="../Constants/#VortexPasta.Constants.Infinity"><code>Infinity</code></a>, then the domain volume <span>$V$</span> in the expression above will be set to 1. This corresponds to computing an energy <em>per unit density</em> (units <span>$L^5 T^{-2}$</span>) instead of per unit mass, meaning that one should multiply by the fluid density <span>$ρ$</span> (<span>$M L^{-3}$</span>) to get an actual kinetic energy (<span>$M L^2 T^{-2}$</span>).</p><p>Note that in non-periodic domains one may also use the <a href="#VortexPasta.Diagnostics.kinetic_energy_nonperiodic"><code>kinetic_energy_nonperiodic</code></a> function, which uses a different definition commonly used for open domains and which does not require streamfunction values (but only velocity values on filament nodes). However, energy computed using that definition may not be properly conserved when it should.</p><p>Therefore, <strong>it is recommended to always use <code>kinetic_energy_from_streamfunction</code></strong>, even in non-periodic domains.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/energy.jl#L24-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.kinetic_energy_nonperiodic" href="#VortexPasta.Diagnostics.kinetic_energy_nonperiodic"><code>VortexPasta.Diagnostics.kinetic_energy_nonperiodic</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kinetic_energy_nonperiodic(iter::VortexFilamentSolver; quad = nothing) -&gt; Real
kinetic_energy_nonperiodic(fs, vs, Γ::Real; quad = nothing) -&gt; Real
kinetic_energy_nonperiodic(fs, vs, p::ParamsBiotSavart; quad = nothing) -&gt; Real</code></pre><p>Compute kinetic energy per unit density (units <span>$L^5 T^{-2}$</span>) from velocity values at filament nodes in an open (non-periodic) domain.</p><p>This function returns the kinetic energy <em>over the infinite fluid volume</em>, which only makes sense in an open domain such that the velocity tends to zero far from the vortices.</p><p>In an open domain, the kinetic energy of the velocity field induced by a set of vortex filaments can be obtained as:</p><p class="math-container">\[E = ρ Γ ∮ \bm{v} ⋅ (\bm{s} × \mathrm{d}\bm{s})\]</p><p>where <span>$Γ$</span> is the vortex circulation and <span>$ρ$</span> is the fluid density. This definition assumes that the velocity field tends to zero far from the vortices. This is true in open domains, but not in periodic ones.</p><div class="admonition is-warning"><header class="admonition-header">Energy conservation</header><div class="admonition-body"><p>Energy computed using this definition may present small temporal fluctuations in cases where energy should be conserved. For this reason, it is recommended to always use <a href="#VortexPasta.Diagnostics.kinetic_energy_from_streamfunction"><code>kinetic_energy_from_streamfunction</code></a>, which displays proper energy conservation properties. In general, this definition will slightly overestimate the energy obtained from the streamfunction.</p></div></div><p>This function returns the energy <em>per unit density</em> <span>$E / ρ$</span>.</p><p><strong>Mandatory arguments</strong></p><ul><li><p><code>vs</code>: velocity values at filament nodes;</p></li><li><p><code>fs</code>: vortex filament locations;</p></li><li><p><code>Γ::Real</code>: quantum of circulation.</p></li></ul><p><strong>Optional keyword arguments</strong></p><p>See <a href="#VortexPasta.Diagnostics.kinetic_energy_from_streamfunction"><code>kinetic_energy_from_streamfunction</code></a> for details.</p><p><strong>Periodic domains</strong></p><p>In periodic domains this function will give wrong results, since there are boundary terms coming from integration by parts which are neglected in the above definition (assuming the velocity goes to zero far from the vortices, which is not the case in a periodic domain).</p><p>In this case, the <a href="#VortexPasta.Diagnostics.kinetic_energy_from_streamfunction"><code>kinetic_energy_from_streamfunction</code></a> function should be used instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/energy.jl#L203-L258">source</a></section></article><h2 id="Helicity"><a class="docs-heading-anchor" href="#Helicity">Helicity</a><a id="Helicity-1"></a><a class="docs-heading-anchor-permalink" href="#Helicity" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.helicity" href="#VortexPasta.Diagnostics.helicity"><code>VortexPasta.Diagnostics.helicity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">helicity(iter::VortexFilamentSolver; quad = nothing) -&gt; Real
helicity(fs, vs, Γ::Real; quad = nothing) -&gt; Real
helicity(fs, vs, p::ParamsBiotSavart; quad = nothing) -&gt; Real</code></pre><p>Compute helicity of a vortex configuration.</p><p>The <a href="https://en.wikipedia.org/wiki/Hydrodynamical_helicity">helicity</a> is defined as:</p><p class="math-container">\[\mathcal{H}
= ∫ \bm{u}(\bm{x}) ⋅ \bm{ω}(\bm{x}) \, \mathrm{d}^3\bm{x}
= Γ ∮ \bm{v}(\bm{s}) ⋅ \mathrm{d}\bm{s}\]</p><p>where <span>$\bm{u}(\bm{x})$</span> and <span>$\bm{ω}(\bm{x}) = \bm{∇} × \bm{u}(\bm{x})$</span> are the velocity and vorticity fields, and <span>$\bm{v}(\bm{s})$</span> is the velocity of the set of vortex filaments.</p><p><strong>Arguments</strong></p><ul><li><code>fs</code>: list of vortex filaments (or a single <code>AbstractFilament</code>);</li><li><code>vs</code>: list of velocities on filament nodes (or a single vector of velocities on a filament);</li><li><code>Γ</code>: vortex circulation.</li></ul><p>See e.g. <a href="#VortexPasta.Diagnostics.kinetic_energy_from_streamfunction"><code>kinetic_energy_from_streamfunction</code></a> for the meaning of the optional <code>quad</code> keyword argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/helicity.jl#L5-L32">source</a></section></article><h2 id="Filament-length"><a class="docs-heading-anchor" href="#Filament-length">Filament length</a><a id="Filament-length-1"></a><a class="docs-heading-anchor-permalink" href="#Filament-length" title="Permalink"></a></h2><p>See <a href="../Filaments/#VortexPasta.Filaments.filament_length"><code>filament_length</code></a> in the <a href="../Filaments/#Filaments"><code>Filaments</code></a> module. For convenience, <code>filament_length</code> is re-exported by <code>Diagnostics</code>, meaning that one can do:</p><pre><code class="language-julia hljs">using VortexPasta.Diagnostics
filament_length(...)</code></pre><p>without needing to import <code>VortexPasta.Filaments</code>.</p><h2 id="Stretching-rate"><a class="docs-heading-anchor" href="#Stretching-rate">Stretching rate</a><a id="Stretching-rate-1"></a><a class="docs-heading-anchor-permalink" href="#Stretching-rate" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.stretching_rate" href="#VortexPasta.Diagnostics.stretching_rate"><code>VortexPasta.Diagnostics.stretching_rate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stretching_rate(iter::VortexFilamentSolver; quad = nothing) -&gt; Real
stretching_rate(fs, vs; quad = nothing) -&gt; Real</code></pre><p>Compute stretching rate of one or more vortices.</p><p>The stretching rate has units <span>$L T^{-1}$</span> and is given by:</p><p class="math-container">\[\frac{\mathrm{d} \mathcal{L}}{\mathrm{d} t}
= ∮ \frac{∂\bm{v}}{∂ξ} ⋅ \mathrm{d}\bm{s}
= - ∮ \bm{v} ⋅ \bm{s}&#39;&#39; \, \mathrm{d}ξ\]</p><p>where <span>$ξ$</span> is the arc length, <span>$\bm{v}(ξ)$</span> the local filament velocity, <span>$\bm{s}&#39;&#39;(ξ)$</span> the local curvature vector, and <span>$\mathcal{L}$</span> the instantaneous vortex length. The last equality is obtained using integration by parts.</p><p>In the implementation, the last expression is the one used to compute the stretching rate.</p><p><strong>Mandatory arguments</strong></p><ul><li><p><code>vs</code>: velocity values at filament nodes;</p></li><li><p><code>fs</code>: vortex filament locations.</p></li></ul><p><strong>Optional keyword arguments</strong></p><ul><li><code>quad = nothing</code>: optional quadrature rule (e.g. <code>quad = GaussLegendre(4)</code>) used to evaluate line integrals. If <code>nothing</code>, only values at nodes are used (cheaper).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/stretching.jl#L3-L33">source</a></section></article><h2 id="Vortex-impulse"><a class="docs-heading-anchor" href="#Vortex-impulse">Vortex impulse</a><a id="Vortex-impulse-1"></a><a class="docs-heading-anchor-permalink" href="#Vortex-impulse" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.vortex_impulse" href="#VortexPasta.Diagnostics.vortex_impulse"><code>VortexPasta.Diagnostics.vortex_impulse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vortex_impulse(iter::VortexFilamentSolver; quad = nothing) -&gt; Vec3
vortex_impulse(f; quad = nothing) -&gt; Vec3</code></pre><p>Estimate normalised impulse of one or more vortex filaments.</p><p>The vortex impulse is defined as</p><p class="math-container">\[\bm{p} = \frac{1}{2} ρ Γ ∮ \bm{s} × \mathrm{d}\bm{s}\]</p><p>where <span>$ρ$</span> is the fluid density and <span>$Γ$</span> the circulation about the vortex. Note that this function returns the <em>normalised</em> impulse <span>$\bm{p} / ρΓ$</span>. The returned impulse has units of <span>$L^2$</span> (an area).</p><p>Note that, for a circular vortex ring of radius <span>$R$</span>, its impulse is <span>$\bm{p} = ρΓA$</span> where <span>$A = π R^2$</span> is the area enclosed by the ring (and the orientation is equal to its direction of propagation, i.e. normal to the plane where the ring lives).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/vortex_impulse.jl#L3-L22">source</a></section></article><h2 id="Energy-spectrum"><a class="docs-heading-anchor" href="#Energy-spectrum">Energy spectrum</a><a id="Energy-spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-spectrum" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.energy_spectrum!" href="#VortexPasta.Diagnostics.energy_spectrum!"><code>VortexPasta.Diagnostics.energy_spectrum!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_spectrum!(Ek::AbstractVector, ks::AbstractVector, cache; unfilter = true)</code></pre><p>Compute kinetic energy spectrum associated to vortex filament state.</p><p>Here <code>cache</code> contains the results of long-range Biot–Savart computations. It can be either:</p><ul><li>a <a href="../BiotSavart/#VortexPasta.BiotSavart.LongRangeCache"><code>LongRangeCache</code></a>;</li><li>a <a href="../BiotSavart/#VortexPasta.BiotSavart.BiotSavartCache"><code>BiotSavartCache</code></a> (which contains a <code>LongRangeCache</code>);</li><li>a <code>VortexFilamentSolver</code> from the <code>Timestepping</code> module (which contains a <code>BiotSavartCache</code>).</li></ul><p>The energy spectrum is computed from a recent Biot–Savart calculation using fast Ewald summation. More precisely, it is computed from the long-range velocity field in Fourier space. The <a href="../BiotSavart/#VortexPasta.BiotSavart.LongRangeCache"><code>LongRangeCache</code></a> associated to the calculation is expected to currently contain this field.</p><p>In its most usual state, a <code>LongRangeCache</code> contains the long-range velocity field in the Ewald method, which is a Gaussian-filtered field (see e.g. <a href="../BiotSavart/#VortexPasta.BiotSavart.to_smoothed_velocity!"><code>BiotSavart.to_smoothed_velocity!</code></a>). By default this function undoes the Gaussian filter, so that the returned kinetic energy spectrum is that of the unsmoothed velocity (which is singular at vortex positions, so it presents a slow decay in wavenumber space). One can pass <code>unfilter = false</code> to return the spectrum associated to the smoothed field.</p><p>The cache can also contain an unsmoothed vorticity field in Fourier space (the result obtained right after performing a NUFFT from the filament locations, see <a href="../BiotSavart/#VortexPasta.BiotSavart.compute_vorticity_fourier!"><code>BiotSavart.compute_vorticity_fourier!</code></a>. In this case this function does the right thing and also computes the spectrum of the associated (unsmoothed) velocity field. Currently, the <code>unfilter</code> argument is ignored in this case.</p><p>The vectors <code>Ek</code> and <code>ks</code> are expected to have the same length. Moreover, the vector of wavenumbers <code>ks</code> should satisfy <code>ks[begin] == 0</code> and have a constant step <code>Δk = ks[i + 1] - ks[i]</code>. For convenience, the <a href="#VortexPasta.Diagnostics.init_energy_spectrum"><code>init_energy_spectrum</code></a> function can be used to create these vectors.</p><p>See also <a href="#VortexPasta.Diagnostics.energy_spectrum"><code>energy_spectrum</code></a> for an allocating variant which doesn&#39;t need predefined <code>Ek</code> and <code>ks</code> vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/spectra.jl#L16-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.energy_spectrum" href="#VortexPasta.Diagnostics.energy_spectrum"><code>VortexPasta.Diagnostics.energy_spectrum</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_spectrum(iter::VortexFilamentSolver; unfilter = true) -&gt; (ks, Ek)
energy_spectrum(cache; unfilter = true) -&gt; (ks, Ek)</code></pre><p>Compute kinetic energy spectrum associated to vortex filament state.</p><p>Returns a tuple of vectors <code>(ks, Ek)</code> where <code>ks</code> contains the probed wavenumbers and <code>Ek</code> the energy associated to each wavenumber.</p><p>See also <a href="#VortexPasta.Diagnostics.energy_spectrum!"><code>energy_spectrum!</code></a> for a non-allocating variant and for more details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/spectra.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Diagnostics.init_energy_spectrum" href="#VortexPasta.Diagnostics.init_energy_spectrum"><code>VortexPasta.Diagnostics.init_energy_spectrum</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Diagnostics.init_energy_spectrum(cache) -&gt; (ks, Ek)</code></pre><p>Initialise fields for storing an energy spectrum.</p><p>Returns a wavenumber vector <code>ks</code> and an uninitialised energy spectrum <code>Ek</code> with the right dimensions, which can be then passed to <a href="#VortexPasta.Diagnostics.energy_spectrum!"><code>energy_spectrum!</code></a>.</p><p>The returned arrays are always on the CPU, even when the <code>cache</code> contains GPU data.</p><p>See <a href="#VortexPasta.Diagnostics.energy_spectrum!"><code>energy_spectrum!</code></a> for details on the <code>cache</code> argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/3e56140b3ace4752540287e74b4a735b6078860a/src/Diagnostics/spectra.jl#L57-L68">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Timestepping/">« Timestepping</a><a class="docs-footer-nextpage" href="../../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 5 March 2025 18:30">Wednesday 5 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
