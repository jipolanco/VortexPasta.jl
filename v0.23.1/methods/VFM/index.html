<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The vortex filament model · VortexPasta</title><meta name="title" content="The vortex filament model · VortexPasta"/><meta property="og:title" content="The vortex filament model · VortexPasta"/><meta property="twitter:title" content="The vortex filament model · VortexPasta"/><meta name="description" content="Documentation for VortexPasta."/><meta property="og:description" content="Documentation for VortexPasta."/><meta property="twitter:description" content="Documentation for VortexPasta."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/fonts.css" rel="stylesheet" type="text/css"/><script src="../../assets/tomate.js"></script><script src="../../assets/sa.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">VortexPasta</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">VortexPasta.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/01-vortex_ring/">Vortex ring</a></li><li><a class="tocitem" href="../../tutorials/02-kelvin_waves/">Kelvin waves</a></li></ul></li><li><span class="tocitem">Explanations</span><ul><li class="is-active"><a class="tocitem" href>The vortex filament model</a><ul class="internal"><li><a class="tocitem" href="#BiotSavart"><span>The Biot–Savart law</span></a></li><li><a class="tocitem" href="#VFM-desingularisation"><span>Desingularisation</span></a></li><li><a class="tocitem" href="#Streamfunction-and-energy"><span>Streamfunction and energy</span></a></li><li><a class="tocitem" href="#VFM-ring"><span>Example: vortex ring</span></a></li><li><a class="tocitem" href="#Energy-in-open-domains"><span>Energy in open domains</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../Ewald/">Ewald summation for Biot–Savart</a></li></ul></li><li><span class="tocitem">Tips and tricks</span><ul><li><a class="tocitem" href="../../tips/parallelisation/">Parallelisation</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../../modules/PaddedArrays/">PaddedArrays</a></li><li><a class="tocitem" href="../../modules/PredefinedCurves/">PredefinedCurves</a></li><li><a class="tocitem" href="../../modules/CellLists/">CellLists</a></li><li><a class="tocitem" href="../../modules/BasicTypes/">BasicTypes</a></li><li><a class="tocitem" href="../../modules/Quadratures/">Quadratures</a></li><li><a class="tocitem" href="../../modules/Filaments/">Filaments</a></li><li><a class="tocitem" href="../../modules/FilamentIO/">FilamentIO</a></li><li><a class="tocitem" href="../../modules/FindNearbySegments/">FindNearbySegments</a></li><li><a class="tocitem" href="../../modules/BiotSavart/">BiotSavart</a></li><li><a class="tocitem" href="../../modules/Reconnections/">Reconnections</a></li><li><a class="tocitem" href="../../modules/Timestepping/">Timestepping</a></li><li><a class="tocitem" href="../../modules/Diagnostics/">Diagnostics</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Explanations</a></li><li class="is-active"><a href>The vortex filament model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The vortex filament model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jipolanco/VortexPasta.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jipolanco/VortexPasta.jl/blob/master/docs/src/methods/VFM.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="methods-VFM"><a class="docs-heading-anchor" href="#methods-VFM">The vortex filament model</a><a id="methods-VFM-1"></a><a class="docs-heading-anchor-permalink" href="#methods-VFM" title="Permalink"></a></h1><p>The standard <strong>vortex filament model</strong> (VFM) describes the motion of thin vortex lines in three-dimensional space.</p><p>Vortex lines are assumed to be very thin with respect to the scales of interest, such that they can be effectively described as spatial curves.</p><ul><li><a href="#BiotSavart">The Biot–Savart law</a></li><li><a href="#VFM-desingularisation">Desingularisation</a></li><li><a href="#Streamfunction-and-energy">Streamfunction and energy</a></li><li class="no-marker"><ul><li><a href="#Biot-Savart-streamfunction">The Biot–Savart law for the streamfunction</a></li><li><a href="#VFM-energy">Connection with kinetic energy</a></li><li><a href="#Desingularisation-of-the-streamfunction-integral">Desingularisation of the streamfunction integral</a></li></ul></li><li><a href="#VFM-ring">Example: vortex ring</a></li><li><a href="#Energy-in-open-domains">Energy in open domains</a></li><li><a href="#References">References</a></li></ul><h2 id="BiotSavart"><a class="docs-heading-anchor" href="#BiotSavart">The Biot–Savart law</a><a id="BiotSavart-1"></a><a class="docs-heading-anchor-permalink" href="#BiotSavart" title="Permalink"></a></h2><p>In the VFM, each vortex line induces a velocity field around it given by the <a href="https://en.wikipedia.org/wiki/Biot%E2%80%93Savart_law">Biot–Savart law</a>:</p><p class="math-container">\[\bm{v}(\bm{x}) =
\frac{Γ}{4π} ∮_{\mathcal{C}} \frac{(\bm{s} - \bm{x}) \times \mathrm{d}\bm{s}}{|\bm{s} - \bm{x}|^3}\]</p><p>where <span>$Γ$</span> is the vortex circulation (equal to <span>$κ$</span> for quantum vortices), and <span>$\bm{s}$</span> is a point along the vortex line. Here <span>$\mathcal{C}$</span> denotes the whole set of vortex lines in the system.</p><p>Mathematically, the above equation derives from the vorticity field:</p><p class="math-container">\[\bm{ω}(\bm{x}) ≡ \bm{\nabla} × \bm{v}(\bm{x})
= Γ ∮_{\mathcal{C}} δ(\bm{s} - \bm{x}) \, \mathrm{d}\bm{s}\]</p><p>where <span>$δ$</span> is Dirac delta function. That is, the vorticity field is singular and localised at the locations of quantum vortices.</p><p>The Biot–Savart law describes in particular the motion induced by vortex filaments on themselves and on surrounding vortex lines. The VFM thus describes the collective motion of a set of mutually-interacting vortex filaments which obey the Biot–Savart law. Note that the Biot–Savart integral is singular when evaluated at a vortex location <span>$\bm{s}&#39; ∈ \mathcal{C}$</span>, and the integral must be desingularised by taking into account the finite thickness of the vortex core. The VFM also accounts for <em>vortex reconnections</em>, which occur when two vortex segments are sufficiently close to each other and which change the topology of the vortex system.</p><h2 id="VFM-desingularisation"><a class="docs-heading-anchor" href="#VFM-desingularisation">Desingularisation</a><a id="VFM-desingularisation-1"></a><a class="docs-heading-anchor-permalink" href="#VFM-desingularisation" title="Permalink"></a></h2><p>In the VFM, one usually wants to evaluate the Biot–Savart law at locations <span>$\bm{x} = \bm{s}_0$</span> on the vortex. It is clear that the Biot–Savart integral, as written above, is singular when evaluated at a point <span>$\bm{s}_0$</span> on the curve.</p><p>The divergence of the Biot–Savart integral is of course unphysical, and is related to the fact that the actual thickness of vortex lines not really infinitesimal but finite. The standard way of accounting for the radius <span>$a$</span> of the vortex core is to split the integral into local and non-local parts:</p><p class="math-container">\[\newcommand{\vvec}{\bm{v}}
\newcommand{\svec}{\bm{s}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\sj}{\svec_0}
\vvec(\sj) =
\frac{Γ}{4π} ∫_{\mathcal{C}_0} \frac{(\svec - \sj) \times \dd\svec}{|\svec - \sj|^3}
+
\frac{Γ}{4π} ∫_{\mathcal{C} ∖ \mathcal{C}_0} \frac{(\svec - \sj) \times \dd\svec}{|\svec - \sj|^3}
= \vvec_{\text{local}}(\sj) + \vvec_{\text{non-local}}(\sj)\]</p><p>Here <span>$\mathcal{C}_0$</span> denotes a portion of the set of curves <span>$\mathcal{C}$</span> which is in the neighbourhood of the point of interest <span>$\bm{s}_0$</span>.</p><p>To illustrate this, the figure below shows a <a href="https://en.wikipedia.org/wiki/Trefoil_knot">trefoil knot</a> curve, or rather its projection on the XY plane. Note that here we represent a <em>discretised</em> version of the curve, where the number of degrees of freedom is finite and controlled by the positions of the markers.</p><p><img src="../trefoil_local.svg" alt/></p><details class="admonition is-details"><summary class="admonition-header">Code for this figure</summary><div class="admonition-body"><pre><code class="language-julia hljs">using CairoMakie
CairoMakie.activate!(type = &quot;svg&quot;, pt_per_unit = 1.0)
Makie.set_theme!()

using VortexPasta.Filaments
using VortexPasta.Filaments: Vec3
using VortexPasta.PredefinedCurves: define_curve, TrefoilKnot

trefoil = define_curve(TrefoilKnot())
N = 32
i = (N ÷ 2) + 3
refinement = 8
colours = Makie.wong_colors()
f = Filaments.init(trefoil, ClosedFilament, N, CubicSplineMethod())

fig = Figure(Text = (fontsize = 24,))
ax = Axis(fig[1, 1]; aspect = DataAspect(), xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
hidexdecorations!(ax; label = false, ticklabels = false, ticks = false)
hideydecorations!(ax; label = false, ticklabels = false, ticks = false)

# Plot complete filament in grey
let color = (:grey, 0.6)
    plot!(ax, f; refinement, color, linewidth = 1.5)
    text!(
        ax, f(i ÷ 2 + 1, 0.6);
        text = L&quot;\bar{\mathcal{C}}_{\!i}&quot;, align = (:right, :bottom), color,
        fontsize = 28,
    )
end

# Plot point of interest and local segment around it
let color = colours[2], arrowcol = colours[3]
    # Plot nodes (i - 1):(i + 1)
    scatter!(ax, getindex.(Ref(f), (i - 1):(i + 1)); color)
    text!(
        ax, f[i - 1] + Vec3(0.08, 0.0, 0.0);
        text = L&quot;\mathbf{s}_{i - 1}&quot;, align = (:left, :center), color,
    )
    text!(
        ax, f[i] + Vec3(0.08, 0.0, 0.0);
        text = L&quot;\mathbf{s}_i&quot;, align = (:left, :center), color,
    )
    text!(
        ax, f[i + 1] + Vec3(-0.08, 0.08, 0.0);
        text = L&quot;\mathbf{s}_{i + 1}&quot;, align = (:right, :center), color,
    )

    # Plot local segments
    let ζs = range(0, 1; length = refinement + 1)
        lines!(ax, f.(i - 1, ζs); color, linewidth = 3)
        lines!(ax, f.(i, ζs); color, linewidth = 3)
        text!(
            f(i - 1, 0.5);
            text = L&quot;ℓ^{-}&quot;, align = (:right, :bottom), color,
        )
        text!(
            f(i, 0.6) + Vec3(-0.08, 0, 0);
            text = L&quot;ℓ^{+}&quot;, align = (:right, :center), color,
        )
        text!(
            ax, f(i - 1, 0.7) + Vec3(0.2, 0.0, 0.0);
            text = L&quot;\mathcal{C}_{\!i}&quot;, align = (:left, :top), color,
            fontsize = 28,
        )
    end

    # Plot tangent and curvature vectors (assuming this is a 2D plot...)
    s⃗ = f[i]
    t̂ = f[i, UnitTangent()]
    ρ⃗ = f[i, CurvatureVector()]
    arrows!(ax, [s⃗[1]], [s⃗[2]], [t̂[1]], [t̂[2]]; color = arrowcol)
    arrows!(ax, [s⃗[1]], [s⃗[2]], [ρ⃗[1]], [ρ⃗[2]]; color = arrowcol)
    text!(
        ax, s⃗ + t̂ + Vec3(0.05, 0.0, 0.0);
        text = L&quot;\mathbf{s}′&quot;, align = (:left, :center), color = arrowcol,
    )
    text!(
        ax, s⃗ + ρ⃗ + Vec3(0.0, 0.04, 0.0);
        text = L&quot;\mathbf{s}″&quot;, align = (:center, :bottom), color = arrowcol,
    )
end

save(&quot;trefoil_local.svg&quot;, fig)</code></pre></div></details><p>Here, to evaluate the velocity induced by the trefoil vortex on its point <span>$\bm{s}_i$</span>, we split the curve into a local part <span>$\mathcal{C}_i$</span> (orange) and a non-local part <span>$\bar{\mathcal{C}}_i = \mathcal{C} ∖ \mathcal{C}_i$</span> (grey). The non-local part is far from the singularity, so there is no need to modify the Biot–Savart integral as written above. As for the local part, we can approximate it using a Taylor expansion of the Biot–Savart integral about <span>$\bm{s}_i$</span> and truncating the integral at a small distance <span>$ϵ ∝ a$</span> from the singularity. See for instance <a href="../../references/#Arms1965">Arms and Hama (1965)</a>.</p><p>More explicitly, from a Taylor expansion of <span>$\bm{s}(ξ)$</span> close to <span>$\bm{s}_i = \bm{s}(ξ_i)$</span>, one can show that the Biot–Savart integrand is approximately</p><p class="math-container">\[\frac{[\bm{s}(ξ) - \bm{s}_i] × \bm{s}&#39;(ξ)}{|\bm{s}(ξ) - \bm{s}_i|^3}
≈ \frac{\bm{s}_i&#39; × \bm{s}_i&#39;&#39;}{2 |ξ - ξ_i|},\]</p><p>where <span>$ξ$</span> is the curve arc length and derivatives (primes) are with respect to <span>$ξ$</span>. Note that <span>$\bm{s}_i&#39;$</span> and <span>$\bm{s}_i&#39;&#39;$</span> are respectively the unit tangent and curvature vectors at <span>$\bm{s}_i$</span> (see figure).</p><p>Now, if one integrates e.g. from <span>$\bm{s}(ξ_i + ϵ)$</span> to <span>$\bm{s}_{i + 1} = \bm{s}(ξ_{i + 1})$</span>, one gets:</p><p class="math-container">\[\bm{v}_i^+
≈ \frac{Γ}{4π} \frac{\bm{s}_i&#39; × \bm{s}_i&#39;&#39;}{2}
∫_{ξ_i + ϵ}^{ξ_{i + 1}} \frac{\mathrm{d}ξ}{ξ - ξ_i}
= \frac{Γ}{4π} \frac{\bm{s}_i&#39; × \bm{s}_i&#39;&#39;}{2}
\ln \left( \frac{ℓ^+}{ϵ} \right),\]</p><p>where <span>$ℓ^+ = ξ_{i + 1} - ξ_i$</span> is the length of the curve segment <span>$\bm{s}_i → \bm{s}_{i + 1}$</span> (see figure). Doing something similar for the segment <span>$\bm{s}_{i - 1} → \bm{s}(ξ_i - ϵ)$</span> and adding both contributions, we obtain the local velocity:</p><p class="math-container">\[\bm{v}_{\text{local}}(\bm{s}_i)
= \frac{Γ}{4π} \bm{s}_i&#39; × \bm{s}_i&#39;&#39; \ln \left( \frac{\sqrt{ℓ^- ℓ^+}}{ϵ} \right)
= \frac{Γ}{4π} \bm{s}_i&#39; × \bm{s}_i&#39;&#39; \left[ \ln \left( \frac{2\sqrt{ℓ^- ℓ^+}}{a} \right) - Δ \right],\]</p><p>where we have taken the cut-off distance to be <span>$ϵ = \frac{e^Δ a}{2}$</span> (<a href="../../references/#Saffman1993">Saffman, 1993</a>; §11.2). Here <span>$Δ$</span> is a coefficient which depends on the form of the vorticity profile within the vortex core (see the <a href="../../tutorials/01-vortex_ring/#Computing-the-vortex-ring-velocity">vortex ring tutorial</a>).</p><p>In the code, the local velocity is sometimes referred to as the LIA (<em>local induction approximation</em>) term, as it has been historically used as a fast (and incomplete) approximation to the full Biot–Savart integral.</p><h2 id="Streamfunction-and-energy"><a class="docs-heading-anchor" href="#Streamfunction-and-energy">Streamfunction and energy</a><a id="Streamfunction-and-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Streamfunction-and-energy" title="Permalink"></a></h2><p>Everything that has been discussed until now applies to the velocity derived from the Biot–Savart law. Sometimes we may also be interested in the <strong>streamfunction vector</strong> <span>$\bm{ψ}$</span>. In particular, the streamfunction values on vortex lines can be used to estimate the total energy of the vortex filament system.</p><h3 id="Biot-Savart-streamfunction"><a class="docs-heading-anchor" href="#Biot-Savart-streamfunction">The Biot–Savart law for the streamfunction</a><a id="Biot-Savart-streamfunction-1"></a><a class="docs-heading-anchor-permalink" href="#Biot-Savart-streamfunction" title="Permalink"></a></h3><p>In three dimensions, the streamfunction is a vector field which is directly related to the velocity and vorticity by</p><p class="math-container">\[\bm{v} = \bm{∇} × \bm{ψ} \quad \Rightarrow \quad \bm{ω} = \bm{∇} × \bm{v} = -∇²\bm{ψ}\]</p><p>That is, if one knows the vorticity field <span>$\bm{ω}$</span>, then the streamfunction is the solution of a <a href="https://en.wikipedia.org/wiki/Poisson&#39;s_equation">Poisson equation</a> with the vorticity as source term. The solution can be written in terms of the Green&#39;s function <span>$G(\bm{r}) = 1/(4πr)$</span> associated to the 3D Poisson equation:</p><p class="math-container">\[\newcommand{\xvec}{\bm{x}}
\newcommand{\yvec}{\bm{y}}
\newcommand{\vort}{\bm{ω}}
\newcommand{\dd}{\mathrm{d}}
\bm{ψ}(\xvec) = (G ∗ \vort)(\xvec)
= ∫ G(\xvec - \yvec) \vort(\yvec) \, \dd^3\yvec
= \frac{1}{4π} ∫ \frac{\vort(\yvec)}{|\xvec - \yvec|} \, \dd^3\yvec\]</p><p>Using the fact that the vorticity has the form <span>$\bm{ω}(\bm{x}) = Γ ∮_{\mathcal{C}} δ(\bm{s} - \bm{x}) \, \mathrm{d}\bm{s}$</span> leads to the <strong>Biot–Savart law for the streamfunction</strong>:</p><p class="math-container">\[\newcommand{\xvec}{\bm{x}}
\newcommand{\svec}{\bm{s}}
\newcommand{\vort}{\bm{ω}}
\newcommand{\dd}{\mathrm{d}}
\bm{ψ}(\xvec)
= Γ ∮_{\mathcal{C}} G(\xvec - \svec) \, \dd\svec
= \frac{Γ}{4π} ∮_{\mathcal{C}} \frac{\dd\svec}{|\xvec - \svec|}\]</p><p>Note that the usual Biot–Savart law for the velocity can be recovered by taking the curl of the above expression:</p><p class="math-container">\[\newcommand{\xvec}{\bm{x}}
\newcommand{\svec}{\bm{s}}
\newcommand{\vvec}{\bm{v}}
\newcommand{\vort}{\bm{ω}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\curl}{\bm{∇} ×}
\vvec(\xvec)
= \curl \bm{ψ}(\xvec)
= Γ ∮_{\mathcal{C}} \bm{∇} G(\xvec - \svec) × \dd\svec
= -\frac{Γ}{4π} ∮_{\mathcal{C}} \frac{(\xvec - \svec) × \dd\svec}{|\xvec - \svec|^3}\]</p><p>where we have used <span>$\bm{∇} G(\bm{r}) = -\bm{r} / (4π r^3)$</span>.</p><h3 id="VFM-energy"><a class="docs-heading-anchor" href="#VFM-energy">Connection with kinetic energy</a><a id="VFM-energy-1"></a><a class="docs-heading-anchor-permalink" href="#VFM-energy" title="Permalink"></a></h3><p>The kinetic energy of the system is given by</p><p class="math-container">\[\newcommand{\xvec}{\bm{x}}
\newcommand{\dd}{\mathrm{d}}
E
= \frac{ρ}{2} ∫ \bm{v}(\xvec) ⋅ \bm{v}(\xvec) \, \dd^3\xvec
= \frac{ρ}{2} ∫ \bm{ψ}(\xvec) ⋅ \bm{ω}(\xvec) \, \dd^3\xvec\]</p><p>where the second equality is obtained using integration by parts and assuming we&#39;re in a periodic domain (or, alternatively, that the velocity goes to zero far from the vortices), and <span>$ρ$</span> is the fluid density. As before, using <span>$\bm{ω}(\bm{x}) = Γ ∮_{\mathcal{C}} δ(\bm{s} - \bm{x}) \, \mathrm{d}\bm{s}$</span> leads to</p><p class="math-container">\[\newcommand{\svec}{\bm{s}}
\newcommand{\dd}{\mathrm{d}}
E = \frac{ρΓ}{2} ∮_{\mathcal{C}} \bm{ψ}(\svec) ⋅ \dd\svec\]</p><p>That is, the energy is simply the line integral of the tangential component of the streamfunction along vortex filaments.</p><p>Note that, if one uses the expression for <span>$\bm{ψ}(\bm{x})$</span> from the previous section, one can directly write the total energy from the configuration of the vortex lines:</p><p class="math-container">\[\newcommand{\svec}{\bm{s}}
\newcommand{\dd}{\mathrm{d}}
E = \frac{ρΓ^2}{8π} ∮_{\mathcal{C}} ∮_{\mathcal{C}}&#39; \frac{\dd \svec ⋅ \dd \svec_1}{|\svec - \svec_1|}\]</p><p>where the prime over the integral is to account for the desingularisation of the streamfunction integral (see section below).</p><h3 id="Desingularisation-of-the-streamfunction-integral"><a class="docs-heading-anchor" href="#Desingularisation-of-the-streamfunction-integral">Desingularisation of the streamfunction integral</a><a id="Desingularisation-of-the-streamfunction-integral-1"></a><a class="docs-heading-anchor-permalink" href="#Desingularisation-of-the-streamfunction-integral" title="Permalink"></a></h3><p>As for the velocity, the Biot–Savart integral for the streamfunction is singular when evaluated on a vortex line. We can use the same approach to desingularise it, by splitting the integral onto a local and a non-local part.</p><p>Using the same notation as <a href="#VFM-desingularisation">for the velocity</a>, a leading-order Taylor expansion of the integrand leads to:</p><p class="math-container">\[\bm{ψ}_i^+
≈ \frac{Γ}{2π} \frac{\bm{s}_i&#39;}{2} ∫_{ξ_i + ϵ&#39;}^{ξ_{i + 1}} \frac{\mathrm{d}ξ}{ξ - ξ_i}
= \frac{Γ}{2π} \frac{\bm{s}_i&#39;}{2} \ln \left( \frac{ℓ^+}{ϵ&#39;} \right)\]</p><p>and then to:</p><p class="math-container">\[\bm{ψ}_{\text{local}}(\bm{s}_i)
= \frac{Γ \bm{s}_i&#39;}{2π} \ln \left( \frac{\sqrt{ℓ^- ℓ^+}}{ϵ&#39;} \right)\]</p><p>Note that, here, the cut-off distance <span>$ϵ&#39;$</span> is not necessarily the same as for the velocity. In fact, if one considers a system of non-colliding vortex rings, one can show that, for the system to be Hamiltonian, one needs to take <span>$ϵ&#39; = \frac{e^{Δ - 1} a}{2}$</span> (as verified in the <a href="#VFM-ring">example</a> below). This finally leads to:</p><p class="math-container">\[\bm{ψ}_{\text{local}}(\bm{s}_i)
= \frac{Γ \bm{s}_i&#39;}{2π} \left[ \ln \left( \frac{2 \sqrt{ℓ^- ℓ^+}}{a} \right) - (Δ - 1) \right]\]</p><h2 id="VFM-ring"><a class="docs-heading-anchor" href="#VFM-ring">Example: vortex ring</a><a id="VFM-ring-1"></a><a class="docs-heading-anchor-permalink" href="#VFM-ring" title="Permalink"></a></h2><p>For a circular vortex ring of radius <span>$R$</span>, one can analytically compute the non-local Biot–Savart integrals. Under the approximation that the local segments are much smaller than the vortex radius (<span>$ℓ^- ∼ ℓ^+ ≪ R$</span>), one obtains:</p><p class="math-container">\[\newcommand{\vvec}{\bm{v}}
\newcommand{\psivec}{\bm{ψ}}
\newcommand{\svec}{\bm{s}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\sj}{\svec_i}
\begin{align*}
\vvec_{\text{non-local}}(\sj)
&amp;= \frac{Γ}{4π} \sj&#39; × \sj&#39;&#39; \ln \left( \frac{8R}{ℓ^*} \right)
\\
\psivec_{\text{non-local}}(\sj)
&amp;= \frac{Γ}{2π} \sj&#39; \left[ \ln \left( \frac{8R}{ℓ^*} \right) - 2 \right]
\end{align*}\]</p><p>where we have defined <span>$ℓ^* = 2\sqrt{ℓ^- ℓ^+}$</span>. In the expression for the velocity, <span>$\bm{s}_i&#39; × \bm{s}_i&#39;&#39; = \hat{\bm{z}} / R$</span>, where <span>$\hat{\bm{z}}$</span> is the direction orthogonal to the plane where the ring lives. As a reminder, <span>$\bm{s}_i&#39;$</span> is the local unit tangent vector, while the second derivative <span>$\bm{s}_i&#39;&#39;$</span> corresponds to the curvature vector (oriented towards the &quot;interior&quot; of the curve) and whose magnitude is <span>$1/R$</span>.</p><p>Adding the local integrals obtained by desingularisation leads to:</p><p class="math-container">\[\newcommand{\vvec}{\bm{v}}
\newcommand{\psivec}{\bm{ψ}}
\newcommand{\svec}{\bm{s}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\sj}{\svec_i}
\begin{align*}
\vvec(\sj)
&amp;= \frac{Γ \hat{\bm{z}}}{4πR} \left[ \ln \left( \frac{8R}{a} \right) - Δ \right]
\\
\psivec(\sj)
&amp;= \frac{Γ \sj&#39;}{2π} \left[ \ln \left( \frac{8R}{a} \right) - (Δ + 1) \right]
\end{align*}\]</p><p>The first expression obtained is the well-known self-induced velocity of a thin vortex ring.</p><p>From the second expression, we can easily obtain the energy associated to the vortex ring:</p><p class="math-container">\[E = \frac{ρ Γ^2 R}{2} \left[ \ln \left( \frac{8R}{a} \right) - (Δ + 1) \right]\]</p><p>We can finally check that, with the desingularisation procedure described in the previous sections, the vortex ring obeys Hamilton&#39;s equation <span>$v = ∂E/∂p$</span> (<a href="../../references/#Roberts1970">Roberts and Donnelly, 1970</a>). Here <span>$\bm{p}$</span> is the vortex impulse (<a href="../../references/#Saffman1993">Saffman, 1993</a>):</p><p class="math-container">\[\bm{p} = \frac{ρ Γ}{2} ∮_{\mathcal{C}} \bm{s} × \mathrm{d}\bm{s}\]</p><p>For a vortex ring, <span>$\bm{p} = ρ Γ π R^2 \hat{\bm{z}}$</span>, that is, the impulse is directly related to the area enclosed by the vortex.</p><p>Noting that</p><p class="math-container">\[\frac{∂E}{∂R} = \frac{ρ Γ^2}{2} \left[ \ln \left( \frac{8R}{a} \right) - Δ \right]
\quad \text{and} \quad
\frac{∂\bm{p}}{∂R} = 2ρ ΓπR \hat{\bm{z}},\]</p><p>we finally obtain that</p><p class="math-container">\[\frac{∂E}{∂p}
= \frac{Γ}{4πR} \left[ \ln \left( \frac{8R}{a} \right) - Δ \right]
= v_{\text{ring}}\]</p><h2 id="Energy-in-open-domains"><a class="docs-heading-anchor" href="#Energy-in-open-domains">Energy in open domains</a><a id="Energy-in-open-domains-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-in-open-domains" title="Permalink"></a></h2><p>In open (non-periodic and unbounded) domains, assuming that the velocity field goes to zero sufficiently far from the vortices, a commonly used alternative expression for the energy is (<a href="../../references/#Saffman1993">Saffman, 1993</a>):</p><p class="math-container">\[E₀ = ρ Γ ∮_{\mathcal{C}} \bm{v} ⋅ (\bm{s} × \mathrm{d}\bm{s})\]</p><p>which only requires knowing the velocity <span>$\bm{v}$</span> on the vortex filaments. Besides the above assumptions, this assumes that the fluid is incompressible everywhere.</p><p>However, this definition does not satisfy Hamilton&#39;s equation, meaning that this &quot;energy&quot; may present fluctuations in time in cases where the previous definition will be conserved.</p><p>This can be easily shown for the case of a vortex ring, in which case applying this definition to the expression for the vortex ring velocity leads to</p><p class="math-container">\[E₀ = \frac{ρ Γ^2 R}{2} \left[ \ln \left( \frac{8R}{a} \right) - Δ \right]\]</p><p>which overestimates the actual vortex ring energy by a <span>$ρ Γ^2 R / 2$</span> term (and thus doesn&#39;t satisfy Hamilton&#39;s equation).</p><p>These differences might be explained by the fact that this second definition doesn&#39;t take into account the internal structure of the vortices, unlike the first definition which does this via the local contribution to the streamfunction.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>A classical reference for the VFM is <a href="../../references/#Schwarz1985">Schwarz (1985)</a>, while a more modern review is given by <a href="../../references/#Hanninen2014">Hänninen and Baggaley (2014)</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/02-kelvin_waves/">« Kelvin waves</a><a class="docs-footer-nextpage" href="../Ewald/">Ewald summation for Biot–Savart »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 10 July 2024 07:32">Wednesday 10 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
