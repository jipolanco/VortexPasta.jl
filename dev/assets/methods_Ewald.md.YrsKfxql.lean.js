import{_ as s,o as e,c as l,aA as d,j as a,a as t}from"./chunks/framework.BxmU8EDa.js";const m="/VortexPasta.jl/dev/assets/splitting_functions.gl1m7ggZ.svg",o="/VortexPasta.jl/dev/assets/gaussian_kalpha.CDW1Pdlj.svg",Q6=JSON.parse('{"title":"Ewald summation for Biot–Savart","description":"","frontmatter":{},"headers":[],"relativePath":"methods/Ewald.md","filePath":"methods/Ewald.md","lastUpdated":null}'),r={name:"methods/Ewald.md"},n={class:"mjx-scroll-wrapper"},i={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},g={style:{"vertical-align":"-6.789ex"},xmlns:"http://www.w3.org/2000/svg",width:"54.785ex",height:"14.71ex",role:"img",focusable:"false",viewBox:"0 -3500.8 24214.8 6501.7"},h={class:"MathJax",jax:"SVG",overflow:"linebreak"},L={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.292ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2339.1 997.8"},p={class:"MathJax",jax:"SVG",overflow:"linebreak"},x={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.292ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2339.1 997.8"},f={class:"MathJax",jax:"SVG",overflow:"linebreak"},c={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.292ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2339.1 1000"},k={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.555ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3339.4 1000"},M={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.52ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1555.8 1000"},w={class:"MathJax",jax:"SVG",overflow:"linebreak"},_={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 451 1000"},b={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.52ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1555.8 1000"},Z={class:"MathJax",jax:"SVG",overflow:"linebreak"},u={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.292ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2339.1 997.8"},v={class:"MathJax",jax:"SVG",overflow:"linebreak"},y={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 451 453"},T={class:"MathJax",jax:"SVG",overflow:"linebreak"},D={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.43ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1516.2 599.8"},E={class:"MathJax",jax:"SVG",overflow:"linebreak"},A={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.715ex",height:"1.714ex",role:"img",focusable:"false",viewBox:"0 -749.8 1200.1 757.8"},F={class:"MathJax",jax:"SVG",overflow:"linebreak"},S={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.431ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3726.7 1083.9"},j={class:"MathJax",jax:"SVG",overflow:"linebreak"},V={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 451 1000"},B={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.52ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1555.8 1000"},P={class:"MathJax",jax:"SVG",overflow:"linebreak"},I={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.292ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2339.1 997.8"},R={class:"MathJax",jax:"SVG",overflow:"linebreak"},N={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 451 1000"},G={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.022ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1777.8 1000"},J={class:"mjx-scroll-wrapper"},O={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},X={style:{"vertical-align":"-5.118ex"},xmlns:"http://www.w3.org/2000/svg",width:"29.116ex",height:"11.367ex",role:"img",focusable:"false",viewBox:"0 -2762 12869.1 5024"},q={class:"MathJax",jax:"SVG",overflow:"linebreak"},z={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.699ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -705 1193 716"},H={class:"MathJax",jax:"SVG",overflow:"linebreak"},U={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.588ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -705 1586 716"},K={class:"MathJax",jax:"SVG",overflow:"linebreak"},$={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.516ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2438 1000"},Q={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.668ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3831.2 1000"},W={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.52ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1555.8 1000"},Y={class:"MathJax",jax:"SVG",overflow:"linebreak"},C1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453"},a1={class:"MathJax",jax:"SVG",overflow:"linebreak"},t1={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.534ex",height:"2.253ex",role:"img",focusable:"false",viewBox:"0 -748 2004 996"},e1={class:"MathJax",jax:"SVG",overflow:"linebreak"},l1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 451 453"},d1={class:"MathJax",jax:"SVG",overflow:"linebreak"},s1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453"},m1={class:"MathJax",jax:"SVG",overflow:"linebreak"},o1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 451 1000"},r1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.52ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1555.8 1000"},n1={class:"MathJax",jax:"SVG",overflow:"linebreak"},i1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.292ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2339.1 1000"},g1={style:{"vertical-align":"-1.334ex"},xmlns:"http://www.w3.org/2000/svg",width:"11.677ex",height:"3.308ex",role:"img",focusable:"false",viewBox:"0 -872.7 5161.1 1462.2"},h1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.613ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3364.8 1083.9"},L1={class:"MathJax",jax:"SVG",overflow:"linebreak"},p1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 451 453"},x1={class:"MathJax",jax:"SVG",overflow:"linebreak"},f1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.928ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3062 1000"},c1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.339ex",height:"2.46ex",role:"img",focusable:"false",viewBox:"0 -837.5 4569.8 1087.5"},k1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.613ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3364.8 1083.9"},M1={class:"MathJax",jax:"SVG",overflow:"linebreak"},w1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.468ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 1091 453"},_1={class:"MathJax",jax:"SVG",overflow:"linebreak"},b1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.008ex",height:"1.912ex",role:"img",focusable:"false",viewBox:"0 -833.9 887.6 844.9"},Z1={class:"MathJax",jax:"SVG",overflow:"linebreak"},u1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.431ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 3726.7 1083.9"},v1={class:"MathJax",jax:"SVG",overflow:"linebreak"},y1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 451 1000"},T1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.52ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1555.8 1000"},D1={class:"MathJax",jax:"SVG",overflow:"linebreak"},E1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.468ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 1091 453"},A1={class:"MathJax",jax:"SVG",overflow:"linebreak"},F1={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.468ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 1091 453"},S1={class:"MathJax",jax:"SVG",overflow:"linebreak"},j1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 451 1000"},V1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.095ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2693.8 1000"},B1={class:"MathJax",jax:"SVG",overflow:"linebreak"},P1={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.295ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 2340.2 886"},I1={class:"MathJax",jax:"SVG",overflow:"linebreak"},R1={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.43ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1516.2 599.8"},N1={class:"mjx-scroll-wrapper"},G1={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},J1={style:{"vertical-align":"-2.428ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.99ex",height:"5.722ex",role:"img",focusable:"false",viewBox:"0 -1456 20769.4 2529.1"},O1={class:"MathJax",jax:"SVG",overflow:"linebreak"},X1={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.491ex",height:"1.041ex",role:"img",focusable:"false",viewBox:"0 -452 659 460"},q1={class:"MathJax",jax:"SVG",overflow:"linebreak"},z1={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.715ex",height:"1.714ex",role:"img",focusable:"false",viewBox:"0 -749.8 1200.1 757.8"},H1={class:"MathJax",jax:"SVG",overflow:"linebreak"},U1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.308ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2788.1 1000"},K1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.556ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2013.8 1000"},$1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.229ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3637.4 1000"},Q1={class:"MathJax",jax:"SVG",overflow:"linebreak"},W1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.057ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1351.1 1000"},Y1={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.382ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1936.8 1000"},C2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.258ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1440.2 1000"},a2={class:"MathJax",jax:"SVG",overflow:"linebreak"},t2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.95ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2188 1000"},e2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.935ex",height:"2.46ex",role:"img",focusable:"false",viewBox:"0 -837.5 4833.3 1087.5"},l2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.007ex",height:"2.721ex",role:"img",focusable:"false",viewBox:"0 -952.7 2655 1202.7"},d2={class:"MathJax",jax:"SVG",overflow:"linebreak"},s2={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.715ex",height:"1.714ex",role:"img",focusable:"false",viewBox:"0 -749.8 1200.1 757.8"},m2={class:"MathJax",jax:"SVG",overflow:"linebreak"},o2={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.715ex",height:"1.714ex",role:"img",focusable:"false",viewBox:"0 -749.8 1200.1 757.8"},r2={class:"mjx-scroll-wrapper"},n2={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},i2={style:{"vertical-align":"-2.052ex"},xmlns:"http://www.w3.org/2000/svg",width:"53.844ex",height:"5.131ex",role:"img",focusable:"false",viewBox:"0 -1361 23799.3 2268"},g2={class:"MathJax",jax:"SVG",overflow:"linebreak"},h2={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.548ex",role:"img",focusable:"false",viewBox:"0 -684 681 684"},L2={class:"MathJax",jax:"SVG",overflow:"linebreak"},p2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.269ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1003 1000"},x2={style:{"vertical-align":"-0.792ex"},xmlns:"http://www.w3.org/2000/svg",width:"16.754ex",height:"2.749ex",role:"img",focusable:"false",viewBox:"0 -864.9 7405.3 1214.9"},f2={class:"MathJax",jax:"SVG",overflow:"linebreak"},c2={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.751ex",height:"2.455ex",role:"img",focusable:"false",viewBox:"0 -837 2100 1085"},k2={class:"mjx-scroll-wrapper"},M2={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},w2={style:{"vertical-align":"-2.052ex"},xmlns:"http://www.w3.org/2000/svg",width:"46.369ex",height:"5.131ex",role:"img",focusable:"false",viewBox:"0 -1361 20495.3 2268"},_2={class:"MathJax",jax:"SVG",overflow:"linebreak"},b2={style:{"vertical-align":"-0.034ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.48ex",height:"1.611ex",role:"img",focusable:"false",viewBox:"0 -697 654 712"},Z2={class:"MathJax",jax:"SVG",overflow:"linebreak"},u2={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.231ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -452 986 609.8"},v2={class:"mjx-scroll-wrapper"},y2={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},T2={style:{"vertical-align":"-1.629ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.173ex",height:"4.697ex",role:"img",focusable:"false",viewBox:"0 -1356 11126.6 2075.9"},D2={class:"MathJax",jax:"SVG",overflow:"linebreak"},E2={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.367ex",height:"1.588ex",role:"img",focusable:"false",viewBox:"0 -694 604 702"},A2={class:"MathJax",jax:"SVG",overflow:"linebreak"},F2={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.751ex",height:"2.455ex",role:"img",focusable:"false",viewBox:"0 -837 2100 1085"},S2={class:"mjx-scroll-wrapper"},j2={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},V2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"38.297ex",height:"2.834ex",role:"img",focusable:"false",viewBox:"0 -1002.7 16927.5 1252.7"},B2={class:"mjx-scroll-wrapper"},P2={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},I2={style:{"vertical-align":"-1.654ex"},xmlns:"http://www.w3.org/2000/svg",width:"53.435ex",height:"4.753ex",role:"img",focusable:"false",viewBox:"0 -1370 23618.5 2100.9"},R2={class:"warning custom-block"},N2={class:"MathJax",jax:"SVG",overflow:"linebreak"},G2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.686ex",height:"2.459ex",role:"img",focusable:"false",viewBox:"0 -837 2071 1087"},J2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.69ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1630.8 1000"},O2={class:"MathJax",jax:"SVG",overflow:"linebreak"},X2={style:{"vertical-align":"-0.375ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.612ex",height:"1.399ex",role:"img",focusable:"false",viewBox:"0 -453 1154.6 618.6"},q2={class:"MathJax",jax:"SVG",overflow:"linebreak"},z2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.88ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 831 1000"},H2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.76ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 778 1000"},U2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.504ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2432.6 1000"},K2={class:"MathJax",jax:"SVG",overflow:"linebreak"},$2={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.367ex",height:"1.588ex",role:"img",focusable:"false",viewBox:"0 -694 604 702"},Q2={class:"MathJax",jax:"SVG",overflow:"linebreak"},W2={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.751ex",height:"2.455ex",role:"img",focusable:"false",viewBox:"0 -837 2100 1085"},Y2={class:"MathJax",jax:"SVG",overflow:"linebreak"},C3={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.367ex",height:"1.588ex",role:"img",focusable:"false",viewBox:"0 -694 604 702"},a3={class:"MathJax",jax:"SVG",overflow:"linebreak"},t3={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},e3={class:"MathJax",jax:"SVG",overflow:"linebreak"},l3={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},d3={class:"MathJax",jax:"SVG",overflow:"linebreak"},s3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.344ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1919.9 1000"},m3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.343ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3687.8 1000"},o3={class:"MathJax",jax:"SVG",overflow:"linebreak"},r3={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.344ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 1919.9 851.8"},n3={class:"MathJax",jax:"SVG",overflow:"linebreak"},i3={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453"},g3={class:"MathJax",jax:"SVG",overflow:"linebreak"},h3={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.88ex",height:"2.18ex",role:"img",focusable:"false",viewBox:"0 -952.7 3925.1 963.7"},L3={class:"MathJax",jax:"SVG",overflow:"linebreak"},p3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.344ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1919.9 1000"},x3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.968ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2195.8 1000"},f3={class:"MathJax",jax:"SVG",overflow:"linebreak"},c3={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.495ex",height:"2.02ex",role:"img",focusable:"false",viewBox:"0 -871.1 1986.7 893.1"},k3={class:"MathJax",jax:"SVG",overflow:"linebreak"},M3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.923ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3059.9 1000"},w3={class:"MathJax",jax:"SVG",overflow:"linebreak"},_3={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.842ex",height:"2.455ex",role:"img",focusable:"false",viewBox:"0 -837 2582.1 1085"},b3={class:"MathJax",jax:"SVG",overflow:"linebreak"},Z3={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.677ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2509.1 997.8"},u3={class:"MathJax",jax:"SVG",overflow:"linebreak"},v3={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.201ex",height:"1.041ex",role:"img",focusable:"false",viewBox:"0 -452 531 460"},y3={class:"mjx-scroll-wrapper"},T3={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},D3={style:{"vertical-align":"-1.111ex"},xmlns:"http://www.w3.org/2000/svg",width:"25.029ex",height:"3.26ex",role:"img",focusable:"false",viewBox:"0 -950 11062.8 1441"},E3={class:"MathJax",jax:"SVG",overflow:"linebreak"},A3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.941ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 858 1000"},F3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.617ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1598.8 1000"},S3={class:"MathJax",jax:"SVG",overflow:"linebreak"},j3={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.344ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 1919.9 851.8"},V3={class:"MathJax",jax:"SVG",overflow:"linebreak"},B3={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.367ex",height:"1.588ex",role:"img",focusable:"false",viewBox:"0 -694 604 702"},P3={class:"MathJax",jax:"SVG",overflow:"linebreak"},I3={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.491ex",height:"1.041ex",role:"img",focusable:"false",viewBox:"0 -452 659 460"},R3={class:"MathJax",jax:"SVG",overflow:"linebreak"},N3={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.941ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -452 858 609.8"},G3={class:"mjx-scroll-wrapper"},J3={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},O3={style:{"vertical-align":"-8.189ex"},xmlns:"http://www.w3.org/2000/svg",width:"53.81ex",height:"17.51ex",role:"img",focusable:"false",viewBox:"0 -4119.6 23784 7739.2"},X3={class:"MathJax",jax:"SVG",overflow:"linebreak"},q3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.491ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 659 1000"},z3={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.33ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1913.7 1000"},H3={class:"mjx-scroll-wrapper"},U3={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},K3={style:{"vertical-align":"-2.941ex"},xmlns:"http://www.w3.org/2000/svg",width:"47.006ex",height:"7.014ex",role:"img",focusable:"false",viewBox:"0 -1800 20776.5 3100"},$3={class:"MathJax",jax:"SVG",overflow:"linebreak"},Q3={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.941ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -452 858 609.8"},W3={class:"MathJax",jax:"SVG",overflow:"linebreak"},Y3={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.941ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -452 858 609.8"},C4={class:"MathJax",jax:"SVG",overflow:"linebreak"},a4={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.219ex",height:"1.934ex",role:"img",focusable:"false",viewBox:"0 -697 981 854.8"},t4={class:"mjx-scroll-wrapper"},e4={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},l4={style:{"vertical-align":"-2.28ex"},xmlns:"http://www.w3.org/2000/svg",width:"44.156ex",height:"5.574ex",role:"img",focusable:"false",viewBox:"0 -1456 19517.1 2463.9"},d4={class:"MathJax",jax:"SVG",overflow:"linebreak"},s4={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.941ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -452 858 609.8"},m4={class:"mjx-scroll-wrapper"},o4={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},r4={style:{"vertical-align":"-0.684ex"},xmlns:"http://www.w3.org/2000/svg",width:"50.941ex",height:"2.493ex",role:"img",focusable:"false",viewBox:"0 -799.8 22515.7 1102.1"},n4={class:"MathJax",jax:"SVG",overflow:"linebreak"},i4={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.941ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -452 858 609.8"},g4={class:"mjx-scroll-wrapper"},h4={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},L4={style:{"vertical-align":"-6.957ex"},xmlns:"http://www.w3.org/2000/svg",width:"63.188ex",height:"15.045ex",role:"img",focusable:"false",viewBox:"0 -3574.9 27929.2 6649.8"},p4={class:"MathJax",jax:"SVG",overflow:"linebreak"},x4={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},f4={class:"MathJax",jax:"SVG",overflow:"linebreak"},c4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.932ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 412 1000"},k4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.049ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1789.8 1000"},M4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.312ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2789.9 1000"},w4={class:"MathJax",jax:"SVG",overflow:"linebreak"},_4={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.941ex",height:"1.38ex",role:"img",focusable:"false",viewBox:"0 -452 858 609.8"},b4={class:"MathJax",jax:"SVG",overflow:"linebreak"},Z4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 881 1000"},u4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.394ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1500.2 1000"},v4={class:"mjx-scroll-wrapper"},y4={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},T4={style:{"vertical-align":"-2.5ex"},xmlns:"http://www.w3.org/2000/svg",width:"35.066ex",height:"6.077ex",role:"img",focusable:"false",viewBox:"0 -1580.9 15499 2685.8"},D4={class:"MathJax",jax:"SVG",overflow:"linebreak"},E4={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.212ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1419.8 599.8"},A4={class:"MathJax",jax:"SVG",overflow:"linebreak"},F4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.583ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1141.8 1000"},S4={style:{"vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.122ex",height:"2.364ex",role:"img",focusable:"false",viewBox:"0 -750 4473.8 1045"},j4={class:"MathJax",jax:"SVG",overflow:"linebreak"},V4={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.43ex",height:"1.357ex",role:"img",focusable:"false",viewBox:"0 -442 1516.2 599.8"},B4={class:"MathJax",jax:"SVG",overflow:"linebreak"},P4={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.344ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 1919.9 851.8"},I4={class:"MathJax",jax:"SVG",overflow:"linebreak"},R4={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453"},N4={class:"MathJax",jax:"SVG",overflow:"linebreak"},G4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.299ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 574 1000"},J4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.267ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3211.9 1000"},O4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.443ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4615.7 1000"},X4={class:"MathJax",jax:"SVG",overflow:"linebreak"},q4={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.548ex",role:"img",focusable:"false",viewBox:"0 -684 681 684"},z4={class:"MathJax",jax:"SVG",overflow:"linebreak"},H4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 681 1000"},U4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.809ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2125.8 1000"},K4={class:"MathJax",jax:"SVG",overflow:"linebreak"},$4={style:{"vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.367ex",height:"1.588ex",role:"img",focusable:"false",viewBox:"0 -694 604 702"},Q4={class:"MathJax",jax:"SVG",overflow:"linebreak"},W4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.179ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 521 1000"},Y4={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.839ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3906.8 1000"},C5={class:"MathJax",jax:"SVG",overflow:"linebreak"},a5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.357ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 600 1000"},t5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.149ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1833.8 1000"},e5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.52ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1556 1000"},l5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.791ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2559.7 1000"},d5={class:"MathJax",jax:"SVG",overflow:"linebreak"},s5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.548ex",role:"img",focusable:"false",viewBox:"0 -684 681 684"},m5={class:"MathJax",jax:"SVG",overflow:"linebreak"},o5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},r5={class:"MathJax",jax:"SVG",overflow:"linebreak"},n5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},i5={class:"MathJax",jax:"SVG",overflow:"linebreak"},g5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.344ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1919.9 1000"},h5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.343ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3687.8 1000"},L5={class:"MathJax",jax:"SVG",overflow:"linebreak"},p5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.179ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1405 1000"},x5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.054ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3117.8 1000"},f5={class:"MathJax",jax:"SVG",overflow:"linebreak"},c5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},k5={class:"MathJax",jax:"SVG",overflow:"linebreak"},M5={style:{"vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.299ex",height:"2.036ex",role:"img",focusable:"false",viewBox:"0 -706 574 900"},w5={class:"MathJax",jax:"SVG",overflow:"linebreak"},_5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.299ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 574 1000"},b5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.28ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2333.8 1000"},Z5={class:"MathJax",jax:"SVG",overflow:"linebreak"},u5={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.495ex",height:"2.005ex",role:"img",focusable:"false",viewBox:"0 -864 1986.7 886"},v5={class:"MathJax",jax:"SVG",overflow:"linebreak"},y5={style:{"vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.299ex",height:"2.036ex",role:"img",focusable:"false",viewBox:"0 -706 574 900"},T5={class:"MathJax",jax:"SVG",overflow:"linebreak"},D5={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.344ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 1919.9 851.8"},E5={class:"MathJax",jax:"SVG",overflow:"linebreak"},A5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 640 1000"},F5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.293ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4549.7 1000"},S5={class:"MathJax",jax:"SVG",overflow:"linebreak"},j5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.43ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1516.2 1000"},V5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.266ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2769.8 1000"},B5={class:"MathJax",jax:"SVG",overflow:"linebreak"},P5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.548ex",role:"img",focusable:"false",viewBox:"0 -684 681 684"},I5={class:"MathJax",jax:"SVG",overflow:"linebreak"},R5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},N5={class:"MathJax",jax:"SVG",overflow:"linebreak"},G5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.548ex",role:"img",focusable:"false",viewBox:"0 -684 681 684"},J5={class:"MathJax",jax:"SVG",overflow:"linebreak"},O5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},X5={class:"MathJax",jax:"SVG",overflow:"linebreak"},q5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.918ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1732 1000"},z5={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.357ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3693.7 1000"},H5={class:"MathJax",jax:"SVG",overflow:"linebreak"},U5={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.344ex",height:"1.927ex",role:"img",focusable:"false",viewBox:"0 -694 1919.9 851.8"},K5={class:"tip custom-block"},$5={class:"MathJax",jax:"SVG",overflow:"linebreak"},Q5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},W5={class:"MathJax",jax:"SVG",overflow:"linebreak"},Y5={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},C6={class:"MathJax",jax:"SVG",overflow:"linebreak"},a6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.928ex",height:"2.527ex",role:"img",focusable:"false",viewBox:"0 -867 852 1117"},t6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.674ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2507.8 1000"},e6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.382ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1936.8 1000"},l6={class:"MathJax",jax:"SVG",overflow:"linebreak"},d6={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.928ex",height:"1.962ex",role:"img",focusable:"false",viewBox:"0 -867 852 867"},s6={class:"MathJax",jax:"SVG",overflow:"linebreak"},m6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.292ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 571 1000"},o6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.782ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2555.8 1000"},r6={class:"MathJax",jax:"SVG",overflow:"linebreak"},n6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 881 1000"},i6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.651ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2055.8 1000"},g6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.771ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2550.8 1000"},h6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.657ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2500.2 1000"},L6={class:"MathJax",jax:"SVG",overflow:"linebreak"},p6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.928ex",height:"2.527ex",role:"img",focusable:"false",viewBox:"0 -867 852 1117"},x6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.782ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2555.8 1000"},f6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.508ex",height:"2.468ex",role:"img",focusable:"false",viewBox:"0 -841 1992.3 1091"},c6={class:"MathJax",jax:"SVG",overflow:"linebreak"},k6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 451 1000"},M6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.509ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1992.8 1000"},w6={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.093ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1809.2 1000"},_6={class:"MathJax",jax:"SVG",overflow:"linebreak"},b6={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.735ex",height:"2.253ex",role:"img",focusable:"false",viewBox:"0 -748 2093 996"},Z6={class:"MathJax",jax:"SVG",overflow:"linebreak"},u6={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.168ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2726.1 997.8"},v6={class:"MathJax",jax:"SVG",overflow:"linebreak"},y6={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.168ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2726.1 997.8"},T6={class:"mjx-scroll-wrapper"},D6={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},E6={style:{"vertical-align":"-1.577ex"},xmlns:"http://www.w3.org/2000/svg",width:"53.454ex",height:"4.871ex",role:"img",focusable:"false",viewBox:"0 -1456 23626.8 2153"},A6={class:"MathJax",jax:"SVG",overflow:"linebreak"},F6={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.699ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -705 1193 716"},S6={class:"MathJax",jax:"SVG",overflow:"linebreak"},j6={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.588ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -705 1586 716"},V6={class:"MathJax",jax:"SVG",overflow:"linebreak"},B6={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.448ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 640 453"},P6={class:"mjx-scroll-wrapper"},I6={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},R6={style:{"vertical-align":"-2.172ex"},xmlns:"http://www.w3.org/2000/svg",width:"48.679ex",height:"5.475ex",role:"img",focusable:"false",viewBox:"0 -1460 21516 2420"},N6={class:"MathJax",jax:"SVG",overflow:"linebreak"},G6={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.469ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2417.1 997.8"},J6={class:"MathJax",jax:"SVG",overflow:"linebreak"},O6={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.469ex",height:"2.257ex",role:"img",focusable:"false",viewBox:"0 -749.8 2417.1 997.8"};function X6(q6,C,z6,H6,U6,K6){return e(),l("div",null,[C[472]||(C[472]=d("",5)),a("div",n,[a("mjx-container",i,[(e(),l("svg",g,[...C[0]||(C[0]=[d("",1)])]))])]),a("p",null,[C[3]||(C[3]=t("where the ",-1)),C[4]||(C[4]=a("em",null,"short-range",-1)),C[5]||(C[5]=t(" and ",-1)),C[6]||(C[6]=a("em",null,"long-range",-1)),C[7]||(C[7]=t(" scalar functions ",-1)),a("mjx-container",h,[(e(),l("svg",L,[...C[1]||(C[1]=[d("",1)])]))]),C[8]||(C[8]=t(" and ",-1)),a("mjx-container",p,[(e(),l("svg",x,[...C[2]||(C[2]=[d("",1)])]))]),C[9]||(C[9]=t(" have the properties:",-1))]),a("ol",null,[a("li",null,[a("p",null,[a("mjx-container",f,[(e(),l("svg",c,[...C[10]||(C[10]=[d("",1)])])),C[13]||(C[13]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",k,[...C[11]||(C[11]=[d("",1)])])),C[14]||(C[14]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",M,[...C[12]||(C[12]=[d("",1)])]))]),C[18]||(C[18]=t(" for all ",-1)),a("mjx-container",w,[(e(),l("svg",_,[...C[15]||(C[15]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r > 0"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])])),C[17]||(C[17]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",b,[...C[16]||(C[16]=[d("",1)])]))]),C[19]||(C[19]=t(";",-1))])]),a("li",null,[a("p",null,[a("mjx-container",Z,[(e(),l("svg",u,[...C[20]||(C[20]=[d("",1)])]))]),C[24]||(C[24]=t(" decays exponentially with ",-1)),a("mjx-container",v,[(e(),l("svg",y,[...C[21]||(C[21]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])]))]),C[25]||(C[25]=t(", so that long-range interactions can be neglected beyond some cut-off distance ",-1)),a("mjx-container",T,[(e(),l("svg",D,[...C[22]||(C[22]=[d("",1)])]))]),C[26]||(C[26]=t(" when computing the short-range velocity ",-1)),a("mjx-container",E,[(e(),l("svg",A,[...C[23]||(C[23]=[d("",1)])]))]),C[27]||(C[27]=t(";",-1))])]),a("li",null,[a("p",null,[a("mjx-container",F,[(e(),l("svg",S,[...C[28]||(C[28]=[d("",1)])]))]),C[36]||(C[36]=t(" is non-singular and smooth at ",-1)),a("mjx-container",j,[(e(),l("svg",V,[...C[29]||(C[29]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r = 0"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])])),C[31]||(C[31]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",B,[...C[30]||(C[30]=[d("",1)])]))]),C[37]||(C[37]=t(", which implies that ",-1)),a("mjx-container",P,[(e(),l("svg",I,[...C[32]||(C[32]=[d("",1)])]))]),C[38]||(C[38]=t(" must ",-1)),C[39]||(C[39]=a("em",null,"quickly",-1)),C[40]||(C[40]=t(" tend to 0 as ",-1)),a("mjx-container",R,[(e(),l("svg",N,[...C[33]||(C[33]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r → 0"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])])),C[35]||(C[35]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",G,[...C[34]||(C[34]=[d("",1)])]))]),C[41]||(C[41]=t(". In periodic domains, this enables the use of the fast Fourier transform (FFT) to efficiently estimate long-range interactions.",-1))])])]),C[473]||(C[473]=a("p",null,"The traditional choice of splitting functions satisfying all these properties is:",-1)),a("div",J,[a("mjx-container",O,[(e(),l("svg",X,[...C[42]||(C[42]=[d("",1)])]))])]),a("p",null,[C[52]||(C[52]=t("Here ",-1)),a("mjx-container",q,[(e(),l("svg",z,[...C[43]||(C[43]=[d("",1)])]))]),C[53]||(C[53]=t(" and ",-1)),a("mjx-container",H,[(e(),l("svg",U,[...C[44]||(C[44]=[d("",1)])]))]),C[54]||(C[54]=t(" are respectively the ",-1)),C[55]||(C[55]=a("a",{href:"https://en.wikipedia.org/wiki/Error_function",target:"_blank",rel:"noreferrer"},"error function",-1)),C[56]||(C[56]=t(" and the ",-1)),C[57]||(C[57]=a("a",{href:"https://en.wikipedia.org/wiki/Error_function#Complementary_error_function",target:"_blank",rel:"noreferrer"},"complementary error function",-1)),C[58]||(C[58]=t(", which satisfy ",-1)),a("mjx-container",K,[(e(),l("svg",$,[...C[45]||(C[45]=[d("",1)])])),C[48]||(C[48]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",Q,[...C[46]||(C[46]=[d("",1)])])),C[49]||(C[49]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",W,[...C[47]||(C[47]=[d("",1)])]))]),C[59]||(C[59]=t(". Above we have introduced the ",-1)),C[60]||(C[60]=a("strong",null,"Ewald splitting parameter",-1)),C[61]||(C[61]=t()),a("mjx-container",Y,[(e(),l("svg",C1,[...C[50]||(C[50]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"α"},[a("g",{"data-mml-node":"mi","data-latex":"α"},[a("path",{"data-c":"1D6FC",d:"M310 442C241 442 179 412 124 353C69 294 41 229 41 159C41 61 107-11 205-11C274-11 342 16 410 69C425 16 456-11 502-11C538-11 589 27 589 63C589 72 584 76 573 76C566 76 560 72 557 64C549 43 528 18 505 18C488 18 479 50 479 115C479 129 482 140 488 147C515 180 539 218 558 260C583 314 598 354 602 380L602 384C599 391 593 394 586 394C581 393 575 385 568 371C547 299 518 237 479 186L479 236C479 352 421 442 310 442M403 211C403 152 404 116 405 103C340 46 274 18 207 18C150 18 122 53 122 122C122 180 155 288 178 324C216 383 260 413 309 413C340 413 361 401 374 377C381 365 386 353 391 342C399 319 403 258 403 211Z"})])])],-1)])]))]),C[62]||(C[62]=t(", which is the inverse of a length scale. This parameter is purely numerical and, in theory, its choice has no impact on the final result ",-1)),a("mjx-container",a1,[(e(),l("svg",t1,[...C[51]||(C[51]=[d("",1)])]))]),C[63]||(C[63]=t(". In practice this is the case as long as other numerical parameters are well chosen (see discussion further below).",-1))]),a("p",null,[C[80]||(C[80]=t("The two splitting functions are plotted below. In the horizontal axis, the scale ",-1)),a("mjx-container",e1,[(e(),l("svg",l1,[...C[64]||(C[64]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])]))]),C[81]||(C[81]=t(" is non-dimensionalised by the splitting parameter ",-1)),a("mjx-container",d1,[(e(),l("svg",s1,[...C[65]||(C[65]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"α"},[a("g",{"data-mml-node":"mi","data-latex":"α"},[a("path",{"data-c":"1D6FC",d:"M310 442C241 442 179 412 124 353C69 294 41 229 41 159C41 61 107-11 205-11C274-11 342 16 410 69C425 16 456-11 502-11C538-11 589 27 589 63C589 72 584 76 573 76C566 76 560 72 557 64C549 43 528 18 505 18C488 18 479 50 479 115C479 129 482 140 488 147C515 180 539 218 558 260C583 314 598 354 602 380L602 384C599 391 593 394 586 394C581 393 575 385 568 371C547 299 518 237 479 186L479 236C479 352 421 442 310 442M403 211C403 152 404 116 405 103C340 46 274 18 207 18C150 18 122 53 122 122C122 180 155 288 178 324C216 383 260 413 309 413C340 413 361 401 374 377C381 365 386 353 391 342C399 319 403 258 403 211Z"})])])],-1)])]))]),C[82]||(C[82]=t(". Note that the long-range splitting function is smooth at ",-1)),a("mjx-container",m1,[(e(),l("svg",o1,[...C[66]||(C[66]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r = 0"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])])),C[68]||(C[68]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",r1,[...C[67]||(C[67]=[d("",1)])]))]),C[83]||(C[83]=t(" and has the Taylor expansion ",-1)),a("mjx-container",n1,[(e(),l("svg",i1,[...C[69]||(C[69]=[d("",1)])])),C[72]||(C[72]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",g1,[...C[70]||(C[70]=[d("",1)])])),C[73]||(C[73]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",h1,[...C[71]||(C[71]=[d("",1)])]))]),C[84]||(C[84]=t(". Also plotted are the two error functions. Note in particular that, for small ",-1)),a("mjx-container",L1,[(e(),l("svg",p1,[...C[74]||(C[74]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])]))]),C[85]||(C[85]=t(", ",-1)),a("mjx-container",x1,[(e(),l("svg",f1,[...C[75]||(C[75]=[d("",1)])])),C[78]||(C[78]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",c1,[...C[76]||(C[76]=[d("",1)])])),C[79]||(C[79]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",k1,[...C[77]||(C[77]=[d("",1)])]))]),C[86]||(C[86]=t(".",-1))]),C[474]||(C[474]=d("",2)),a("p",null,[C[93]||(C[93]=t("For small ",-1)),a("mjx-container",M1,[(e(),l("svg",w1,[...C[87]||(C[87]=[d("",1)])]))]),C[94]||(C[94]=t(", the long-range splitting function goes to zero as ",-1)),a("mjx-container",_1,[(e(),l("svg",b1,[...C[88]||(C[88]=[d("",1)])]))]),C[95]||(C[95]=t(", consistently with its Taylor expansion. This means that, as we wanted, ",-1)),a("mjx-container",Z1,[(e(),l("svg",u1,[...C[89]||(C[89]=[d("",1)])]))]),C[96]||(C[96]=t(" is non-singular and smooth at ",-1)),a("mjx-container",v1,[(e(),l("svg",y1,[...C[90]||(C[90]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r = 0"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])])),C[92]||(C[92]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",T1,[...C[91]||(C[91]=[d("",1)])]))]),C[97]||(C[97]=t(".",-1))]),C[475]||(C[475]=a("h2",{id:"Short-range-velocity",tabindex:"-1"},[t("Short-range velocity "),a("a",{class:"header-anchor",href:"#Short-range-velocity","aria-label":'Permalink to "Short-range velocity {#Short-range-velocity}"'},"​")],-1)),a("p",null,[C[105]||(C[105]=t("As seen in the figure above, the short-range splitting function is dominant for small ",-1)),a("mjx-container",D1,[(e(),l("svg",E1,[...C[98]||(C[98]=[d("",1)])]))]),C[106]||(C[106]=t(", while it decays exponentially to 0 for large ",-1)),a("mjx-container",A1,[(e(),l("svg",F1,[...C[99]||(C[99]=[d("",1)])]))]),C[107]||(C[107]=t(". In particular, for ",-1)),a("mjx-container",S1,[(e(),l("svg",j1,[...C[100]||(C[100]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r ≳ 5/α"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])])),C[102]||(C[102]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",V1,[...C[101]||(C[101]=[d("",1)])]))]),C[108]||(C[108]=t(", its value decays below about ",-1)),a("mjx-container",B1,[(e(),l("svg",P1,[...C[103]||(C[103]=[d("",1)])]))]),C[109]||(C[109]=t(", meaning that it is safe to set the cut-off distance ",-1)),a("mjx-container",I1,[(e(),l("svg",R1,[...C[104]||(C[104]=[d("",1)])]))]),C[110]||(C[110]=t(" around this value.",-1))]),C[476]||(C[476]=a("p",null,"Therefore, the short-range velocity is obtained as",-1)),a("div",N1,[a("mjx-container",G1,[(e(),l("svg",J1,[...C[111]||(C[111]=[d("",1)])]))])]),a("p",null,[C[113]||(C[113]=t("i.e. the integral is performed over vortex points which are sufficiently close to the point of interest ",-1)),a("mjx-container",O1,[(e(),l("svg",X1,[...C[112]||(C[112]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{x}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{x}"},[a("path",{"data-c":"1D499",d:"M604 364C604 417 551 452 490 452C433 452 396 409 383 391C358 433 302 452 245 452C119 452 51 329 51 296C51 282 66 282 75 282C87 282 94 282 98 295C127 386 199 416 240 416C278 416 296 398 296 366C296 347 282 292 273 256L239 119C224 58 188 28 154 28C149 28 126 28 106 43C142 53 160 87 160 112C160 134 143 158 110 158C75 158 38 129 38 80C38 27 91-8 152-8C209-8 246 35 259 53C284 11 340-8 397-8C523-8 591 115 591 148C591 162 576 162 567 162C555 162 548 162 544 149C515 58 443 28 402 28C364 28 346 46 346 78C346 99 359 152 368 189L403 325C418 385 453 416 488 416C493 416 516 416 536 401C500 391 482 357 482 332C482 310 499 286 532 286C567 286 604 315 604 364Z"})])])],-1)])]))]),C[114]||(C[114]=t(". Moreover, integrals are estimated using ",-1)),C[115]||(C[115]=a("a",{href:"/VortexPasta.jl/dev/methods/Ewald#Numerical-integration"},"numerical integration",-1)),C[116]||(C[116]=t(".",-1))]),C[477]||(C[477]=a("p",null,[t("Note that one can use a "),a("a",{href:"/VortexPasta.jl/dev/modules/CellLists#CellLists"},"cell lists algorithm"),t(" to further speed-up the search for nearby points.")],-1)),C[478]||(C[478]=a("h2",{id:"Long-range-velocity",tabindex:"-1"},[t("Long-range velocity "),a("a",{class:"header-anchor",href:"#Long-range-velocity","aria-label":'Permalink to "Long-range velocity {#Long-range-velocity}"'},"​")],-1)),a("p",null,[C[123]||(C[123]=t("The long-range velocity ",-1)),a("mjx-container",q1,[(e(),l("svg",z1,[...C[117]||(C[117]=[d("",1)])]))]),C[124]||(C[124]=t(" has a simple physical interpretation. Indeed, it can be shown, by differentiating the splitting functions defined above, that its associated long-range vorticity ",-1)),a("mjx-container",H1,[(e(),l("svg",U1,[...C[118]||(C[118]=[d("",1)])])),C[121]||(C[121]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",K1,[...C[119]||(C[119]=[d("",1)])])),C[122]||(C[122]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",$1,[...C[120]||(C[120]=[d("",1)])]))]),C[125]||(C[125]=t(" is nothing else that a Gaussian-filtered version of the actual vorticity field induced by the vortex filaments (which is singular).",-1))]),a("p",null,[C[138]||(C[138]=t("More precisely, the long-range vorticity is given by the convolution ",-1)),a("mjx-container",Q1,[(e(),l("svg",W1,[...C[126]||(C[126]=[d("",1)])])),C[129]||(C[129]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",Y1,[...C[127]||(C[127]=[d("",1)])])),C[130]||(C[130]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",C2,[...C[128]||(C[128]=[d("",1)])]))]),C[139]||(C[139]=t(", where ",-1)),a("mjx-container",a2,[(e(),l("svg",t2,[...C[131]||(C[131]=[d("",1)])])),C[134]||(C[134]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",e2,[...C[132]||(C[132]=[d("",1)])])),C[135]||(C[135]=a("mjx-break",{size:"0"}," ",-1)),(e(),l("svg",l2,[...C[133]||(C[133]=[d("",1)])]))]),C[140]||(C[140]=t(" is a 3D Gaussian kernel. Intuitively, this means that the long-range velocity ",-1)),a("mjx-container",d2,[(e(),l("svg",s2,[...C[136]||(C[136]=[d("",1)])]))]),C[141]||(C[141]=t(' corresponds to the velocity induced by a coarse-grained version of the vortex filaments. In this view, vortices are not "infinitesimal" anymore, but are closer to the smooth vortices which we are used to see in classical viscous fluids. In periodic domains, such a smooth vorticity field can be accurately and efficiently expanded in Fourier series, and the curl operator can be readily inverted in Fourier space to obtain the coarse-grained velocity field ',-1)),a("mjx-container",m2,[(e(),l("svg",o2,[...C[137]||(C[137]=[d("",1)])]))]),C[142]||(C[142]=t(".",-1))]),C[479]||(C[479]=a("h3",{id:"1.-Estimating-the-vorticity-in-Fourier-space",tabindex:"-1"},[t("1. Estimating the vorticity in Fourier space "),a("a",{class:"header-anchor",href:"#1.-Estimating-the-vorticity-in-Fourier-space","aria-label":'Permalink to "1. Estimating the vorticity in Fourier space {#1.-Estimating-the-vorticity-in-Fourier-space}"'},"​")],-1)),C[480]||(C[480]=a("p",null,[t("The idea is to first expand the ("),a("em",null,"actual"),t(") vorticity field in Fourier series:")],-1)),a("div",r2,[a("mjx-container",n2,[(e(),l("svg",i2,[...C[143]||(C[143]=[d("",1)])]))])]),a("p",null,[C[149]||(C[149]=t("Here ",-1)),a("mjx-container",g2,[(e(),l("svg",h2,[...C[144]||(C[144]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"L"},[a("g",{"data-mml-node":"mi","data-latex":"L"},[a("path",{"data-c":"1D43F",d:"M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"})])])],-1)])]))]),C[150]||(C[150]=t(" is the domain period (assumed the same in all directions for simplicity), and ",-1)),a("mjx-container",L2,[(e(),l("svg",p2,[...C[145]||(C[145]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{K} = \\left\\{ \\frac{2π \\bm{n}}{L}, \\bm{n} ∈ \\mathbb{Z}^3 \\right\\}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{K}"},[a("path",{"data-c":"1D472",d:"M1003 668C1003 677 995 686 985 686C960 686 931 683 905 683C864 683 821 686 780 686C772 686 752 686 752 657C752 639 770 639 776 639C784 639 805 638 822 632L366 317L445 635C467 639 502 639 513 639C526 639 546 639 550 642C560 649 561 668 561 668C561 681 551 686 539 686C514 686 488 684 463 684L388 683L311 684C285 684 258 686 232 686C223 686 203 686 203 657C203 639 216 639 245 639C266 639 285 638 306 637L163 67C159 51 158 50 140 48C123 47 103 47 87 47C61 47 59 47 55 45C43 38 43 22 43 18C43 18 44 0 65 0C90 0 116 2 141 2L217 3L294 2C320 2 347 0 372 0C382 0 389 0 395 7C399 13 401 29 401 29C401 47 387 47 360 47C339 47 320 48 299 49L351 257L475 342L624 53C604 47 574 47 570 47C557 47 551 47 545 40C541 35 539 18 539 18C539 18 539 0 560 0L708 3L772 2C792 2 813 0 832 0C839 0 859 0 859 29C859 47 842 47 827 47C781 47 779 51 771 67L589 420C656 467 839 596 874 614C897 626 918 637 969 639C987 640 1003 640 1003 668Z"})])])],-1)])])),C[147]||(C[147]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",x2,[...C[146]||(C[146]=[d("",1)])]))]),C[151]||(C[151]=t(" is the set of wavenumbers associated to the Fourier series expansion. The Fourier coefficients ",-1)),a("mjx-container",f2,[(e(),l("svg",c2,[...C[148]||(C[148]=[d("",1)])]))]),C[152]||(C[152]=t(" are given by",-1))]),a("div",k2,[a("mjx-container",M2,[(e(),l("svg",w2,[...C[153]||(C[153]=[d("",1)])]))])]),a("p",null,[C[156]||(C[156]=t("To estimate this integral, we discretise the curves defining the support ",-1)),a("mjx-container",_2,[(e(),l("svg",b2,[...C[154]||(C[154]=[d("",1)])]))]),C[157]||(C[157]=t(" of the vortex filaments, leading to a weighted sum over discrete points ",-1)),a("mjx-container",Z2,[(e(),l("svg",u2,[...C[155]||(C[155]=[d("",1)])]))]),C[158]||(C[158]=t(":",-1))]),a("div",v2,[a("mjx-container",y2,[(e(),l("svg",T2,[...C[159]||(C[159]=[d("",1)])]))])]),a("p",null,[C[161]||(C[161]=t("The weights are related to the length of the discrete segments and to the quadrature rule used to estimate the integrals over segments (see the ",-1)),C[162]||(C[162]=a("a",{href:"/VortexPasta.jl/dev/methods/Ewald#Numerical-integration"},"Numerical integration",-1)),C[163]||(C[163]=t(" section). The important point here is that, since the discrete points are generally not on an equispaced grid, one cannot directly use the fast Fourier transform (FFT) to efficiently evaluate these coefficients. Nevertheless, they can be efficiently and accurately estimated using the ",-1)),C[164]||(C[164]=a("a",{href:"https://en.wikipedia.org/wiki/Non-uniform_discrete_Fourier_transform#Nonuniform_fast_Fourier_transform",target:"_blank",rel:"noreferrer"},"non-uniform FFT",-1)),C[165]||(C[165]=t(" (NUFFT) algorithm. More precisely, this corresponds to a ",-1)),C[166]||(C[166]=a("a",{href:"https://finufft.readthedocs.io/en/latest/math.html",target:"_blank",rel:"noreferrer"},"type-1 NUFFT",-1)),C[167]||(C[167]=t(", which converts from non-uniform sources in physical space to uniform wavenumbers ",-1)),a("mjx-container",D2,[(e(),l("svg",E2,[...C[160]||(C[160]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{k}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{k}"},[a("path",{"data-c":"1D48C",d:"M305 95C305 30 367-8 433-8C533-8 570 140 570 148C570 162 555 162 546 162C528 162 526 160 521 142C513 113 489 28 438 28C422 28 412 37 412 67C412 77 414 96 420 119C423 130 423 137 423 144C423 229 322 245 250 252C260 259 284 275 339 328C416 404 458 416 488 416C507 416 514 404 514 404C464 397 445 357 445 332C445 310 462 286 495 286C514 286 567 299 567 370C567 422 534 452 491 452C430 452 375 408 316 351C306 340 258 294 220 273L316 659C320 673 320 676 320 676C320 689 309 694 298 694C294 694 293 694 291 693L162 687C148 686 130 685 130 657C130 639 149 639 156 639C167 639 185 639 198 637L54 60C53 56 50 41 50 37C50 13 69-8 98-8C116-8 145 1 159 32L205 215C224 213 311 201 311 140C311 129 305 106 305 95Z"})])])],-1)])]))]),C[168]||(C[168]=t(" in Fourier space.",-1))]),C[481]||(C[481]=a("h3",{id:"2.-Coarse-grained-vorticity-and-velocity-in-Fourier-space",tabindex:"-1"},[t("2. Coarse-grained vorticity and velocity in Fourier space "),a("a",{class:"header-anchor",href:"#2.-Coarse-grained-vorticity-and-velocity-in-Fourier-space","aria-label":'Permalink to "2. Coarse-grained vorticity and velocity in Fourier space {#2.-Coarse-grained-vorticity-and-velocity-in-Fourier-space}"'},"​")],-1)),a("p",null,[C[170]||(C[170]=t("Once we have obtained the ",-1)),a("mjx-container",A2,[(e(),l("svg",F2,[...C[169]||(C[169]=[d("",1)])]))]),C[171]||(C[171]=t(" coefficients, obtaining the Fourier coefficients for the coarse-grained vorticity and coarse-grained velocity is straightforward. The former is obtained by convolution with a Gaussian, which is simply a product in Fourier space:",-1))]),a("div",S2,[a("mjx-container",j2,[(e(),l("svg",V2,[...C[172]||(C[172]=[d("",1)])]))])]),C[482]||(C[482]=a("p",null,"Similarly, the curl operator can be easily inverted in Fourier space to get the coarse-grained velocity:",-1)),a("div",B2,[a("mjx-container",P2,[(e(),l("svg",I2,[...C[173]||(C[173]=[d("",1)])]))])]),a("div",R2,[C[190]||(C[190]=a("p",{class:"custom-block-title"},"Zero mean vorticity condition",-1)),a("p",null,[C[177]||(C[177]=t("The velocity is well defined only if ",-1)),a("mjx-container",N2,[(e(),l("svg",G2,[...C[174]||(C[174]=[d("",1)])])),C[176]||(C[176]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",J2,[...C[175]||(C[175]=[d("",1)])]))]),C[178]||(C[178]=t(", that is, if the mean vorticity of the vortex filament system is zero. Otherwise we get division by zero, which is related to the fact that we're dealing with an infinitely periodic system and energy diverges with a non-zero mean vorticity.",-1))]),C[191]||(C[191]=a("p",null,"This condition is automatically satisfied when dealing with closed vortex filaments. This may however not be the case for infinite filaments.",-1)),a("p",null,[C[185]||(C[185]=t("To avoid this issue, we always set the mean vorticity to zero. In the case of infinite unclosed filaments, this effectively means that a non-zero total filament charge will be compensated by a uniform background vorticity ",-1)),a("mjx-container",O2,[(e(),l("svg",X2,[...C[179]||(C[179]=[d("",1)])]))]),C[186]||(C[186]=t(" throughout the domain, which can be interpreted as if the computations were performed in a rotating reference frame with rotation rate ",-1)),a("mjx-container",q2,[(e(),l("svg",z2,[...C[180]||(C[180]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{Ω} = -2 \\bm{ω}_0"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{Ω}"},[a("path",{"data-c":"1D6C0",d:"M766 457C766 565 676 697 415 697C154 697 64 565 64 457C64 365 121 293 176 224C211 179 236 145 256 103L184 103C125 103 121 113 116 123C109 141 100 190 98 200L51 200L88 0L279 0C301 0 311 0 311 27C311 97 281 189 266 233C240 312 217 384 217 457C217 496 222 567 271 612C320 656 385 661 415 661C467 661 524 646 560 610C590 581 613 537 613 457C613 387 592 319 567 245C548 185 519 97 519 27C519 0 529 0 551 0L742 0L779 200L732 200C730 186 722 144 715 126C710 113 706 103 646 103L574 103C626 215 766 314 766 457Z"})])])],-1)])])),C[183]||(C[183]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",H2,[...C[181]||(C[181]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{Ω} = -2 \\bm{ω}_0"},[a("g",{"data-mml-node":"mo","data-latex":"="},[a("path",{"data-c":"3D",d:"M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"})])])],-1)])])),C[184]||(C[184]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",U2,[...C[182]||(C[182]=[d("",1)])]))]),C[187]||(C[187]=t(" (that is, rotating in the same direction as the vortices). This just requires some care in the computation of the streamfunction (and thus the induced kinetic energy) as detailed in ",-1)),C[188]||(C[188]=a("a",{href:"/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.background_vorticity_correction!"},[a("code",null,"BiotSavart.background_vorticity_correction!")],-1)),C[189]||(C[189]=t(".",-1))])]),C[483]||(C[483]=a("h3",{id:"3.-Notes-on-required-resolution",tabindex:"-1"},[t("3. Notes on required resolution "),a("a",{class:"header-anchor",href:"#3.-Notes-on-required-resolution","aria-label":'Permalink to "3. Notes on required resolution {#3.-Notes-on-required-resolution}"'},"​")],-1)),a("p",null,[C[200]||(C[200]=t("Above we have assumed that we can evaluate Fourier coefficients for any wavenumber ",-1)),a("mjx-container",K2,[(e(),l("svg",$2,[...C[192]||(C[192]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{k}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{k}"},[a("path",{"data-c":"1D48C",d:"M305 95C305 30 367-8 433-8C533-8 570 140 570 148C570 162 555 162 546 162C528 162 526 160 521 142C513 113 489 28 438 28C422 28 412 37 412 67C412 77 414 96 420 119C423 130 423 137 423 144C423 229 322 245 250 252C260 259 284 275 339 328C416 404 458 416 488 416C507 416 514 404 514 404C464 397 445 357 445 332C445 310 462 286 495 286C514 286 567 299 567 370C567 422 534 452 491 452C430 452 375 408 316 351C306 340 258 294 220 273L316 659C320 673 320 676 320 676C320 689 309 694 298 694C294 694 293 694 291 693L162 687C148 686 130 685 130 657C130 639 149 639 156 639C167 639 185 639 198 637L54 60C53 56 50 41 50 37C50 13 69-8 98-8C116-8 145 1 159 32L205 215C224 213 311 201 311 140C311 129 305 106 305 95Z"})])])],-1)])]))]),C[201]||(C[201]=t(". In fact, for practical reasons, we cannot evaluate all coefficients ",-1)),a("mjx-container",Q2,[(e(),l("svg",W2,[...C[193]||(C[193]=[d("",1)])]))]),C[202]||(C[202]=t(" for every possible ",-1)),a("mjx-container",Y2,[(e(),l("svg",C3,[...C[194]||(C[194]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{k}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{k}"},[a("path",{"data-c":"1D48C",d:"M305 95C305 30 367-8 433-8C533-8 570 140 570 148C570 162 555 162 546 162C528 162 526 160 521 142C513 113 489 28 438 28C422 28 412 37 412 67C412 77 414 96 420 119C423 130 423 137 423 144C423 229 322 245 250 252C260 259 284 275 339 328C416 404 458 416 488 416C507 416 514 404 514 404C464 397 445 357 445 332C445 310 462 286 495 286C514 286 567 299 567 370C567 422 534 452 491 452C430 452 375 408 316 351C306 340 258 294 220 273L316 659C320 673 320 676 320 676C320 689 309 694 298 694C294 694 293 694 291 693L162 687C148 686 130 685 130 657C130 639 149 639 156 639C167 639 185 639 198 637L54 60C53 56 50 41 50 37C50 13 69-8 98-8C116-8 145 1 159 32L205 215C224 213 311 201 311 140C311 129 305 106 305 95Z"})])])],-1)])]))]),C[203]||(C[203]=t(", and we need to set the number of wavenumbers ",-1)),a("mjx-container",a3,[(e(),l("svg",t3,[...C[195]||(C[195]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[204]||(C[204]=t(" to compute in each direction (this is the parameter one tunes in NUFFT implementations). In other words, we need to truncate the estimations at some maximum wavenumber, namely the Nyquist frequency, which is related to ",-1)),a("mjx-container",e3,[(e(),l("svg",l3,[...C[196]||(C[196]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[205]||(C[205]=t(" by ",-1)),a("mjx-container",d3,[(e(),l("svg",s3,[...C[197]||(C[197]=[d("",1)])])),C[199]||(C[199]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",m3,[...C[198]||(C[198]=[d("",1)])]))]),C[206]||(C[206]=t(".",-1))]),a("p",null,[C[215]||(C[215]=t("Similarly to the cut-off distance in physical space, one can expect that the appropriate value of ",-1)),a("mjx-container",o3,[(e(),l("svg",r3,[...C[207]||(C[207]=[d("",1)])]))]),C[216]||(C[216]=t(" (which is an inverse length scale) to get good accuracy should be proportional to the Ewald splitting parameter ",-1)),a("mjx-container",n3,[(e(),l("svg",i3,[...C[208]||(C[208]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"α"},[a("g",{"data-mml-node":"mi","data-latex":"α"},[a("path",{"data-c":"1D6FC",d:"M310 442C241 442 179 412 124 353C69 294 41 229 41 159C41 61 107-11 205-11C274-11 342 16 410 69C425 16 456-11 502-11C538-11 589 27 589 63C589 72 584 76 573 76C566 76 560 72 557 64C549 43 528 18 505 18C488 18 479 50 479 115C479 129 482 140 488 147C515 180 539 218 558 260C583 314 598 354 602 380L602 384C599 391 593 394 586 394C581 393 575 385 568 371C547 299 518 237 479 186L479 236C479 352 421 442 310 442M403 211C403 152 404 116 405 103C340 46 274 18 207 18C150 18 122 53 122 122C122 180 155 288 178 324C216 383 260 413 309 413C340 413 361 401 374 377C381 365 386 353 391 342C399 319 403 258 403 211Z"})])])],-1)])]))]),C[217]||(C[217]=t(". A rule of thumb is to choose a wavenumber at which the Gaussian factor ",-1)),a("mjx-container",g3,[(e(),l("svg",h3,[...C[209]||(C[209]=[d("",1)])]))]),C[218]||(C[218]=t(" matches the desired accuracy. For instance, at ",-1)),a("mjx-container",L3,[(e(),l("svg",p3,[...C[210]||(C[210]=[d("",1)])])),C[212]||(C[212]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",x3,[...C[211]||(C[211]=[d("",1)])]))]),C[219]||(C[219]=t(", this factor has dropped to about ",-1)),a("mjx-container",f3,[(e(),l("svg",c3,[...C[213]||(C[213]=[d("",1)])]))]),C[220]||(C[220]=t(" (see figure below). Of course, one can vary the ",-1)),a("mjx-container",k3,[(e(),l("svg",M3,[...C[214]||(C[214]=[d("",1)])]))]),C[221]||(C[221]=t(" ratio depending on the wanted accuracy.",-1))]),C[484]||(C[484]=d("",3)),a("p",null,[C[225]||(C[225]=t("The last step is to evaluate, from the coarse-grained velocity ",-1)),a("mjx-container",w3,[(e(),l("svg",_3,[...C[222]||(C[222]=[d("",1)])]))]),C[226]||(C[226]=t(" in Fourier space, the ",-1)),C[227]||(C[227]=a("em",null,"physical",-1)),C[228]||(C[228]=t(" coarse-grained velocity ",-1)),a("mjx-container",b3,[(e(),l("svg",Z3,[...C[223]||(C[223]=[d("",1)])]))]),C[229]||(C[229]=t(" on vortex filament locations ",-1)),a("mjx-container",u3,[(e(),l("svg",v3,[...C[224]||(C[224]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{s}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{s}"},[a("path",{"data-c":"1D494",d:"M476 364C476 417 423 452 333 452C304 452 248 450 202 415C157 381 141 323 141 298C141 268 155 240 177 222C205 200 222 197 290 184C320 179 380 168 380 123C380 119 380 28 231 28C182 28 145 38 123 54C157 64 178 93 178 123C178 159 149 169 129 169C95 169 57 141 57 91C57 26 127-8 229-8C457-8 457 164 457 164C457 198 440 225 417 245C386 272 348 279 313 285C258 295 219 302 219 339C219 339 219 416 331 416C351 416 387 414 414 394C381 381 372 351 372 337C372 311 393 296 415 296C439 296 476 316 476 364Z"})])])],-1)])]))]),C[230]||(C[230]=t(" (which, once again, are generally not on a regular grid). This operation can be written as:",-1))]),a("div",y3,[a("mjx-container",T3,[(e(),l("svg",D3,[...C[231]||(C[231]=[d("",1)])]))])]),a("p",null,[C[236]||(C[236]=t("for a set of locations ",-1)),a("mjx-container",E3,[(e(),l("svg",A3,[...C[232]||(C[232]=[d("",1)])])),C[234]||(C[234]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",F3,[...C[233]||(C[233]=[d("",1)])]))]),C[237]||(C[237]=t(". Note that in practice this sum is truncated to the chosen ",-1)),a("mjx-container",S3,[(e(),l("svg",j3,[...C[235]||(C[235]=[d("",1)])]))]),C[238]||(C[238]=t(".",-1))]),a("p",null,[C[241]||(C[241]=t("This operation can be efficiently computed using a type-2 NUFFT (from uniform wavenumbers ",-1)),a("mjx-container",V3,[(e(),l("svg",B3,[...C[239]||(C[239]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{k}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{k}"},[a("path",{"data-c":"1D48C",d:"M305 95C305 30 367-8 433-8C533-8 570 140 570 148C570 162 555 162 546 162C528 162 526 160 521 142C513 113 489 28 438 28C422 28 412 37 412 67C412 77 414 96 420 119C423 130 423 137 423 144C423 229 322 245 250 252C260 259 284 275 339 328C416 404 458 416 488 416C507 416 514 404 514 404C464 397 445 357 445 332C445 310 462 286 495 286C514 286 567 299 567 370C567 422 534 452 491 452C430 452 375 408 316 351C306 340 258 294 220 273L316 659C320 673 320 676 320 676C320 689 309 694 298 694C294 694 293 694 291 693L162 687C148 686 130 685 130 657C130 639 149 639 156 639C167 639 185 639 198 637L54 60C53 56 50 41 50 37C50 13 69-8 98-8C116-8 145 1 159 32L205 215C224 213 311 201 311 140C311 129 305 106 305 95Z"})])])],-1)])]))]),C[242]||(C[242]=t(" to non-uniform locations ",-1)),a("mjx-container",P3,[(e(),l("svg",I3,[...C[240]||(C[240]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{x}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{x}"},[a("path",{"data-c":"1D499",d:"M604 364C604 417 551 452 490 452C433 452 396 409 383 391C358 433 302 452 245 452C119 452 51 329 51 296C51 282 66 282 75 282C87 282 94 282 98 295C127 386 199 416 240 416C278 416 296 398 296 366C296 347 282 292 273 256L239 119C224 58 188 28 154 28C149 28 126 28 106 43C142 53 160 87 160 112C160 134 143 158 110 158C75 158 38 129 38 80C38 27 91-8 152-8C209-8 246 35 259 53C284 11 340-8 397-8C523-8 591 115 591 148C591 162 576 162 567 162C555 162 548 162 544 149C515 58 443 28 402 28C364 28 346 46 346 78C346 99 359 152 368 189L403 325C418 385 453 416 488 416C493 416 516 416 536 401C500 391 482 357 482 332C482 310 499 286 532 286C567 286 604 315 604 364Z"})])])],-1)])]))]),C[243]||(C[243]=t("), which can be understood as an interpolation of the coarse-grained velocity field on the chosen points.",-1))]),a("p",null,[C[245]||(C[245]=t("From the above steps, we can directly write the large-scale velocity at ",-1)),a("mjx-container",R3,[(e(),l("svg",N3,[...C[244]||(C[244]=[d("",1)])]))]),C[246]||(C[246]=t(" from the geometry of vortex lines:",-1))]),a("div",G3,[a("mjx-container",J3,[(e(),l("svg",O3,[...C[247]||(C[247]=[d("",1)])]))])]),C[485]||(C[485]=a("p",null,[t("which is analogous to the term for long-range electrostatic forces in e.g. "),a("a",{href:"/VortexPasta.jl/dev/references#Arnold2005"},"Arnold and Holm (2005)"),t(", Eq. (17).")],-1)),C[486]||(C[486]=a("h2",{id:"Ewald-desingularisation",tabindex:"-1"},[t("Desingularisation "),a("a",{class:"header-anchor",href:"#Ewald-desingularisation","aria-label":'Permalink to "Desingularisation {#Ewald-desingularisation}"'},"​")],-1)),a("p",null,[C[251]||(C[251]=t("As discussed in the ",-1)),C[252]||(C[252]=a("a",{href:"/VortexPasta.jl/dev/methods/VFM#VFM-desingularisation"},"VFM page",-1)),C[253]||(C[253]=t(", the Biot–Savart integral must be desingularised if the velocity is to be evaluated on a point ",-1)),a("mjx-container",X3,[(e(),l("svg",q3,[...C[248]||(C[248]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{x} = \\bm{s}_i"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{x}"},[a("path",{"data-c":"1D499",d:"M604 364C604 417 551 452 490 452C433 452 396 409 383 391C358 433 302 452 245 452C119 452 51 329 51 296C51 282 66 282 75 282C87 282 94 282 98 295C127 386 199 416 240 416C278 416 296 398 296 366C296 347 282 292 273 256L239 119C224 58 188 28 154 28C149 28 126 28 106 43C142 53 160 87 160 112C160 134 143 158 110 158C75 158 38 129 38 80C38 27 91-8 152-8C209-8 246 35 259 53C284 11 340-8 397-8C523-8 591 115 591 148C591 162 576 162 567 162C555 162 548 162 544 149C515 58 443 28 402 28C364 28 346 46 346 78C346 99 359 152 368 189L403 325C418 385 453 416 488 416C493 416 516 416 536 401C500 391 482 357 482 332C482 310 499 286 532 286C567 286 604 315 604 364Z"})])])],-1)])])),C[250]||(C[250]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",z3,[...C[249]||(C[249]=[d("",1)])]))]),C[254]||(C[254]=t(" belonging itself to the curve.",-1))]),C[487]||(C[487]=a("p",null,"In this case, the actual velocity that we want to compute is",-1)),a("div",H3,[a("mjx-container",U3,[(e(),l("svg",K3,[...C[255]||(C[255]=[d("",1)])]))])]),a("p",null,[C[257]||(C[257]=t("which basically means that both short-range and long-range components should skip the computation of their respective integrals in the vicinity of ",-1)),a("mjx-container",$3,[(e(),l("svg",Q3,[...C[256]||(C[256]=[d("",1)])]))]),C[258]||(C[258]=t(", and that the ",-1)),C[259]||(C[259]=a("a",{href:"/VortexPasta.jl/dev/methods/VFM#VFM-desingularisation"},"expression for the local velocity",-1)),C[260]||(C[260]=t(" should be used instead.",-1))]),C[488]||(C[488]=d("",1)),a("p",null,[C[263]||(C[263]=t("For the short-range component, it is straightforward to skip the local part of the modified Biot–Savart integral: one just integrates over segments within the cut-off distance, but excluding the two segments which are in direct contact with ",-1)),a("mjx-container",W3,[(e(),l("svg",Y3,[...C[261]||(C[261]=[d("",1)])]))]),C[264]||(C[264]=t(" (the ",-1)),a("mjx-container",C4,[(e(),l("svg",a4,[...C[262]||(C[262]=[d("",1)])]))]),C[265]||(C[265]=t(" region represented in the trefoil figure of the ",-1)),C[266]||(C[266]=a("a",{href:"/VortexPasta.jl/dev/methods/VFM#VFM-desingularisation"},"VFM page",-1)),C[267]||(C[267]=t(").",-1))]),C[489]||(C[489]=a("p",null,[t('In the case of the long-range component special care is needed, as the procedure detailed above computes the full (coarse-grained) Biot–Savart integral, including the "singular" region. As discussed above, the modified long-range integral is actually not singular, so this is not a problem. But it means that we now need to subtract the '),a("em",null,"local"),t(" long-range velocity:")],-1)),a("div",t4,[a("mjx-container",e4,[(e(),l("svg",l4,[...C[268]||(C[268]=[d("",1)])]))])]),C[490]||(C[490]=a("p",null,[t("which can be numerically computed using the same method as for the "),a("em",null,"non-local"),t(" short-range velocity.")],-1)),a("p",null,[C[270]||(C[270]=t("To summarise, in practice the velocity on a vortex position ",-1)),a("mjx-container",d4,[(e(),l("svg",s4,[...C[269]||(C[269]=[d("",1)])]))]),C[271]||(C[271]=t(" is computed as",-1))]),a("div",m4,[a("mjx-container",o4,[(e(),l("svg",r4,[...C[272]||(C[272]=[d("",1)])]))])]),C[491]||(C[491]=a("p",null,"where the first term is computed using an analytical expression based on Taylor expansions, the second and third terms are estimated by numerical integration (using quadratures), and the fourth term is indirectly computed using (non-uniform) fast Fourier transforms.",-1)),C[492]||(C[492]=a("h2",{id:"Numerical-integration",tabindex:"-1"},[t("Numerical integration "),a("a",{class:"header-anchor",href:"#Numerical-integration","aria-label":'Permalink to "Numerical integration {#Numerical-integration}"'},"​")],-1)),C[493]||(C[493]=a("p",null,"Both the short-range and long-range computations use quadrature rules to approximate line integrals using numerical integration. The general strategy that has been implemented is to perform integrals segment-by-segment, and to use a quadrature rule of few points for each segment.",-1)),a("p",null,[C[274]||(C[274]=t("To be more explicit, say that we have a single closed vortex line (for example the ",-1)),C[275]||(C[275]=a("a",{href:"/VortexPasta.jl/dev/methods/VFM#VFM-desingularisation"},"trefoil in the VFM page",-1)),C[276]||(C[276]=t(") and that we want to compute the short-range non-local velocity induced by the vortex on ",-1)),a("mjx-container",n4,[(e(),l("svg",i4,[...C[273]||(C[273]=[d("",1)])]))]),C[277]||(C[277]=t(":",-1))]),a("div",g4,[a("mjx-container",h4,[(e(),l("svg",L4,[...C[278]||(C[278]=[d("",1)])]))])]),a("p",null,[C[289]||(C[289]=t("Here ",-1)),a("mjx-container",p4,[(e(),l("svg",x4,[...C[279]||(C[279]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[290]||(C[290]=t(" is the number of discretisation points of the curve, and the prime over the summation symbol indicates that the indices ",-1)),a("mjx-container",f4,[(e(),l("svg",c4,[...C[280]||(C[280]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"j ∈ \\{i - 1, i\\}"},[a("g",{"data-mml-node":"mi","data-latex":"j"},[a("path",{"data-c":"1D457",d:"M397 621C397 648 383 661 356 661C328 661 300 633 300 605C300 578 313 565 340 565C368 565 397 593 397 621M267 444C214 444 169 404 147 369C120 326 107 299 107 287C107 278 112 274 122 274C127 274 130 275 133 276C138 284 141 291 144 296C176 375 216 414 264 414C282 414 291 400 291 373C291 358 289 341 284 323L192-46C178-104 138-175 75-175C66-175 57-174 48-171C73-161 85-143 85-118C85-92 71-79 44-79C12-79-13-108-13-140C-13-184 30-205 77-205C120-205 160-190 197-160C232-131 254-94 265-51L356 311C359 324 361 337 361 349C361 404 322 444 267 444Z"})])])],-1)])])),C[283]||(C[283]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",k4,[...C[281]||(C[281]=[d("",1)])])),C[284]||(C[284]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",M4,[...C[282]||(C[282]=[d("",1)])]))]),C[291]||(C[291]=t(" (corresponding to the two segments in contact with ",-1)),a("mjx-container",w4,[(e(),l("svg",_4,[...C[285]||(C[285]=[d("",1)])]))]),C[292]||(C[292]=t(") should be excluded. So the integral is split onto ",-1)),a("mjx-container",b4,[(e(),l("svg",Z4,[...C[286]||(C[286]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N - 2"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])])),C[288]||(C[288]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",u4,[...C[287]||(C[287]=[d("",1)])]))]),C[293]||(C[293]=t(" line integrals. The next step is to approximate each of these integrals using a quadrature rule:",-1))]),a("div",v4,[a("mjx-container",y4,[(e(),l("svg",T4,[...C[294]||(C[294]=[d("",1)])]))])]),a("p",null,[C[299]||(C[299]=t("where ",-1)),a("mjx-container",D4,[(e(),l("svg",E4,[...C[295]||(C[295]=[d("",1)])]))]),C[300]||(C[300]=t(" and ",-1)),a("mjx-container",A4,[(e(),l("svg",F4,[...C[296]||(C[296]=[d("",1)])])),C[298]||(C[298]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",S4,[...C[297]||(C[297]=[d("",1)])]))]),C[301]||(C[301]=t(" are appropriately-chosen quadrature weights and points, respectively. In practice, we use ",-1)),C[302]||(C[302]=a("a",{href:"https://en.wikipedia.org/wiki/Gaussian_quadrature#Gauss%E2%80%93Legendre_quadrature",target:"_blank",rel:"noreferrer"},"Gauss–Legendre quadratures",-1)),C[303]||(C[303]=t(" with few (typically ~4) points per segment.",-1))]),C[494]||(C[494]=a("h2",{id:"Ewald-parameters",tabindex:"-1"},[t("Parameter selection "),a("a",{class:"header-anchor",href:"#Ewald-parameters","aria-label":'Permalink to "Parameter selection {#Ewald-parameters}"'},"​")],-1)),a("p",null,[C[312]||(C[312]=t("As detailed above, this method introduces a few parameters which must be tuned for accuracy and performance. In fact, ",-1)),C[313]||(C[313]=a("strong",null,"most of these parameters are related",-1)),C[314]||(C[314]=t(" and should not be treated independently. For instance, the physical- and Fourier-space cut-offs ",-1)),a("mjx-container",j4,[(e(),l("svg",V4,[...C[304]||(C[304]=[d("",1)])]))]),C[315]||(C[315]=t(" and ",-1)),a("mjx-container",B4,[(e(),l("svg",P4,[...C[305]||(C[305]=[d("",1)])]))]),C[316]||(C[316]=t(" are clearly related to the Ewald splitting parameter ",-1)),a("mjx-container",I4,[(e(),l("svg",R4,[...C[306]||(C[306]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"α"},[a("g",{"data-mml-node":"mi","data-latex":"α"},[a("path",{"data-c":"1D6FC",d:"M310 442C241 442 179 412 124 353C69 294 41 229 41 159C41 61 107-11 205-11C274-11 342 16 410 69C425 16 456-11 502-11C538-11 589 27 589 63C589 72 584 76 573 76C566 76 560 72 557 64C549 43 528 18 505 18C488 18 479 50 479 115C479 129 482 140 488 147C515 180 539 218 558 260C583 314 598 354 602 380L602 384C599 391 593 394 586 394C581 393 575 385 568 371C547 299 518 237 479 186L479 236C479 352 421 442 310 442M403 211C403 152 404 116 405 103C340 46 274 18 207 18C150 18 122 53 122 122C122 180 155 288 178 324C216 383 260 413 309 413C340 413 361 401 374 377C381 365 386 353 391 342C399 319 403 258 403 211Z"})])])],-1)])]))]),C[317]||(C[317]=t(". As described in ",-1)),C[318]||(C[318]=a("a",{href:"/VortexPasta.jl/dev/references#Polanco2025"},"Polanco (2025)",-1)),C[319]||(C[319]=t(", these can be related by a unique non-dimensional parameter ",-1)),a("mjx-container",N4,[(e(),l("svg",G4,[...C[307]||(C[307]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"β = α r_\\text{cut} = k_\\text{max} / 2α"},[a("g",{"data-mml-node":"mi","data-latex":"β"},[a("path",{"data-c":"1D6FD",d:"M427 706C298 706 212 553 182 432L30-178C30-189 35-194 44-194L49-194C56-194 61-191 62-184L126 74C148 16 191-13 255-13C317-13 374 6 425 45C496 98 532 167 532 250C532 317 509 367 463 400C520 435 556 480 569 534C572 547 574 560 574 571C574 654 507 706 427 706M306 399C311 402 329 403 358 403C365 403 371 402 378 401C368 399 359 398 350 398L332 398C321 398 312 398 306 399M148 138C148 154 150 170 154 186L213 426C240 534 312 675 426 675C483 675 511 646 511 589C511 575 509 559 504 540C490 484 464 444 425 421C403 429 381 433 359 433C315 433 270 432 270 396C270 389 273 383 278 379C287 372 310 368 349 368C374 368 399 372 422 380C449 358 463 324 463 278C463 253 459 224 451 193C428 103 360 17 256 17C188 17 148 68 148 138Z"})])])],-1)])])),C[310]||(C[310]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",J4,[...C[308]||(C[308]=[d("",1)])])),C[311]||(C[311]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",O4,[...C[309]||(C[309]=[d("",1)])]))]),C[320]||(C[320]=t(" controlling the accuracy of the method.",-1))]),C[495]||(C[495]=a("p",null,"In practice, one recommended way of setting the parameters is as follows:",-1)),a("ol",null,[a("li",null,[a("p",null,[C[337]||(C[337]=t("Start by setting the ",-1)),C[338]||(C[338]=a("strong",null,"physical domain period",-1)),C[339]||(C[339]=t()),a("mjx-container",X4,[(e(),l("svg",q4,[...C[321]||(C[321]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"L"},[a("g",{"data-mml-node":"mi","data-latex":"L"},[a("path",{"data-c":"1D43F",d:"M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"})])])],-1)])]))]),C[340]||(C[340]=t(". It is convenient and standard practice to choose ",-1)),a("mjx-container",z4,[(e(),l("svg",H4,[...C[322]||(C[322]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"L = 2π"},[a("g",{"data-mml-node":"mi","data-latex":"L"},[a("path",{"data-c":"1D43F",d:"M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"})])])],-1)])])),C[324]||(C[324]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",U4,[...C[323]||(C[323]=[d("",1)])]))]),C[341]||(C[341]=t(", which means that the corresponding wavenumbers ",-1)),a("mjx-container",K4,[(e(),l("svg",$4,[...C[325]||(C[325]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"\\bm{k}"},[a("g",{"data-mml-node":"mi","data-latex":"\\boldsymbol{k}"},[a("path",{"data-c":"1D48C",d:"M305 95C305 30 367-8 433-8C533-8 570 140 570 148C570 162 555 162 546 162C528 162 526 160 521 142C513 113 489 28 438 28C422 28 412 37 412 67C412 77 414 96 420 119C423 130 423 137 423 144C423 229 322 245 250 252C260 259 284 275 339 328C416 404 458 416 488 416C507 416 514 404 514 404C464 397 445 357 445 332C445 310 462 286 495 286C514 286 567 299 567 370C567 422 534 452 491 452C430 452 375 408 316 351C306 340 258 294 220 273L316 659C320 673 320 676 320 676C320 689 309 694 298 694C294 694 293 694 291 693L162 687C148 686 130 685 130 657C130 639 149 639 156 639C167 639 185 639 198 637L54 60C53 56 50 41 50 37C50 13 69-8 98-8C116-8 145 1 159 32L205 215C224 213 311 201 311 140C311 129 305 106 305 95Z"})])])],-1)])]))]),C[342]||(C[342]=t(" in long-range computations will be integers (in general, ",-1)),a("mjx-container",Q4,[(e(),l("svg",W4,[...C[326]||(C[326]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"k = 2πn/L"},[a("g",{"data-mml-node":"mi","data-latex":"k"},[a("path",{"data-c":"1D458",d:"M409 353C409 327 423 314 450 314C485 314 508 345 508 379C508 418 476 445 437 445C392 445 344 415 291 356C250 311 217 282 190 269L291 679C289 688 287 694 274 694C242 694 166 685 154 684C139 682 132 675 132 660C132 650 141 645 159 645C178 645 204 646 204 632L59 43C56 32 55 25 55 21C55 0 66-11 87-11C104-11 117-3 124 12C129 21 147 92 179 226C231 221 286 196 286 146C286 131 279 101 279 91C279 34 316-11 373-11C431-11 470 41 490 145C490 154 485 159 475 159C466 159 460 152 457 138C435 59 408 19 375 19C357 19 348 33 348 61C348 77 360 131 360 147C360 204 314 239 221 253C244 269 270 292 298 322C326 352 346 371 359 382C386 404 412 415 435 415C445 415 453 413 459 409C432 404 409 379 409 353Z"})])])],-1)])])),C[328]||(C[328]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",Y4,[...C[327]||(C[327]=[d("",1)])]))]),C[343]||(C[343]=t(" with ",-1)),a("mjx-container",C5,[(e(),l("svg",a5,[...C[329]||(C[329]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"n = 0, ± 1, ± 2, \\ldots"},[a("g",{"data-mml-node":"mi","data-latex":"n"},[a("path",{"data-c":"1D45B",d:"M537 137C514 58 481 18 440 18C427 18 420 28 420 47C420 61 426 84 438 115C478 224 498 296 498 333C498 403 451 442 381 442C322 442 271 416 230 363C222 407 187 442 136 442C80 442 58 390 44 345C34 313 29 294 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C151 413 160 399 160 371C160 358 155 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 111-11C130-11 144-1 151 19C153 24 159 49 170 92L191 181L221 295C232 318 249 341 270 365C299 397 335 413 378 413C411 413 427 391 427 348C427 310 406 234 363 120C356 102 353 87 353 74C353 25 390-11 438-11C482-11 517 14 542 64C561 104 571 131 571 144C571 153 566 158 555 158C552 158 537 149 537 137Z"})])])],-1)])])),C[333]||(C[333]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",t5,[...C[330]||(C[330]=[d("",1)])])),C[334]||(C[334]=a("mjx-break",{size:"2"}," ",-1)),(e(),l("svg",e5,[...C[331]||(C[331]=[d("",1)])])),C[335]||(C[335]=a("mjx-break",{size:"2"}," ",-1)),(e(),l("svg",l5,[...C[332]||(C[332]=[d("",1)])]))]),C[344]||(C[344]=t("). But in principle one can choose any positive value of ",-1)),a("mjx-container",d5,[(e(),l("svg",s5,[...C[336]||(C[336]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"L"},[a("g",{"data-mml-node":"mi","data-latex":"L"},[a("path",{"data-c":"1D43F",d:"M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"})])])],-1)])]))]),C[345]||(C[345]=t(".",-1))])]),a("li",null,[a("p",null,[C[355]||(C[355]=t("Set the ",-1)),C[356]||(C[356]=a("strong",null,"number of Fourier modes",-1)),C[357]||(C[357]=t()),a("mjx-container",m5,[(e(),l("svg",o5,[...C[346]||(C[346]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[358]||(C[358]=t(" in each direction. Choosing ",-1)),a("mjx-container",r5,[(e(),l("svg",n5,[...C[347]||(C[347]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[359]||(C[359]=t(" also sets the ",-1)),C[360]||(C[360]=a("strong",null,"maximum resolved wavenumber",-1)),C[361]||(C[361]=t()),a("mjx-container",i5,[(e(),l("svg",g5,[...C[348]||(C[348]=[d("",1)])])),C[350]||(C[350]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",h5,[...C[349]||(C[349]=[d("",1)])]))]),C[362]||(C[362]=t(" as well as the ",-1)),C[363]||(C[363]=a("strong",null,"physical grid spacing",-1)),C[364]||(C[364]=t()),a("mjx-container",L5,[(e(),l("svg",p5,[...C[351]||(C[351]=[d("",1)])])),C[353]||(C[353]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",x5,[...C[352]||(C[352]=[d("",1)])]))]),C[365]||(C[365]=t(" associated to the long-range fields. The value of ",-1)),a("mjx-container",f5,[(e(),l("svg",c5,[...C[354]||(C[354]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[366]||(C[366]=t(" should be tuned to have a good balance between the time spent on short-range and long-range computations.",-1))])]),a("li",null,[a("p",null,[C[372]||(C[372]=t("Now set the non-dimensional parameter ",-1)),a("mjx-container",k5,[(e(),l("svg",M5,[...C[367]||(C[367]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"β"},[a("g",{"data-mml-node":"mi","data-latex":"β"},[a("path",{"data-c":"1D6FD",d:"M427 706C298 706 212 553 182 432L30-178C30-189 35-194 44-194L49-194C56-194 61-191 62-184L126 74C148 16 191-13 255-13C317-13 374 6 425 45C496 98 532 167 532 250C532 317 509 367 463 400C520 435 556 480 569 534C572 547 574 560 574 571C574 654 507 706 427 706M306 399C311 402 329 403 358 403C365 403 371 402 378 401C368 399 359 398 350 398L332 398C321 398 312 398 306 399M148 138C148 154 150 170 154 186L213 426C240 534 312 675 426 675C483 675 511 646 511 589C511 575 509 559 504 540C490 484 464 444 425 421C403 429 381 433 359 433C315 433 270 432 270 396C270 389 273 383 278 379C287 372 310 368 349 368C374 368 399 372 422 380C449 358 463 324 463 278C463 253 459 224 451 193C428 103 360 17 256 17C188 17 148 68 148 138Z"})])])],-1)])]))]),C[373]||(C[373]=t(" to the desired accuracy. A reasonable choice is ",-1)),a("mjx-container",w5,[(e(),l("svg",_5,[...C[368]||(C[368]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"β = 3.5"},[a("g",{"data-mml-node":"mi","data-latex":"β"},[a("path",{"data-c":"1D6FD",d:"M427 706C298 706 212 553 182 432L30-178C30-189 35-194 44-194L49-194C56-194 61-191 62-184L126 74C148 16 191-13 255-13C317-13 374 6 425 45C496 98 532 167 532 250C532 317 509 367 463 400C520 435 556 480 569 534C572 547 574 560 574 571C574 654 507 706 427 706M306 399C311 402 329 403 358 403C365 403 371 402 378 401C368 399 359 398 350 398L332 398C321 398 312 398 306 399M148 138C148 154 150 170 154 186L213 426C240 534 312 675 426 675C483 675 511 646 511 589C511 575 509 559 504 540C490 484 464 444 425 421C403 429 381 433 359 433C315 433 270 432 270 396C270 389 273 383 278 379C287 372 310 368 349 368C374 368 399 372 422 380C449 358 463 324 463 278C463 253 459 224 451 193C428 103 360 17 256 17C188 17 148 68 148 138Z"})])])],-1)])])),C[370]||(C[370]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",b5,[...C[369]||(C[369]=[d("",1)])]))]),C[374]||(C[374]=t(", which roughly gives ",-1)),a("mjx-container",Z5,[(e(),l("svg",u5,[...C[371]||(C[371]=[d("",1)])]))]),C[375]||(C[375]=t(" relative accuracy.",-1))])]),a("li",null,[a("p",null,[C[384]||(C[384]=t("From ",-1)),a("mjx-container",v5,[(e(),l("svg",y5,[...C[376]||(C[376]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"β"},[a("g",{"data-mml-node":"mi","data-latex":"β"},[a("path",{"data-c":"1D6FD",d:"M427 706C298 706 212 553 182 432L30-178C30-189 35-194 44-194L49-194C56-194 61-191 62-184L126 74C148 16 191-13 255-13C317-13 374 6 425 45C496 98 532 167 532 250C532 317 509 367 463 400C520 435 556 480 569 534C572 547 574 560 574 571C574 654 507 706 427 706M306 399C311 402 329 403 358 403C365 403 371 402 378 401C368 399 359 398 350 398L332 398C321 398 312 398 306 399M148 138C148 154 150 170 154 186L213 426C240 534 312 675 426 675C483 675 511 646 511 589C511 575 509 559 504 540C490 484 464 444 425 421C403 429 381 433 359 433C315 433 270 432 270 396C270 389 273 383 278 379C287 372 310 368 349 368C374 368 399 372 422 380C449 358 463 324 463 278C463 253 459 224 451 193C428 103 360 17 256 17C188 17 148 68 148 138Z"})])])],-1)])]))]),C[385]||(C[385]=t(" and ",-1)),a("mjx-container",T5,[(e(),l("svg",D5,[...C[377]||(C[377]=[d("",1)])]))]),C[386]||(C[386]=t(", one obtains the remaining parameters ",-1)),a("mjx-container",E5,[(e(),l("svg",A5,[...C[378]||(C[378]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"α = k_{\\text{max}} / 2β"},[a("g",{"data-mml-node":"mi","data-latex":"α"},[a("path",{"data-c":"1D6FC",d:"M310 442C241 442 179 412 124 353C69 294 41 229 41 159C41 61 107-11 205-11C274-11 342 16 410 69C425 16 456-11 502-11C538-11 589 27 589 63C589 72 584 76 573 76C566 76 560 72 557 64C549 43 528 18 505 18C488 18 479 50 479 115C479 129 482 140 488 147C515 180 539 218 558 260C583 314 598 354 602 380L602 384C599 391 593 394 586 394C581 393 575 385 568 371C547 299 518 237 479 186L479 236C479 352 421 442 310 442M403 211C403 152 404 116 405 103C340 46 274 18 207 18C150 18 122 53 122 122C122 180 155 288 178 324C216 383 260 413 309 413C340 413 361 401 374 377C381 365 386 353 391 342C399 319 403 258 403 211Z"})])])],-1)])])),C[380]||(C[380]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",F5,[...C[379]||(C[379]=[d("",1)])]))]),C[387]||(C[387]=t(" and ",-1)),a("mjx-container",S5,[(e(),l("svg",j5,[...C[381]||(C[381]=[d("",1)])])),C[383]||(C[383]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",V5,[...C[382]||(C[382]=[d("",1)])]))]),C[388]||(C[388]=t(".",-1))])])]),a("p",null,[C[397]||(C[397]=t("For simplicity here we have assumed that the domain size ",-1)),a("mjx-container",B5,[(e(),l("svg",P5,[...C[389]||(C[389]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"L"},[a("g",{"data-mml-node":"mi","data-latex":"L"},[a("path",{"data-c":"1D43F",d:"M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"})])])],-1)])]))]),C[398]||(C[398]=t(" and the resolution ",-1)),a("mjx-container",I5,[(e(),l("svg",R5,[...C[390]||(C[390]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[399]||(C[399]=t(" are the same in all directions, but things are easy to generalise to different ",-1)),a("mjx-container",N5,[(e(),l("svg",G5,[...C[391]||(C[391]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"L"},[a("g",{"data-mml-node":"mi","data-latex":"L"},[a("path",{"data-c":"1D43F",d:"M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"})])])],-1)])]))]),C[400]||(C[400]=t(" and ",-1)),a("mjx-container",J5,[(e(),l("svg",O5,[...C[392]||(C[392]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[401]||(C[401]=t(" per direction. In all cases, one usually wants the physical grid spacing ",-1)),a("mjx-container",X5,[(e(),l("svg",q5,[...C[393]||(C[393]=[d("",1)])])),C[395]||(C[395]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",z5,[...C[394]||(C[394]=[d("",1)])]))]),C[402]||(C[402]=t(" (or equivalently the maximum resolved wavenumber ",-1)),a("mjx-container",H5,[(e(),l("svg",U5,[...C[396]||(C[396]=[d("",1)])]))]),C[403]||(C[403]=t(") to be the same in all directions.",-1))]),a("div",K5,[C[437]||(C[437]=a("p",{class:"custom-block-title"},"Size of FFTs",-1)),a("p",null,[C[427]||(C[427]=t('It may also be a good idea to "round" the chosen value of ',-1)),a("mjx-container",$5,[(e(),l("svg",Q5,[...C[404]||(C[404]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[428]||(C[428]=t(" so that the FFTs performed in long-range computations have sizes described by powers of 2 or 3 (for which the FFT is most efficient). Note that, to reduce aliasing errors, the NUFFT oversamples the data from ",-1)),a("mjx-container",W5,[(e(),l("svg",Y5,[...C[405]||(C[405]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),C[429]||(C[429]=t(" to ",-1)),a("mjx-container",C6,[(e(),l("svg",a6,[...C[406]||(C[406]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Ñ = σN > N"},[a("g",{"data-mml-node":"mi","data-latex":"Ñ"},[a("path",{"data-c":"D1",d:"M590 766C611 766 637 779 670 804C703 829 719 846 719 853C719 862 714 866 704 866C699 866 694 863 689 858C678 846 625 806 604 806C595 806 587 812 579 825C561 853 542 867 523 867C502 867 477 856 448 833C413 804 395 787 395 780C395 771 400 767 410 767C413 767 418 769 425 774L440 787C470 814 493 827 509 827C516 827 528 816 543 796C558 776 574 766 590 766M644 683C629 683 622 675 622 660C622 650 629 645 644 644C681 643 700 631 700 606C700 601 699 593 696 583L590 162L409 664C403 681 400 683 378 683L254 683C233 683 223 675 223 660C223 649 233 644 254 644C291 644 310 643 310 641L177 105C166 62 136 40 85 39C70 38 62 31 62 16C62 5 68 0 79 0C97 0 155 3 173 3C191 3 252 0 270 0C285 0 292 7 292 22C292 33 284 38 269 39C232 40 214 52 214 77C214 83 215 91 218 101L343 597L551 19C556 6 564 0 575 0C587 0 595 8 598 23L737 580C747 621 779 643 833 644C846 645 852 652 852 666C852 677 846 683 835 683C817 683 758 680 740 680C722 680 662 683 644 683Z"})])])],-1)])])),C[409]||(C[409]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",t6,[...C[407]||(C[407]=[d("",1)])])),C[410]||(C[410]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",e6,[...C[408]||(C[408]=[d("",1)])]))]),C[430]||(C[430]=t(", and this ",-1)),a("mjx-container",l6,[(e(),l("svg",d6,[...C[411]||(C[411]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Ñ"},[a("g",{"data-mml-node":"mi","data-latex":"Ñ"},[a("path",{"data-c":"D1",d:"M590 766C611 766 637 779 670 804C703 829 719 846 719 853C719 862 714 866 704 866C699 866 694 863 689 858C678 846 625 806 604 806C595 806 587 812 579 825C561 853 542 867 523 867C502 867 477 856 448 833C413 804 395 787 395 780C395 771 400 767 410 767C413 767 418 769 425 774L440 787C470 814 493 827 509 827C516 827 528 816 543 796C558 776 574 766 590 766M644 683C629 683 622 675 622 660C622 650 629 645 644 644C681 643 700 631 700 606C700 601 699 593 696 583L590 162L409 664C403 681 400 683 378 683L254 683C233 683 223 675 223 660C223 649 233 644 254 644C291 644 310 643 310 641L177 105C166 62 136 40 85 39C70 38 62 31 62 16C62 5 68 0 79 0C97 0 155 3 173 3C191 3 252 0 270 0C285 0 292 7 292 22C292 33 284 38 269 39C232 40 214 52 214 77C214 83 215 91 218 101L343 597L551 19C556 6 564 0 575 0C587 0 595 8 598 23L737 580C747 621 779 643 833 644C846 645 852 652 852 666C852 677 846 683 835 683C817 683 758 680 740 680C722 680 662 683 644 683Z"})])])],-1)])]))]),C[431]||(C[431]=t(" is the actual size of the performed FFTs. As an example, by default the ",-1)),C[432]||(C[432]=a("a",{href:"/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.NonuniformFFTsBackend"},[a("code",null,"NonuniformFFTsBackend")],-1)),C[433]||(C[433]=t(" in VortexPasta uses an oversampling of ",-1)),a("mjx-container",s6,[(e(),l("svg",m6,[...C[412]||(C[412]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"σ = 3/2"},[a("g",{"data-mml-node":"mi","data-latex":"σ"},[a("path",{"data-c":"1D70E",d:"M525 431L300 431C252 431 207 416 166 385C102 336 38 250 38 148C38 58 100-11 190-11C257-11 317 18 368 76C417 132 441 194 441 263C441 304 432 338 414 366L515 366C550 366 567 378 567 403C567 426 550 431 525 431M107 121C107 180 121 234 150 282C184 338 228 366 283 366C341 366 370 336 370 275C370 250 365 221 355 187C335 116 302 66 256 39C233 25 211 18 191 18C136 18 107 63 107 121Z"})])])],-1)])])),C[414]||(C[414]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",o6,[...C[413]||(C[413]=[d("",1)])]))]),C[434]||(C[434]=t(". Therefore, choosing ",-1)),a("mjx-container",r6,[(e(),l("svg",n6,[...C[415]||(C[415]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N = 85 ≈ 2/3 × 128"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])])),C[419]||(C[419]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",i6,[...C[416]||(C[416]=[d("",1)])])),C[420]||(C[420]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",g6,[...C[417]||(C[417]=[d("",1)])])),C[421]||(C[421]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",h6,[...C[418]||(C[418]=[d("",1)])]))]),C[435]||(C[435]=t(" leads to FFTs of size ",-1)),a("mjx-container",L6,[(e(),l("svg",p6,[...C[422]||(C[422]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Ñ = 128 = 2^7"},[a("g",{"data-mml-node":"mi","data-latex":"Ñ"},[a("path",{"data-c":"D1",d:"M590 766C611 766 637 779 670 804C703 829 719 846 719 853C719 862 714 866 704 866C699 866 694 863 689 858C678 846 625 806 604 806C595 806 587 812 579 825C561 853 542 867 523 867C502 867 477 856 448 833C413 804 395 787 395 780C395 771 400 767 410 767C413 767 418 769 425 774L440 787C470 814 493 827 509 827C516 827 528 816 543 796C558 776 574 766 590 766M644 683C629 683 622 675 622 660C622 650 629 645 644 644C681 643 700 631 700 606C700 601 699 593 696 583L590 162L409 664C403 681 400 683 378 683L254 683C233 683 223 675 223 660C223 649 233 644 254 644C291 644 310 643 310 641L177 105C166 62 136 40 85 39C70 38 62 31 62 16C62 5 68 0 79 0C97 0 155 3 173 3C191 3 252 0 270 0C285 0 292 7 292 22C292 33 284 38 269 39C232 40 214 52 214 77C214 83 215 91 218 101L343 597L551 19C556 6 564 0 575 0C587 0 595 8 598 23L737 580C747 621 779 643 833 644C846 645 852 652 852 666C852 677 846 683 835 683C817 683 758 680 740 680C722 680 662 683 644 683Z"})])])],-1)])])),C[425]||(C[425]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",x6,[...C[423]||(C[423]=[d("",1)])])),C[426]||(C[426]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",f6,[...C[424]||(C[424]=[d("",1)])]))]),C[436]||(C[436]=t(", which is what we want.",-1))])]),C[496]||(C[496]=a("p",null,[t("Another parameter to choose is the "),a("strong",null,"size of the quadrature rules"),t(" for numerical integration. Using Gauss–Legendre quadratures, integrals seem to converge quite fast using a small number of quadrature nodes per filament segment. Typically, using 3 nodes seems to be enough when using "),a("a",{href:"/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.QuinticSplineMethod"},"quintic splines"),t(" to describe filaments.")],-1)),C[497]||(C[497]=a("h2",{id:"Ewald-method-for-the-streamfunction",tabindex:"-1"},[t("Ewald method for the streamfunction "),a("a",{class:"header-anchor",href:"#Ewald-method-for-the-streamfunction","aria-label":'Permalink to "Ewald method for the streamfunction {#Ewald-method-for-the-streamfunction}"'},"​")],-1)),a("p",null,[C[443]||(C[443]=t("As in the case of the velocity, the ",-1)),C[444]||(C[444]=a("a",{href:"/VortexPasta.jl/dev/methods/VFM#Biot-Savart-streamfunction"},"streamfunction integral",-1)),C[445]||(C[445]=t(" decays slowly with the distance ",-1)),a("mjx-container",c6,[(e(),l("svg",k6,[...C[438]||(C[438]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r = |\\bm{x} - \\bm{s}|"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])])),C[441]||(C[441]=a("mjx-break",{size:"4"}," ",-1)),(e(),l("svg",M6,[...C[439]||(C[439]=[d("",1)])])),C[442]||(C[442]=a("mjx-break",{size:"3"}," ",-1)),(e(),l("svg",w6,[...C[440]||(C[440]=[d("",1)])]))]),C[446]||(C[446]=t(", and its computation can be accelerated using Ewald summation. In fact, the Ewald summation method exposed above for the velocity is derived from that for the streamfunction, which is simpler and closer to the way the Ewald method is usually introduced in electrostatics (where the electrostatic potential is the analogue of the streamfunction).",-1))]),a("p",null,[C[450]||(C[450]=t("In the case of the streamfunction, the idea of Ewald summation is to split the singular and slowly-decaying Green's function ",-1)),a("mjx-container",_6,[(e(),l("svg",b6,[...C[447]||(C[447]=[d("",1)])]))]),C[451]||(C[451]=t(" onto a smooth long-range component ",-1)),a("mjx-container",Z6,[(e(),l("svg",u6,[...C[448]||(C[448]=[d("",1)])]))]),C[452]||(C[452]=t(" and a short-range fast-decaying component ",-1)),a("mjx-container",v6,[(e(),l("svg",y6,[...C[449]||(C[449]=[d("",1)])]))]),C[453]||(C[453]=t(". The standard way of doing this is via the identity:",-1))]),a("div",T6,[a("mjx-container",D6,[(e(),l("svg",E6,[...C[454]||(C[454]=[d("",1)])]))])]),a("p",null,[C[458]||(C[458]=t("where ",-1)),a("mjx-container",A6,[(e(),l("svg",F6,[...C[455]||(C[455]=[d("",1)])]))]),C[459]||(C[459]=t(" and ",-1)),a("mjx-container",S6,[(e(),l("svg",j6,[...C[456]||(C[456]=[d("",1)])]))]),C[460]||(C[460]=t(" are respectively the error function and the complementary error function already introduced ",-1)),C[461]||(C[461]=a("a",{href:"/VortexPasta.jl/dev/methods/Ewald#Splitting-the-Biot–Savart-integral"},"above",-1)),C[462]||(C[462]=t(", and ",-1)),a("mjx-container",V6,[(e(),l("svg",B6,[...C[457]||(C[457]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"α"},[a("g",{"data-mml-node":"mi","data-latex":"α"},[a("path",{"data-c":"1D6FC",d:"M310 442C241 442 179 412 124 353C69 294 41 229 41 159C41 61 107-11 205-11C274-11 342 16 410 69C425 16 456-11 502-11C538-11 589 27 589 63C589 72 584 76 573 76C566 76 560 72 557 64C549 43 528 18 505 18C488 18 479 50 479 115C479 129 482 140 488 147C515 180 539 218 558 260C583 314 598 354 602 380L602 384C599 391 593 394 586 394C581 393 575 385 568 371C547 299 518 237 479 186L479 236C479 352 421 442 310 442M403 211C403 152 404 116 405 103C340 46 274 18 207 18C150 18 122 53 122 122C122 180 155 288 178 324C216 383 260 413 309 413C340 413 361 401 374 377C381 365 386 353 391 342C399 319 403 258 403 211Z"})])])],-1)])]))]),C[463]||(C[463]=t(" is the same ",-1)),C[464]||(C[464]=a("strong",null,"Ewald splitting parameter",-1)),C[465]||(C[465]=t(" introduced in that section.",-1))]),C[498]||(C[498]=a("p",null,"This leads to modified integrals for the short-range and long-range streamfunction. For example, the short-range integral is given by:",-1)),a("div",P6,[a("mjx-container",I6,[(e(),l("svg",R6,[...C[466]||(C[466]=[d("",1)])]))])]),a("p",null,[C[469]||(C[469]=t("Taking the curl of those integrals eventually leads to the ",-1)),a("mjx-container",N6,[(e(),l("svg",G6,[...C[467]||(C[467]=[d("",1)])]))]),C[470]||(C[470]=t(" and ",-1)),a("mjx-container",J6,[(e(),l("svg",O6,[...C[468]||(C[468]=[d("",1)])]))]),C[471]||(C[471]=t(" splitting functions that we used for the velocity.",-1))])])}const W6=s(r,[["render",X6]]);export{Q6 as __pageData,W6 as default};
