import{_ as l,o as t,c as e,aA as n,j as a,a as i}from"./chunks/framework.BxmU8EDa.js";const h="/VortexPasta.jl/dev/assets/sdiywtp.ECoPZWaZ.jpeg",p="/VortexPasta.jl/dev/assets/tlcqojp.B-GPQwUm.jpeg",r="/VortexPasta.jl/dev/assets/ilmyssg.BmDAo-3S.jpeg",k="/VortexPasta.jl/dev/assets/tlcqojp.B-GPQwUm.jpeg",d="/VortexPasta.jl/dev/assets/hgelaqq.DpI9J1mB.jpeg",o="/VortexPasta.jl/dev/assets/rhqmogl.BOjJryM8.jpeg",C="/VortexPasta.jl/dev/assets/vortex_ring.CgVWT4wX.mp4",g="/VortexPasta.jl/dev/assets/paraview_vortex_ring.Ckkvpevr.png",m="/VortexPasta.jl/dev/assets/paraview_vortex_ring_ref4.Dm0DzO7-.png",Ha=JSON.parse('{"title":"Vortex ring","description":"","frontmatter":{},"headers":[],"relativePath":"tutorials/01-vortex_ring.md","filePath":"tutorials/01-vortex_ring.md","lastUpdated":null}'),E={name:"tutorials/01-vortex_ring.md"},c={class:"MathJax",jax:"SVG",overflow:"linebreak"},y={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.717ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 759 705"},u={class:"MathJax",jax:"SVG",overflow:"linebreak"},F={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.057ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 467 1000"},v={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.52ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1555.8 1000"},x={class:"MathJax",jax:"SVG",overflow:"linebreak"},f={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.479ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1095.6 1000"},L={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.052ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4001.1 1000"},w={class:"MathJax",jax:"SVG",overflow:"linebreak"},b={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.778ex",height:"2.253ex",role:"img",focusable:"false",viewBox:"0 -748 1670 996"},_={class:"MathJax",jax:"SVG",overflow:"linebreak"},D={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 361 1000"},A={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.125ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3149.4 1000"},B={class:"MathJax",jax:"SVG",overflow:"linebreak"},T={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637"},V={class:"MathJax",jax:"SVG",overflow:"linebreak"},M={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.593ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -677 704 677"},S={class:"MathJax",jax:"SVG",overflow:"linebreak"},P={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.801ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2564 1000"},j={class:"MathJax",jax:"SVG",overflow:"linebreak"},Z={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637"},I={class:"MathJax",jax:"SVG",overflow:"linebreak"},q={style:{"vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.009ex",height:"2.041ex",role:"img",focusable:"false",viewBox:"0 -697 446 902"},R={class:"MathJax",jax:"SVG",overflow:"linebreak"},N={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.98ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1759 1000"},G={class:"MathJax",jax:"SVG",overflow:"linebreak"},z={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.717ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 759 705"},J={class:"MathJax",jax:"SVG",overflow:"linebreak"},O={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},H={class:"MathJax",jax:"SVG",overflow:"linebreak"},K={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.717ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 759 705"},W={class:"MathJax",jax:"SVG",overflow:"linebreak"},U={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.414ex",height:"1.538ex",role:"img",focusable:"false",viewBox:"0 -680 625 680"},Q={class:"mjx-scroll-wrapper"},$={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},X={style:{"vertical-align":"-1.81ex"},xmlns:"http://www.w3.org/2000/svg",width:"29.219ex",height:"4.885ex",role:"img",focusable:"false",viewBox:"0 -1359 12914.8 2159"},Y={class:"MathJax",jax:"SVG",overflow:"linebreak"},ss={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.197ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 529 453"},as={class:"MathJax",jax:"SVG",overflow:"linebreak"},is={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.717ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 759 705"},ts={class:"MathJax",jax:"SVG",overflow:"linebreak"},es={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.885ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 833 716"},ns={class:"tip custom-block"},ls={class:"MathJax",jax:"SVG",overflow:"linebreak"},hs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.885ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 833 1000"},ps={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.782ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2555.8 1000"},rs={class:"MathJax",jax:"SVG",overflow:"linebreak"},ks={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.188ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1851 1000"},ds={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.796ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1677.8 1000"},os={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.88ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 389 1000"},Cs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.301ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1459 1000"},gs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.34ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1918.2 1000"},ms={class:"MathJax",jax:"SVG",overflow:"linebreak"},Es={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.885ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 833 1000"},cs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.782ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2555.8 1000"},ys={class:"MathJax",jax:"SVG",overflow:"linebreak"},us={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.188ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1851 1000"},Fs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.796ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1677.8 1000"},vs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.88ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 389 1000"},xs={class:"MathJax",jax:"SVG",overflow:"linebreak"},fs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.02ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 451 1000"},Ls={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.585ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1584.8 1000"},ws={class:"MathJax",jax:"SVG",overflow:"linebreak"},bs={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.197ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 529 453"},_s={class:"MathJax",jax:"SVG",overflow:"linebreak"},Ds={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.414ex",height:"1.538ex",role:"img",focusable:"false",viewBox:"0 -680 625 680"},As={class:"MathJax",jax:"SVG",overflow:"linebreak"},Bs={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.197ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 529 453"},Ts={class:"MathJax",jax:"SVG",overflow:"linebreak"},Vs={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.885ex",height:"1.62ex",role:"img",focusable:"false",viewBox:"0 -716 833 716"},Ms={class:"MathJax",jax:"SVG",overflow:"linebreak"},Ss={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.548ex",role:"img",focusable:"false",viewBox:"0 -684 681 684"},Ps={class:"MathJax",jax:"SVG",overflow:"linebreak"},js={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.197ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 529 1000"},Zs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.872ex",height:"2.52ex",role:"img",focusable:"false",viewBox:"0 -864 3037.5 1114"},Is={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.267ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1444 1000"},qs={class:"MathJax",jax:"SVG",overflow:"linebreak"},Rs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.414ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 625 1000"},Ns={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.692ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1631.8 1000"},Gs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.809ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3009.8 1000"},zs={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.531ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3328.8 1000"},Js={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.758ex",height:"2.52ex",role:"img",focusable:"false",viewBox:"0 -864 2986.9 1114"},Os={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.277ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 2774.6 1083.9"},Hs={class:"MathJax",jax:"SVG",overflow:"linebreak"},Ks={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.303ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 576 705"},Ws={class:"MathJax",jax:"SVG",overflow:"linebreak"},Us={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.986ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 878 453"},Qs={class:"MathJax",jax:"SVG",overflow:"linebreak"},$s={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.689ex",height:"1.929ex",role:"img",focusable:"false",viewBox:"0 -841.7 1630.6 852.7"},Xs={class:"MathJax",jax:"SVG",overflow:"linebreak"},Ys={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"2.362ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 1044 683"},sa={class:"MathJax",jax:"SVG",overflow:"linebreak"},aa={style:{"vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.299ex",height:"2.036ex",role:"img",focusable:"false",viewBox:"0 -706 574 900"},ia={class:"MathJax",jax:"SVG",overflow:"linebreak"},ta={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.294ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 572 453"},ea={class:"MathJax",jax:"SVG",overflow:"linebreak"},na={style:{"vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.109ex",height:"1.464ex",role:"img",focusable:"false",viewBox:"0 -442 490 647"},la={class:"MathJax",jax:"SVG",overflow:"linebreak"},ha={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.057ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 467 453"},pa={class:"MathJax",jax:"SVG",overflow:"linebreak"},ra={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.848ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -683 1259 705"},ka={class:"MathJax",jax:"SVG",overflow:"linebreak"},da={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"1.548ex",role:"img",focusable:"false",viewBox:"0 -684 681 684"},oa={class:"MathJax",jax:"SVG",overflow:"linebreak"},Ca={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.131ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 500 688"},ga={class:"MathJax",jax:"SVG",overflow:"linebreak"},ma={style:{"vertical-align":"-0.188ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.023ex",height:"1.507ex",role:"img",focusable:"false",viewBox:"0 -583 1778 666"},Ea={class:"MathJax",jax:"SVG",overflow:"linebreak"},ca={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.154ex",height:"1.557ex",role:"img",focusable:"false",viewBox:"0 -666 2278 688"},ya={class:"MathJax",jax:"SVG",overflow:"linebreak"},ua={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.993ex",height:"1.545ex",role:"img",focusable:"false",viewBox:"0 -683 881 683"},Fa={class:"MathJax",jax:"SVG",overflow:"linebreak"},va={style:{"vertical-align":"-0.339ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.798ex",height:"1.934ex",role:"img",focusable:"false",viewBox:"0 -705 1678.7 855"},xa={class:"MathJax",jax:"SVG",overflow:"linebreak"},fa={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.111ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1817 1000"},La={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"14.149ex",height:"2.452ex",role:"img",focusable:"false",viewBox:"0 -833.9 6254 1083.9"},wa={class:"MathJax",jax:"SVG",overflow:"linebreak"},ba={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 361 1000"},_a={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.981ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1759.8 1000"},Da={style:{"vertical-align":"-0.669ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.238ex",height:"2.366ex",role:"img",focusable:"false",viewBox:"0 -750 4525.2 1045.7"},Aa={class:"MathJax",jax:"SVG",overflow:"linebreak"},Ba={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.057ex",height:"1.025ex",role:"img",focusable:"false",viewBox:"0 -442 467 453"},Ta={class:"MathJax",jax:"SVG",overflow:"linebreak"},Va={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.803ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1681 1000"},Ma={class:"MathJax",jax:"SVG",overflow:"linebreak"},Sa={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.964ex",height:"1.773ex",role:"img",focusable:"false",viewBox:"0 -626 868.3 783.8"},Pa={class:"MathJax",jax:"SVG",overflow:"linebreak"},ja={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.009ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1771.9 1000"},Za={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.353ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1924 1000"},Ia={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.964ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2194.2 1000"};function qa(Ra,s,Na,Ga,za,Ja){return t(),e("div",null,[s[206]||(s[206]=n('<h1 id="tutorial-vortex-ring" tabindex="-1">Vortex ring <a class="header-anchor" href="#tutorial-vortex-ring" aria-label="Permalink to &quot;Vortex ring {#tutorial-vortex-ring}&quot;">​</a></h1><p>The following tutorial goes through the simulation of a <strong>single vortex ring</strong> propagating due to its self-induced propulsion.</p><p>The aim is to show how one can:</p><ol><li><p>Discretise a vortex filament using a spatial curve;</p></li><li><p>compute things like the self-induced vortex velocity;</p></li><li><p>simulate the motion of the vortex filament over a time period.</p></li></ol><p>We assume that VortexPasta and GLMakie have been installed following the instructions in the <a href="/VortexPasta.jl/dev/index#Installation">Installation</a> section. The code in this tutorial should be executed in the same local environment where those packages were installed.</p><h2 id="Defining-a-vortex-ring" tabindex="-1">Defining a vortex ring <a class="header-anchor" href="#Defining-a-vortex-ring" aria-label="Permalink to &quot;Defining a vortex ring {#Defining-a-vortex-ring}&quot;">​</a></h2><p>The first thing to do is to define a circular vortex ring. In VortexPasta, curves are initialised using the <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.init"><code>Filaments.init</code></a> function defined in the <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments"><code>VortexPasta.Filaments</code></a> submodule.</p><p>The most straightforward way of defining an arbitrary curve is by first defining a set of discretisation points (which we also call <em>nodes</em>) and then passing that to <code>Filaments.init</code>. In VortexPasta, a point in 3D space is represented by the <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.Vec3"><code>Vec3</code></a> type (which is nothing else than an <code>SVector</code> from the <a href="https://github.com/JuliaArrays/StaticArrays.jl" target="_blank" rel="noreferrer">StaticArrays.jl</a> package).</p><h3 id="tutorial-vortex-ring-init-filament" tabindex="-1">Initialising the ring <a class="header-anchor" href="#tutorial-vortex-ring-init-filament" aria-label="Permalink to &quot;Initialising the ring {#tutorial-vortex-ring-init-filament}&quot;">​</a></h3>',9)),a("p",null,[s[7]||(s[7]=i("Let's define a set of points discretising a circular ring of radius ",-1)),a("mjx-container",c,[(t(),e("svg",y,[...s[0]||(s[0]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"R"},[a("g",{"data-mml-node":"mi","data-latex":"R"},[a("path",{"data-c":"1D445",d:"M739 531C739 582 713 621 662 649C621 672 572 683 517 683L235 683C212 683 202 682 202 659C202 652 205 647 211 646C221 645 229 644 234 644C264 643 281 641 286 640C291 639 294 636 294 631C294 629 293 623 290 613L158 82C153 60 143 46 128 41C121 39 103 38 72 38C50 38 41 37 41 15C41 4 47-1 59 0L183 3L309 0C325-1 333 8 333 23C333 33 322 38 301 38C261 38 241 43 241 52C241 52 242 54 244 68L308 327L423 327C492 327 527 298 527 241C527 232 522 210 513 174C502 132 497 104 497 89C497 13 556-22 632-22C660-22 687-9 714 16C741 41 755 68 755 96C755 106 750 111 739 111C732 111 726 106 723 95C712 64 698 41 682 28C666 15 651 8 636 8C613 8 601 27 601 64C601 88 604 125 611 176C614 197 615 212 615 223C615 276 587 315 531 339C625 362 739 429 739 531M609 616C629 603 639 581 639 550C639 530 635 507 626 480C599 398 531 357 422 357L316 357L379 610C384 631 392 642 403 643C408 644 428 644 463 644C528 644 566 642 609 616Z"})])])],-1)])]))]),s[8]||(s[8]=i(" living on the plane ",-1)),a("mjx-container",u,[(t(),e("svg",F,[...s[1]||(s[1]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"z = 1"},[a("g",{"data-mml-node":"mi","data-latex":"z"},[a("path",{"data-c":"1D467",d:"M162 92L145 90C193 137 230 171 255 194L351 283C374 304 398 330 421 359C452 397 467 420 467 428C467 437 462 442 452 442C445 442 439 438 434 429C409 388 386 368 364 368C342 368 326 386 317 398C293 427 269 442 246 442C220 442 193 430 165 404C137 378 123 352 123 326C123 316 128 311 139 311C146 311 152 316 156 325C167 354 194 368 235 368C249 368 269 363 296 354C320 345 343 340 364 339C308 284 265 244 234 217L145 134C130 119 111 99 90 74C59 35 43 12 43 3C43-6 48-11 59-11C65-11 71-6 78 4C103 43 130 63 158 63C174 63 192 51 212 26C232 1 255-11 278-11C312-11 346 7 382 42C418 77 436 111 436 144C436 153 431 158 420 158C413 158 407 153 402 143C387 100 344 63 288 63C264 63 186 92 162 92Z"})])])],-1)])])),s[3]||(s[3]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",v,[...s[2]||(s[2]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="z = 1"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mn" data-latex="1" transform="translate(1055.8,0)"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path></g></g></g>',1)])]))]),s[9]||(s[9]=i(" and centred at ",-1)),a("mjx-container",x,[(t(),e("svg",f,[...s[4]||(s[4]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\bm{x}_0 = [3, 3, 1]"><g data-mml-node="msub" data-latex="\\boldsymbol{x}_0"><g data-mml-node="mi" data-latex="\\boldsymbol{x}"><path data-c="1D499" d="M604 364C604 417 551 452 490 452C433 452 396 409 383 391C358 433 302 452 245 452C119 452 51 329 51 296C51 282 66 282 75 282C87 282 94 282 98 295C127 386 199 416 240 416C278 416 296 398 296 366C296 347 282 292 273 256L239 119C224 58 188 28 154 28C149 28 126 28 106 43C142 53 160 87 160 112C160 134 143 158 110 158C75 158 38 129 38 80C38 27 91-8 152-8C209-8 246 35 259 53C284 11 340-8 397-8C523-8 591 115 591 148C591 162 576 162 567 162C555 162 548 162 544 149C515 58 443 28 402 28C364 28 346 46 346 78C346 99 359 152 368 189L403 325C418 385 453 416 488 416C493 416 516 416 536 401C500 391 482 357 482 332C482 310 499 286 532 286C567 286 604 315 604 364Z"></path></g><g data-mml-node="mn" transform="translate(692,-150) scale(0.707)" data-latex="0"><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z"></path></g></g></g></g>',1)])])),s[6]||(s[6]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",L,[...s[5]||(s[5]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\bm{x}_0 = [3, 3, 1]"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mo" data-latex="[" transform="translate(1055.8,0)"><path data-c="5B" d="M233-202L159-202L159 702L233 702C248 702 256 710 256 726C256 742 248 750 233 750L114 750L114-250L233-250C248-250 256-242 256-226C256-214 245-202 233-202Z"></path></g><g data-mml-node="mn" data-latex="3" transform="translate(1333.8,0)"><path data-c="33" d="M303 353C369 378 431 441 431 526C431 569 410 604 369 631C333 654 292 666 246 666C201 666 162 654 127 631C88 605 68 571 68 528C68 495 90 472 122 472C154 472 176 495 176 527C176 560 157 578 119 580C145 615 186 633 242 633C302 633 332 598 332 527C332 485 324 450 309 421C282 373 245 364 183 364C171 362 165 357 165 348C165 333 172 333 192 333L235 333C310 333 348 280 348 173C348 88 317 14 241 14C176 14 128 36 99 80C134 79 160 105 160 139C160 173 135 198 101 198C62 198 42 178 42 137C42 88 64 49 108 18C147-9 193-22 244-22C301-22 350-3 393 34C436 71 457 117 457 173C457 267 383 332 303 353Z"></path></g><g data-mml-node="mo" data-latex="," transform="translate(1833.8,0)"><path data-c="2C" d="M139 106C107 106 86 82 86 50C86 20 109-5 139-5C153-5 165-1 174 8L175 0C175-63 154-117 112-160C105-168 101-174 101-178C101-188 105-193 114-193C123-193 135-181 152-158C186-110 203-57 203 0C203 53 185 106 139 106Z"></path></g><g data-mml-node="mn" data-latex="3" transform="translate(2278.4,0)"><path data-c="33" d="M303 353C369 378 431 441 431 526C431 569 410 604 369 631C333 654 292 666 246 666C201 666 162 654 127 631C88 605 68 571 68 528C68 495 90 472 122 472C154 472 176 495 176 527C176 560 157 578 119 580C145 615 186 633 242 633C302 633 332 598 332 527C332 485 324 450 309 421C282 373 245 364 183 364C171 362 165 357 165 348C165 333 172 333 192 333L235 333C310 333 348 280 348 173C348 88 317 14 241 14C176 14 128 36 99 80C134 79 160 105 160 139C160 173 135 198 101 198C62 198 42 178 42 137C42 88 64 49 108 18C147-9 193-22 244-22C301-22 350-3 393 34C436 71 457 117 457 173C457 267 383 332 303 353Z"></path></g><g data-mml-node="mo" data-latex="," transform="translate(2778.4,0)"><path data-c="2C" d="M139 106C107 106 86 82 86 50C86 20 109-5 139-5C153-5 165-1 174 8L175 0C175-63 154-117 112-160C105-168 101-174 101-178C101-188 105-193 114-193C123-193 135-181 152-158C186-110 203-57 203 0C203 53 185 106 139 106Z"></path></g><g data-mml-node="mn" data-latex="1" transform="translate(3223.1,0)"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path></g><g data-mml-node="mo" data-latex="]" transform="translate(3723.1,0)"><path data-c="5D" d="M45-250L164-250L164 750L45 750C30 750 22 742 22 726C22 710 30 702 45 702L119 702L119-202L45-202C30-202 22-210 22-226C22-242 30-250 45-250Z"></path></g></g></g>',1)])]))]),s[10]||(s[10]=i(":",-1))]),s[207]||(s[207]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VortexPasta</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VortexPasta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Filaments</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VortexPasta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Filaments</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vec3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">R </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # radius of the circular ring</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # number of discretisation points</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x⃗₀ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Vec3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ring centre</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">θs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2π</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; length </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">N]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># discretisation angles (we exclude θ = 2π)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">points </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [x⃗₀ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> R </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Vec3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(θ), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(θ), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> θ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">∈</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> θs]</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">16-element Vector{SVector{3, Float64}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [5.0, 3.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.847759065022574, 3.7653668647301797, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.414213562373095, 4.414213562373095, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.7653668647301797, 4.847759065022574, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.0, 5.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.2346331352698208, 4.847759065022574, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.585786437626905, 4.414213562373095, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.1522409349774265, 3.7653668647301797, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.0, 3.0000000000000004, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.1522409349774263, 2.2346331352698208, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.5857864376269046, 1.585786437626905, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.2346331352698194, 1.152240934977427, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.9999999999999996, 1.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.76536686473018, 1.1522409349774267, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.414213562373095, 1.5857864376269046, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.847759065022573, 2.234633135269819, 1.0]</span></span></code></pre></div><p>Now that we have defined a set of points, we can create a filament using <code>Filaments.init</code>. Note that this function requires choosing a <strong>discretisation method</strong> which will be used to interpolate the curve in-between nodes and to estimate curve derivatives. Here we use the <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.QuinticSplineMethod"><code>QuinticSplineMethod</code></a>, which represents curves as <strong>periodic quintic splines</strong> (that is, piecewise polynomials of degree 5):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Filaments</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ClosedFilament, points, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">QuinticSplineMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">16-element ClosedFilament{SVector{3, Float64}, QuinticSplineMethod}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [5.0, 3.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.847759065022574, 3.7653668647301797, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.414213562373095, 4.414213562373095, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.7653668647301797, 4.847759065022574, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.0, 5.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.2346331352698208, 4.847759065022574, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.585786437626905, 4.414213562373095, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.1522409349774265, 3.7653668647301797, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.0, 3.0000000000000004, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.1522409349774263, 2.2346331352698208, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.5857864376269046, 1.585786437626905, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.2346331352698194, 1.152240934977427, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.9999999999999996, 1.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.76536686473018, 1.1522409349774267, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.414213562373095, 1.5857864376269046, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.847759065022573, 2.234633135269819, 1.0]</span></span></code></pre></div><p>Other possible discretisation options are the <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.CubicSplineMethod"><code>CubicSplineMethod</code></a> and <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.FiniteDiffMethod"><code>FiniteDiffMethod</code></a>. The latter estimates derivatives at discretisation points using <strong>finite differences</strong> (based on the locations of neighbouring points), and performs Hermite interpolations using those derivatives to reconstruct the curve in-between nodes.</p><p>Besides, note that the first argument (<a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.ClosedFilament"><code>ClosedFilament</code></a>) is mandatory and is only there to make sure that we&#39;re creating a <em>closed</em> (as opposed to an open-ended) filament. This means in particular that the filament will be automatically &quot;closed&quot; when evaluated outside of its range of definition <code>1:N</code>. For example, one has <code>f[1] == f[N + 1]</code>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] f[N] f[N </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f[1] = [5.0, 3.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f[N] = [4.847759065022573, 2.234633135269819, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f[N + 1] = [5.0, 3.0, 1.0]</span></span></code></pre></div><h3 id="Getting-geometric-information-out-of-a-filament" tabindex="-1">Getting geometric information out of a filament <a class="header-anchor" href="#Getting-geometric-information-out-of-a-filament" aria-label="Permalink to &quot;Getting geometric information out of a filament {#Getting-geometric-information-out-of-a-filament}&quot;">​</a></h3><p>Above we have used the <code>f[i]</code> syntax to obtain the location of a discretisation point. As mentioned, curve locations can also be evaluated in-between discretisation points using <strong>interpolation</strong>. For instance, to evaluate the curve location at some point in-between nodes <code>i</code> and <code>i + 1</code>, one can call <code>f(i, ζ)</code>, where <code>ζ</code> is some real value between 0 and 1. In particular, <code>f(i, 0.5)</code> gives an estimation of the midpoint between both nodes, while <code>f(i, 0.0)</code> and <code>f(i, 1.0)</code> respectively correspond to <code>f[i]</code> and <code>f[i + 1]</code>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f[i] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) f[i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f[i] = [4.847759065022574, 3.7653668647301797, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f(i, 0.0) = [4.847759065022574, 3.7653668647301806, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f(i, 0.5) = [4.662938794254055, 4.111140178487837, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f(i, 1.0) = [4.414213562373094, 4.414213562373094, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f[i + 1] = [4.414213562373095, 4.414213562373095, 1.0]</span></span></code></pre></div><p>A similar syntax can be used to obtain <strong>derivatives</strong> at discretisation points or in-between them:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f[i] f[i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Derivative</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)] f[i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Derivative</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Derivative</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Derivative</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f[i] = [4.847759065022574, 3.7653668647301797, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f[i, Derivative(1)] = [-0.38515318843352947, 0.929842051107465, 2.3118937889532167e-16]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f[i, Derivative(2)] = [-0.4679382003429555, -0.1938263489345129, 5.773260399983122e-16]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f(i, 0.5) = [4.662938794254055, 4.111140178487837, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f(i, 0.5, Derivative(1)) = [-0.5591564491094727, 0.8368367639688045, 3.145509337854615e-16]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">f(i, 0.5, Derivative(2)) = [-0.4211061545451067, -0.28137413676338263, -2.4688284605191013e-16]</span></span></code></pre></div>`,16)),a("p",null,[s[20]||(s[20]=i("These derivatives assume that curves are parametrised as ",-1)),a("mjx-container",w,[(t(),e("svg",b,[...s[11]||(s[11]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\bm{s}(t)"><g data-mml-node="mi" data-latex="\\boldsymbol{s}"><path data-c="1D494" d="M476 364C476 417 423 452 333 452C304 452 248 450 202 415C157 381 141 323 141 298C141 268 155 240 177 222C205 200 222 197 290 184C320 179 380 168 380 123C380 119 380 28 231 28C182 28 145 38 123 54C157 64 178 93 178 123C178 159 149 169 129 169C95 169 57 141 57 91C57 26 127-8 229-8C457-8 457 164 457 164C457 198 440 225 417 245C386 272 348 279 313 285C258 295 219 302 219 339C219 339 219 416 331 416C351 416 387 414 414 394C381 381 372 351 372 337C372 311 393 296 415 296C439 296 476 316 476 364Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(531,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(920,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(1281,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])]))]),s[21]||(s[21]=i(" for ",-1)),a("mjx-container",_,[(t(),e("svg",D,[...s[12]||(s[12]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"t ∈ [0, T]"},[a("g",{"data-mml-node":"mi","data-latex":"t"},[a("path",{"data-c":"1D461",d:"M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"})])])],-1)])])),s[14]||(s[14]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",A,[...s[13]||(s[13]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="t ∈ [0, T]"><g data-mml-node="mo" data-latex="∈"><path data-c="2208" d="M563 4L373 4C310 4 254 25 208 68C162 111 136 163 130 226L563 226C579 226 587 234 587 250C587 266 579 274 563 274L130 274C136 337 162 389 208 432C254 475 310 496 373 496L563 496C579 496 587 504 587 519C587 535 579 543 563 543L373 543C292 543 223 515 166 458C109 401 81 332 81 250C81 168 109 99 166 42C223-15 292-43 373-43L563-43C579-43 587-35 587-19C587-7 576 4 563 4Z"></path></g><g data-mml-node="mo" data-latex="[" transform="translate(944.8,0)"><path data-c="5B" d="M233-202L159-202L159 702L233 702C248 702 256 710 256 726C256 742 248 750 233 750L114 750L114-250L233-250C248-250 256-242 256-226C256-214 245-202 233-202Z"></path></g><g data-mml-node="mn" data-latex="0" transform="translate(1222.8,0)"><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z"></path></g><g data-mml-node="mo" data-latex="," transform="translate(1722.8,0)"><path data-c="2C" d="M139 106C107 106 86 82 86 50C86 20 109-5 139-5C153-5 165-1 174 8L175 0C175-63 154-117 112-160C105-168 101-174 101-178C101-188 105-193 114-193C123-193 135-181 152-158C186-110 203-57 203 0C203 53 185 106 139 106Z"></path></g><g data-mml-node="mi" data-latex="T" transform="translate(2167.4,0)"><path data-c="1D447" d="M344 631C344 628 343 621 340 611L208 83C204 68 200 59 197 55C188 44 154 39 94 39C63 39 49 42 49 16C49 5 56 0 69 0C120 0 192 4 235 3L317 2C331 2 386 0 403 0C420 0 428 8 428 24C428 34 416 39 391 39C339 39 309 41 300 46C297 48 295 52 295 58L430 603C433 617 436 626 439 629C443 635 467 638 511 638C566 638 604 634 623 625C642 616 652 595 652 561C652 543 649 517 644 483C642 475 641 469 641 464C641 453 646 447 657 447C666 447 672 456 675 473L702 645C703 650 704 656 704 662C704 672 694 677 673 677L125 677C99 677 97 674 89 655L30 481C27 472 25 466 24 462C24 452 29 447 40 447C48 447 55 455 60 470C85 543 110 588 133 607C159 628 209 638 282 638L321 638C332 638 344 639 344 631Z"></path></g><g data-mml-node="mo" data-latex="]" transform="translate(2871.4,0)"><path data-c="5D" d="M45-250L164-250L164 750L45 750C30 750 22 742 22 726C22 710 30 702 45 702L119 702L119-202L45-202C30-202 22-210 22-226C22-242 30-250 45-250Z"></path></g></g></g>',1)])]))]),s[22]||(s[22]=i(", and are computed with respect to this parameter. In practice, the parameter ",-1)),a("mjx-container",B,[(t(),e("svg",T,[...s[15]||(s[15]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"t"},[a("g",{"data-mml-node":"mi","data-latex":"t"},[a("path",{"data-c":"1D461",d:"M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"})])])],-1)])]))]),s[23]||(s[23]=i(" roughly corresponds to the integrated arc length (and thus ",-1)),a("mjx-container",V,[(t(),e("svg",M,[...s[16]||(s[16]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"T"},[a("g",{"data-mml-node":"mi","data-latex":"T"},[a("path",{"data-c":"1D447",d:"M344 631C344 628 343 621 340 611L208 83C204 68 200 59 197 55C188 44 154 39 94 39C63 39 49 42 49 16C49 5 56 0 69 0C120 0 192 4 235 3L317 2C331 2 386 0 403 0C420 0 428 8 428 24C428 34 416 39 391 39C339 39 309 41 300 46C297 48 295 52 295 58L430 603C433 617 436 626 439 629C443 635 467 638 511 638C566 638 604 634 623 625C642 616 652 595 652 561C652 543 649 517 644 483C642 475 641 469 641 464C641 453 646 447 657 447C666 447 672 456 675 473L702 645C703 650 704 656 704 662C704 672 694 677 673 677L125 677C99 677 97 674 89 655L30 481C27 472 25 466 24 462C24 452 29 447 40 447C48 447 55 455 60 470C85 543 110 588 133 607C159 628 209 638 282 638L321 638C332 638 344 639 344 631Z"})])])],-1)])]))]),s[24]||(s[24]=i(" is a rough estimation of the total curve length), but this should never be assumed. In particular, the first derivative ",-1)),a("mjx-container",S,[(t(),e("svg",P,[...s[17]||(s[17]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="∂\\bm{s}/∂t"><g data-mml-node="mo" data-latex="∂"><path data-c="2202" d="M528 352C527 392 522 427 515 457C484 585 382 716 235 716C148 716 96 668 84 593C77 549 92 517 132 517C161 517 184 543 176 575C170 598 152 611 123 612C141 659 180 683 239 683C277 683 313 669 347 640C406 589 436 495 435 357C402 426 351 460 283 460C210 460 149 428 102 365C71 323 55 277 55 226C55 204 58 181 64 157C73 120 96 82 131 45C172 0 225-22 292-22C335-22 373-11 407 12C496 71 534 214 528 352M433 245C434 189 425 139 406 94C383 41 344 14 289 14C221 14 177 50 156 123C151 138 149 174 149 230C149 281 155 319 166 344C191 401 231 430 288 430C308 430 326 426 342 418C399 390 431 328 433 245Z"></path></g><g data-mml-node="mi" data-latex="\\boldsymbol{s}" transform="translate(586,0)"><path data-c="1D494" d="M476 364C476 417 423 452 333 452C304 452 248 450 202 415C157 381 141 323 141 298C141 268 155 240 177 222C205 200 222 197 290 184C320 179 380 168 380 123C380 119 380 28 231 28C182 28 145 38 123 54C157 64 178 93 178 123C178 159 149 169 129 169C95 169 57 141 57 91C57 26 127-8 229-8C457-8 457 164 457 164C457 198 440 225 417 245C386 272 348 279 313 285C258 295 219 302 219 339C219 339 219 416 331 416C351 416 387 414 414 394C381 381 372 351 372 337C372 311 393 296 415 296C439 296 476 316 476 364Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(1117,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mo" data-latex="∂" transform="translate(1617,0)"><path data-c="2202" d="M528 352C527 392 522 427 515 457C484 585 382 716 235 716C148 716 96 668 84 593C77 549 92 517 132 517C161 517 184 543 176 575C170 598 152 611 123 612C141 659 180 683 239 683C277 683 313 669 347 640C406 589 436 495 435 357C402 426 351 460 283 460C210 460 149 428 102 365C71 323 55 277 55 226C55 204 58 181 64 157C73 120 96 82 131 45C172 0 225-22 292-22C335-22 373-11 407 12C496 71 534 214 528 352M433 245C434 189 425 139 406 94C383 41 344 14 289 14C221 14 177 50 156 123C151 138 149 174 149 230C149 281 155 319 166 344C191 401 231 430 288 430C308 430 326 426 342 418C399 390 431 328 433 245Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(2203,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g></g></g>',1)])]))]),s[25]||(s[25]=i(" is tangent to the curve but it's not necessarily unitary (which would be the case if ",-1)),a("mjx-container",j,[(t(),e("svg",Z,[...s[18]||(s[18]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"t"},[a("g",{"data-mml-node":"mi","data-latex":"t"},[a("path",{"data-c":"1D461",d:"M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"})])])],-1)])]))]),s[26]||(s[26]=i(" was the actual arc length ",-1)),a("mjx-container",I,[(t(),e("svg",q,[...s[19]||(s[19]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"ξ"},[a("g",{"data-mml-node":"mi","data-latex":"ξ"},[a("path",{"data-c":"1D709",d:"M101 420C101 375 121 340 161 315C69 244 23 174 23 105C23 70 40 42 52 24C69 7 86-6 105-16C154-37 226-64 286-88C307-98 318-101 318-127C318-152 299-175 274-175C246-175 218-165 190-144C185-141 180-139 177-139C168-139 163-144 163-153C163-158 169-165 180-174C207-195 238-205 274-205C331-205 380-152 380-95C380-58 364-34 331-21L271 2C242 13 222 20 211 25L152 48C105 67 81 96 81 133C81 200 149 271 198 297C222 289 251 285 284 285C347 285 379 296 379 319C379 340 351 350 295 350C265 350 238 346 214 339C196 358 187 382 187 412C187 485 239 549 291 575C304 561 325 554 355 554C416 554 446 566 446 589C446 610 418 620 361 620C338 620 318 618 301 615C299 624 298 633 298 643C298 652 300 665 303 680C303 691 298 697 287 697C272 697 265 679 265 644C265 637 267 626 271 609C190 584 101 516 101 420M362 590C376 590 389 589 400 587C388 585 373 584 356 584C343 584 333 585 326 588C335 589 347 590 362 590M294 320C309 320 323 319 334 318C323 315 307 314 287 314C274 314 262 315 253 318C265 319 279 320 294 320Z"})])])],-1)])]))]),s[27]||(s[27]=i(").",-1))]),s[208]||(s[208]=n(`<p>In some cases, one may want to directly obtain geometrically-relevant quantities such as the unit tangent or the curvature vector (see <a href="/VortexPasta.jl/dev/modules/Filaments#Geometric-quantities">Geometric quantities</a> for definitions and a list of possible quantities):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t̂ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f[i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">UnitTangent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()]       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># &quot;t̂&quot; can be typed by t\\hat&lt;tab&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ρ⃗ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f[i, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CurvatureVector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()]   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># &quot;ρ⃗&quot; can be typed by \\rho&lt;tab&gt;\\vec&lt;tab&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t̂ ρ⃗</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">t̂ = [-0.3826834323650905, 0.9238795325112864, 2.2970690026439665e-16]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ρ⃗ = [-0.4619562281753485, -0.19134853493294987, 5.699456887032614e-16]</span></span></code></pre></div>`,3)),a("p",null,[s[30]||(s[30]=i("We can check that both vectors are orthogonal and that their respective norms are 1 and approximately ",-1)),a("mjx-container",R,[(t(),e("svg",N,[...s[28]||(s[28]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="1/R"><g data-mml-node="mn" data-latex="1"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(500,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mi" data-latex="R" transform="translate(1000,0)"><path data-c="1D445" d="M739 531C739 582 713 621 662 649C621 672 572 683 517 683L235 683C212 683 202 682 202 659C202 652 205 647 211 646C221 645 229 644 234 644C264 643 281 641 286 640C291 639 294 636 294 631C294 629 293 623 290 613L158 82C153 60 143 46 128 41C121 39 103 38 72 38C50 38 41 37 41 15C41 4 47-1 59 0L183 3L309 0C325-1 333 8 333 23C333 33 322 38 301 38C261 38 241 43 241 52C241 52 242 54 244 68L308 327L423 327C492 327 527 298 527 241C527 232 522 210 513 174C502 132 497 104 497 89C497 13 556-22 632-22C660-22 687-9 714 16C741 41 755 68 755 96C755 106 750 111 739 111C732 111 726 106 723 95C712 64 698 41 682 28C666 15 651 8 636 8C613 8 601 27 601 64C601 88 604 125 611 176C614 197 615 212 615 223C615 276 587 315 531 339C625 362 739 429 739 531M609 616C629 603 639 581 639 550C639 530 635 507 626 480C599 398 531 357 422 357L316 357L379 610C384 631 392 642 403 643C408 644 428 644 463 644C528 644 566 642 609 616Z"></path></g></g></g>',1)])]))]),s[31]||(s[31]=i(" (where ",-1)),a("mjx-container",G,[(t(),e("svg",z,[...s[29]||(s[29]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"R"},[a("g",{"data-mml-node":"mi","data-latex":"R"},[a("path",{"data-c":"1D445",d:"M739 531C739 582 713 621 662 649C621 672 572 683 517 683L235 683C212 683 202 682 202 659C202 652 205 647 211 646C221 645 229 644 234 644C264 643 281 641 286 640C291 639 294 636 294 631C294 629 293 623 290 613L158 82C153 60 143 46 128 41C121 39 103 38 72 38C50 38 41 37 41 15C41 4 47-1 59 0L183 3L309 0C325-1 333 8 333 23C333 33 322 38 301 38C261 38 241 43 241 52C241 52 242 54 244 68L308 327L423 327C492 327 527 298 527 241C527 232 522 210 513 174C502 132 497 104 497 89C497 13 556-22 632-22C660-22 687-9 714 16C741 41 755 68 755 96C755 106 750 111 739 111C732 111 726 106 723 95C712 64 698 41 682 28C666 15 651 8 636 8C613 8 601 27 601 64C601 88 604 125 611 176C614 197 615 212 615 223C615 276 587 315 531 339C625 362 739 429 739 531M609 616C629 603 639 581 639 550C639 530 635 507 626 480C599 398 531 357 422 357L316 357L379 610C384 631 392 642 403 643C408 644 428 644 463 644C528 644 566 642 609 616Z"})])])],-1)])]))]),s[32]||(s[32]=i(" is the vortex ring radius):",-1))]),s[209]||(s[209]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LinearAlgebra</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> norm, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">⋅</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # the dot product ̇\`⋅\` can be obtained via \\cdot&lt;tab&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t̂ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">⋅</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ρ⃗ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">norm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t̂) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">norm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρ⃗) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">R</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">t̂ ⋅ ρ⃗ = 1.3092045747108292e-31</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">norm(t̂) = 0.9999999999999999</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">norm(ρ⃗) = 0.5000178182534908</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">1 / R = 0.5</span></span></code></pre></div><h3 id="Plotting-the-filament" tabindex="-1">Plotting the filament <a class="header-anchor" href="#Plotting-the-filament" aria-label="Permalink to &quot;Plotting the filament {#Plotting-the-filament}&quot;">​</a></h3><p>We can readily plot our vortex ring using Makie. For convenience, VortexPasta overloads the Makie <code>plot</code> and <code>plot!</code> functions to be able to directly plot filaments.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_theme!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">theme_black</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()                         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># create an empty figure</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># add an Axis3 for plotting in 3D</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlims!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># set axis limits in the z direction</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, f)                           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># plot filament onto axis</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig                                    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># display the figure</span></span></code></pre></div><p><img src="`+h+'" alt=""></p>',6)),a("p",null,[s[34]||(s[34]=i("Note that, by default, the plot simply shows the ",-1)),a("mjx-container",J,[(t(),e("svg",O,[...s[33]||(s[33]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),s[35]||(s[35]=i(" filament nodes (circular markers) joined by straight lines. To see how points are actually interpolated in-between nodes we can use the ",-1)),s[36]||(s[36]=a("code",null,"refinement",-1)),s[37]||(s[37]=i(" keyword argument:",-1))]),s[210]||(s[210]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlims!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, f; refinement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+p+`" alt=""></p><p>It is also possible to plot other quantities such as the estimated tangent and curvature vectors along the curve:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlims!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax, f;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    refinement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, markersize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tangents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tangentcolor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Yellow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># plot tangent vectors</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    curvatures </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, curvaturecolor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :LightBlue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># plot curvature vectors</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    arrows3d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (shaftlength </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vectorpos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># plot vectors at the midpoint in-between nodes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+r+'" alt=""></p><p>See <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.filamentplot!"><code>filamentplot!</code></a> for more details and for other possible options.</p><h2 id="Computing-the-vortex-ring-velocity" tabindex="-1">Computing the vortex ring velocity <a class="header-anchor" href="#Computing-the-vortex-ring-velocity" aria-label="Permalink to &quot;Computing the vortex ring velocity {#Computing-the-vortex-ring-velocity}&quot;">​</a></h2>',7)),a("p",null,[s[40]||(s[40]=i("An isolated vortex ring of radius ",-1)),a("mjx-container",H,[(t(),e("svg",K,[...s[38]||(s[38]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"R"},[a("g",{"data-mml-node":"mi","data-latex":"R"},[a("path",{"data-c":"1D445",d:"M739 531C739 582 713 621 662 649C621 672 572 683 517 683L235 683C212 683 202 682 202 659C202 652 205 647 211 646C221 645 229 644 234 644C264 643 281 641 286 640C291 639 294 636 294 631C294 629 293 623 290 613L158 82C153 60 143 46 128 41C121 39 103 38 72 38C50 38 41 37 41 15C41 4 47-1 59 0L183 3L309 0C325-1 333 8 333 23C333 33 322 38 301 38C261 38 241 43 241 52C241 52 242 54 244 68L308 327L423 327C492 327 527 298 527 241C527 232 522 210 513 174C502 132 497 104 497 89C497 13 556-22 632-22C660-22 687-9 714 16C741 41 755 68 755 96C755 106 750 111 739 111C732 111 726 106 723 95C712 64 698 41 682 28C666 15 651 8 636 8C613 8 601 27 601 64C601 88 604 125 611 176C614 197 615 212 615 223C615 276 587 315 531 339C625 362 739 429 739 531M609 616C629 603 639 581 639 550C639 530 635 507 626 480C599 398 531 357 422 357L316 357L379 610C384 631 392 642 403 643C408 644 428 644 463 644C528 644 566 642 609 616Z"})])])],-1)])]))]),s[41]||(s[41]=i(" and circulation ",-1)),a("mjx-container",W,[(t(),e("svg",U,[...s[39]||(s[39]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Γ"},[a("g",{"data-mml-node":"mi","data-latex":"Γ"},[a("path",{"data-c":"393",d:"M274 641L376 641C443 641 487 626 509 596C538 555 541 520 550 450L583 450L554 680L33 680L33 641L61 641C96 641 117 639 124 634C131 629 135 617 135 599L135 81C135 63 131 51 124 46C117 41 96 39 61 39L33 39L33 0C59 2 110 3 187 3C274 3 330 2 356 0L356 39L320 39C267 39 238 44 233 55C231 60 230 69 230 82L230 606C230 641 236 641 274 641Z"})])])],-1)])]))]),s[42]||(s[42]=i(" is known to translate with a velocity (",-1)),s[43]||(s[43]=a("a",{href:"/VortexPasta.jl/dev/references#Saffman1993"},"Saffman, 1993",-1)),s[44]||(s[44]=i("):",-1))]),a("div",Q,[a("mjx-container",$,[(t(),e("svg",X,[...s[45]||(s[45]=[n(`<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="v_{\\text{ring}} = \\frac{Γ}{4πR} \\left[ \\ln \\left(\\frac{8R}{a}\\right) - Δ \\right],
"><g data-mml-node="msub" data-latex="v_{\\text{ring}}"><g data-mml-node="mi" data-latex="v"><path data-c="1D463" d="M369 391C369 383 378 370 394 350C410 330 418 307 418 281C418 252 404 203 375 134C354 86 306 18 247 18C201 18 178 45 178 100C178 139 197 208 235 307C243 328 247 345 247 357C247 407 213 442 163 442C119 442 84 417 59 367C39 326 29 300 29 287C29 278 34 273 45 273C58 273 60 279 64 293C87 373 119 413 160 413C173 413 180 404 180 385C180 369 175 347 164 318C127 219 108 152 108 115C108 64 125 29 159 10C186-4 214-11 243-11C332-11 394 85 420 162C452 256 468 325 468 369C468 418 452 442 421 442C396 442 369 416 369 391Z"></path></g><g data-mml-node="TeXAtom" transform="translate(518,-150) scale(0.707)" data-latex="{\\text{ring}}" data-mjx-texclass="ORD"><g data-mml-node="mtext" data-latex="\\text{ring}"><path data-c="72" d="M364 378C364 417 327 442 288 442C237 442 198 412 172 351L172 442L28 431L28 393C63 393 84 390 92 384C100 378 104 365 104 342L104 79C104 60 101 48 94 44C87 40 65 38 28 38L28 0L143 3C185 4 228 3 271 0L271 38L247 38C214 38 193 41 186 46C179 51 176 63 176 81L176 232C176 275 184 314 199 347C219 390 248 412 287 413C277 403 272 391 272 377C272 346 287 331 318 331C345 331 364 352 364 378Z"></path><path data-c="69" d="M194 601C194 631 169 657 139 657C109 657 83 631 83 601C83 571 108 544 138 544C169 544 194 570 194 601M143 3L247 0L247 39C214 39 194 41 188 45C182 49 180 60 180 78L180 445L37 433L37 395C70 395 91 392 98 387C105 382 108 368 108 345L108 79C108 60 105 48 98 44C91 40 69 39 33 39L33 0Z" transform="translate(392,0)"></path><path data-c="6E" d="M314 413C359 413 382 378 382 307L382 79C382 60 379 48 372 44C365 40 343 38 306 38L306 0L421 3L535 0L535 38C503 38 482 39 472 42C462 45 458 52 458 64L458 251C458 298 457 331 454 350C444 411 399 442 320 442C257 442 210 412 179 352L179 442L32 431L32 393C68 393 90 390 98 384C106 378 109 365 109 342L109 79C109 60 105 48 98 44C91 40 69 38 32 38L32 0L147 3L261 0L261 38C224 38 203 40 196 44C189 48 185 60 185 79L185 259C185 340 236 413 314 413Z" transform="translate(670,0)"></path><path data-c="67" d="M431 453C393 453 358 438 326 408C296 431 262 442 223 442C137 442 59 378 59 294C59 252 74 218 104 192C85 168 75 141 75 110C75 72 88 43 113 24C71 10 28-26 28-77C28-120 56-154 111-178C153-197 199-206 249-206C300-206 347-197 389-178C444-154 471-120 471-75C471-22 449 17 405 42C359 67 308 70 234 70C190 70 166 70 161 71C133 75 113 102 113 133C113 148 117 162 126 174C154 155 186 145 223 145C309 145 386 209 386 293C386 332 373 364 347 389C372 412 399 423 428 423C423 418 420 410 420 400C420 378 431 367 453 367C474 367 485 378 485 401C485 432 461 453 431 453M223 411C277 411 304 372 304 294C304 215 277 175 223 175C168 175 141 214 141 293C141 372 168 411 223 411M164 4L222 4C274 4 316 1 348-6C391-15 412-39 412-77C412-109 392-134 352-153C321-168 287-175 250-175C214-175 180-168 148-153C107-134 87-109 87-77C87-35 123 4 164 4Z" transform="translate(1226,0)"></path></g></g></g><g data-mml-node="mo" data-latex="=" transform="translate(2066.2,0)"><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mfrac" data-latex="\\frac{Γ}{4πR}" transform="translate(3122,0)"><g data-mml-node="mi" data-latex="Γ" transform="translate(822,676)"><path data-c="393" d="M274 641L376 641C443 641 487 626 509 596C538 555 541 520 550 450L583 450L554 680L33 680L33 641L61 641C96 641 117 639 124 634C131 629 135 617 135 599L135 81C135 63 131 51 124 46C117 41 96 39 61 39L33 39L33 0C59 2 110 3 187 3C274 3 330 2 356 0L356 39L320 39C267 39 238 44 233 55C231 60 230 69 230 82L230 606C230 641 236 641 274 641Z"></path></g><g data-mml-node="mrow" data-latex="4πR" transform="translate(220,-686)"><g data-mml-node="mn" data-latex="4"><path data-c="34" d="M353 677C344 677 336 672 330 663L28 199L28 163L289 163L289 81C289 63 285 51 278 46C271 41 252 39 219 39L194 39L194 0C223 2 269 3 331 3C393 3 439 2 468 0L468 39L443 39C410 39 391 41 384 46C377 51 373 63 373 81L373 163L471 163L471 202L373 202L373 660C373 670 366 677 353 677M295 553L295 202L67 202Z"></path></g><g data-mml-node="mi" data-latex="π" transform="translate(500,0)"><path data-c="1D70B" d="M524 431L194 431C153 431 117 415 88 384C74 369 27 305 27 292C31 285 31 279 43 279C50 279 56 283 62 292C94 341 135 366 184 366L235 366C212 279 170 172 110 45C105 33 102 24 102 19C102-1 113-11 134-11C153-11 167 0 176 21C194 78 207 122 214 152L269 366L372 366C345 247 331 164 331 117C331 68 342-11 379-11C400-11 423 9 423 30C423 35 421 43 417 53C398 100 389 153 389 214C389 261 395 312 406 366L515 366C550 366 567 378 567 403C567 426 549 431 524 431Z"></path></g><g data-mml-node="mi" data-latex="R" transform="translate(1070,0)"><path data-c="1D445" d="M739 531C739 582 713 621 662 649C621 672 572 683 517 683L235 683C212 683 202 682 202 659C202 652 205 647 211 646C221 645 229 644 234 644C264 643 281 641 286 640C291 639 294 636 294 631C294 629 293 623 290 613L158 82C153 60 143 46 128 41C121 39 103 38 72 38C50 38 41 37 41 15C41 4 47-1 59 0L183 3L309 0C325-1 333 8 333 23C333 33 322 38 301 38C261 38 241 43 241 52C241 52 242 54 244 68L308 327L423 327C492 327 527 298 527 241C527 232 522 210 513 174C502 132 497 104 497 89C497 13 556-22 632-22C660-22 687-9 714 16C741 41 755 68 755 96C755 106 750 111 739 111C732 111 726 106 723 95C712 64 698 41 682 28C666 15 651 8 636 8C613 8 601 27 601 64C601 88 604 125 611 176C614 197 615 212 615 223C615 276 587 315 531 339C625 362 739 429 739 531M609 616C629 603 639 581 639 550C639 530 635 507 626 480C599 398 531 357 422 357L316 357L379 610C384 631 392 642 403 643C408 644 428 644 463 644C528 644 566 642 609 616Z"></path></g></g><rect width="2029" height="60" x="120" y="220"></rect></g><g data-mml-node="mrow" data-latex="\\left[ \\ln \\left(\\frac{8R}{a}\\right) - Δ \\right]" transform="translate(5391,0)"><g data-mml-node="mo" data-latex="\\left["><path data-c="5B" d="M448-738L290-738L290 1238L448 1238C468 1238 478 1248 478 1269C478 1290 468 1300 448 1300L230 1300L230-800L448-800C468-800 478-790 478-769C478-753 464-738 448-738Z"></path></g><g data-mml-node="mi" data-latex="\\ln" transform="translate(499,0)"><path data-c="6C" d="M144 3L255 0L255 39C219 39 197 40 190 44C183 48 180 60 180 79L180 694L33 683L33 645C68 645 90 642 97 636C104 630 108 616 108 593L108 79C108 60 105 48 98 44C91 40 69 39 33 39L33 0Z"></path><path data-c="6E" d="M314 413C359 413 382 378 382 307L382 79C382 60 379 48 372 44C365 40 343 38 306 38L306 0L421 3L535 0L535 38C503 38 482 39 472 42C462 45 458 52 458 64L458 251C458 298 457 331 454 350C444 411 399 442 320 442C257 442 210 412 179 352L179 442L32 431L32 393C68 393 90 390 98 384C106 378 109 365 109 342L109 79C109 60 105 48 98 44C91 40 69 38 32 38L32 0L147 3L261 0L261 38C224 38 203 40 196 44C189 48 185 60 185 79L185 259C185 340 236 413 314 413Z" transform="translate(278,0)"></path></g><g data-mml-node="mo" transform="translate(1333,0)"><path data-c="2061" d=""></path></g><g data-mml-node="mrow" data-latex="\\left(\\frac{8R}{a}\\right)" transform="translate(1499.7,0)"><g data-mml-node="mo" data-latex="\\left("><path data-c="28" d="M588-796C601-796 608-789 608-776C608-770 606-765 601-760C500-684 420-552 361-365C310-206 285-51 285 101L285 399C285 551 310 706 361 865C420 1052 500 1184 601 1260C606 1265 608 1270 608 1276C608 1289 601 1296 588 1296C583 1296 579 1295 576 1292C464 1207 372 1071 300 886C234 717 201 554 201 399L201 101C201-54 234-217 300-386C372-571 464-707 576-792C579-795 583-796 588-796Z"></path></g><g data-mml-node="mfrac" data-latex="\\frac{8R}{a}" transform="translate(663,0)"><g data-mml-node="mrow" data-latex="8R" transform="translate(220,676)"><g data-mml-node="mn" data-latex="8"><path data-c="38" d="M250 666C201 666 158 650 122 618C86 586 68 546 68 497C68 456 83 419 113 386C120 378 142 361 179 335C88 288 42 227 42 153C42 100 64 57 107 24C147-7 194-22 249-22C305-22 354-4 395 32C436 68 457 115 457 170C457 216 441 257 408 294C396 307 365 330 316 361C393 402 431 454 431 515C431 606 344 666 250 666M379 515C379 463 348 418 286 381L167 459C136 479 120 505 120 536C120 596 185 633 249 633C318 633 379 584 379 515M250 14C168 14 99 73 99 153C99 220 136 274 210 315L328 240C376 209 400 174 400 134C400 62 325 14 250 14Z"></path></g><g data-mml-node="mi" data-latex="R" transform="translate(500,0)"><path data-c="1D445" d="M739 531C739 582 713 621 662 649C621 672 572 683 517 683L235 683C212 683 202 682 202 659C202 652 205 647 211 646C221 645 229 644 234 644C264 643 281 641 286 640C291 639 294 636 294 631C294 629 293 623 290 613L158 82C153 60 143 46 128 41C121 39 103 38 72 38C50 38 41 37 41 15C41 4 47-1 59 0L183 3L309 0C325-1 333 8 333 23C333 33 322 38 301 38C261 38 241 43 241 52C241 52 242 54 244 68L308 327L423 327C492 327 527 298 527 241C527 232 522 210 513 174C502 132 497 104 497 89C497 13 556-22 632-22C660-22 687-9 714 16C741 41 755 68 755 96C755 106 750 111 739 111C732 111 726 106 723 95C712 64 698 41 682 28C666 15 651 8 636 8C613 8 601 27 601 64C601 88 604 125 611 176C614 197 615 212 615 223C615 276 587 315 531 339C625 362 739 429 739 531M609 616C629 603 639 581 639 550C639 530 635 507 626 480C599 398 531 357 422 357L316 357L379 610C384 631 392 642 403 643C408 644 428 644 463 644C528 644 566 642 609 616Z"></path></g></g><g data-mml-node="mi" data-latex="a" transform="translate(585,-686)"><path data-c="1D44E" d="M498 144C498 153 493 158 482 158C474 158 468 151 465 137C445 58 421 18 394 18C377 18 368 32 368 60C368 73 372 97 381 132L438 357C443 376 445 387 445 392C445 412 434 422 412 422C391 422 377 410 370 387C349 424 319 442 281 442C216 442 159 409 109 343C63 281 40 217 40 150C40 63 91-11 175-11C218-11 260 12 300 58C311 20 345-11 392-11C461-11 482 70 498 144M341 374C350 353 355 339 355 330C355 326 354 321 353 314L304 122C301 111 294 99 285 87C248 41 212 18 177 18C138 18 118 48 118 107C118 131 124 167 136 215C157 300 187 357 224 388C244 405 263 413 282 413C309 413 329 400 341 374Z"></path></g><rect width="1459" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" data-latex="\\right)" transform="translate(2362,0)"><path data-c="29" d="M86-792C198-707 290-571 363-386C429-217 462-54 462 101L462 399C462 554 429 717 363 886C290 1071 198 1207 86 1292C83 1295 80 1296 75 1296C62 1296 55 1289 55 1276C55 1269 57 1264 62 1260C163 1183 243 1052 302 865C353 707 378 552 378 399L378 101C378-51 353-206 302-365C243-552 163-684 62-760C57-764 55-769 55-776C55-789 62-796 75-796C80-796 83-795 86-792Z"></path></g></g><g data-mml-node="mo" data-latex="-" transform="translate(4746.9,0)"><path data-c="2212" d="M698 270L80 270C64 270 56 263 56 250C56 237 64 230 80 230L698 230C714 230 722 237 722 250C722 262 710 270 698 270Z"></path></g><g data-mml-node="mi" data-latex="Δ" transform="translate(5747.1,0)"><path data-c="394" d="M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"></path></g><g data-mml-node="mo" data-latex="\\right]" transform="translate(6580.1,0)"><path data-c="5D" d="M51-800L269-800L269 1300L51 1300C31 1300 21 1290 21 1269C21 1248 31 1238 51 1238L209 1238L209-738L51-738C31-738 21-748 21-769C21-790 31-800 51-800Z"></path></g></g><g data-mml-node="mo" data-latex="," transform="translate(12636.8,0)"><path data-c="2C" d="M139 106C107 106 86 82 86 50C86 20 109-5 139-5C153-5 165-1 174 8L175 0C175-63 154-117 112-160C105-168 101-174 101-178C101-188 105-193 114-193C123-193 135-181 152-158C186-110 203-57 203 0C203 53 185 106 139 106Z"></path></g></g></g>`,1)])]))])]),a("p",null,[s[49]||(s[49]=i("where ",-1)),a("mjx-container",Y,[(t(),e("svg",ss,[...s[46]||(s[46]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"a"},[a("g",{"data-mml-node":"mi","data-latex":"a"},[a("path",{"data-c":"1D44E",d:"M498 144C498 153 493 158 482 158C474 158 468 151 465 137C445 58 421 18 394 18C377 18 368 32 368 60C368 73 372 97 381 132L438 357C443 376 445 387 445 392C445 412 434 422 412 422C391 422 377 410 370 387C349 424 319 442 281 442C216 442 159 409 109 343C63 281 40 217 40 150C40 63 91-11 175-11C218-11 260 12 300 58C311 20 345-11 392-11C461-11 482 70 498 144M341 374C350 353 355 339 355 330C355 326 354 321 353 314L304 122C301 111 294 99 285 87C248 41 212 18 177 18C138 18 118 48 118 107C118 131 124 167 136 215C157 300 187 357 224 388C244 405 263 413 282 413C309 413 329 400 341 374Z"})])])],-1)])]))]),s[50]||(s[50]=i(" is the radius of the vortex core – assumed to be much smaller than ",-1)),a("mjx-container",as,[(t(),e("svg",is,[...s[47]||(s[47]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"R"},[a("g",{"data-mml-node":"mi","data-latex":"R"},[a("path",{"data-c":"1D445",d:"M739 531C739 582 713 621 662 649C621 672 572 683 517 683L235 683C212 683 202 682 202 659C202 652 205 647 211 646C221 645 229 644 234 644C264 643 281 641 286 640C291 639 294 636 294 631C294 629 293 623 290 613L158 82C153 60 143 46 128 41C121 39 103 38 72 38C50 38 41 37 41 15C41 4 47-1 59 0L183 3L309 0C325-1 333 8 333 23C333 33 322 38 301 38C261 38 241 43 241 52C241 52 242 54 244 68L308 327L423 327C492 327 527 298 527 241C527 232 522 210 513 174C502 132 497 104 497 89C497 13 556-22 632-22C660-22 687-9 714 16C741 41 755 68 755 96C755 106 750 111 739 111C732 111 726 106 723 95C712 64 698 41 682 28C666 15 651 8 636 8C613 8 601 27 601 64C601 88 604 125 611 176C614 197 615 212 615 223C615 276 587 315 531 339C625 362 739 429 739 531M609 616C629 603 639 581 639 550C639 530 635 507 626 480C599 398 531 357 422 357L316 357L379 610C384 631 392 642 403 643C408 644 428 644 463 644C528 644 566 642 609 616Z"})])])],-1)])]))]),s[51]||(s[51]=i(" – and ",-1)),a("mjx-container",ts,[(t(),e("svg",es,[...s[48]||(s[48]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Δ"},[a("g",{"data-mml-node":"mi","data-latex":"Δ"},[a("path",{"data-c":"394",d:"M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"})])])],-1)])]))]),s[52]||(s[52]=i(" is a coefficient which depends on the actual vorticity profile at the core.",-1))]),a("div",ns,[s[85]||(s[85]=a("p",{class:"custom-block-title"},"Some typical values of Δ",-1)),a("ul",null,[a("li",null,[a("p",null,[a("mjx-container",ls,[(t(),e("svg",hs,[...s[53]||(s[53]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Δ = 1/2"},[a("g",{"data-mml-node":"mi","data-latex":"Δ"},[a("path",{"data-c":"394",d:"M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"})])])],-1)])])),s[55]||(s[55]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",ps,[...s[54]||(s[54]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Δ = 1/2"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mn" data-latex="1" transform="translate(1055.8,0)"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(1555.8,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mn" data-latex="2" transform="translate(2055.8,0)"><path data-c="32" d="M237 666C186 666 143 648 106 612C69 576 50 534 50 483C50 449 75 424 106 424C136 424 161 450 161 480C161 513 137 536 105 536C102 536 100 536 98 535C117 584 161 627 224 627C306 627 352 556 352 470C352 403 318 331 250 255L62 43C49 28 50 29 50 0L421 0L450 180L417 180C409 129 402 100 396 91C391 86 361 84 306 84L139 84L236 179C304 243 390 312 419 365C439 400 449 435 449 470C449 588 357 666 237 666Z"></path></g></g></g>',1)])]))]),s[65]||(s[65]=i(" for a ",-1)),s[66]||(s[66]=a("strong",null,"hollow vortex",-1)),s[67]||(s[67]=i(": ",-1)),a("mjx-container",rs,[(t(),e("svg",ks,[...s[56]||(s[56]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(r) = ω₀ \\, δ(r - a)"><g data-mml-node="mi" data-latex="ω"><path data-c="1D714" d="M505 391C505 380 509 370 517 363C542 342 554 314 554 280C554 267 553 255 550 244C530 168 477 68 396 68C344 68 313 96 303 152C316 179 326 207 333 238C336 249 337 258 337 264C337 284 329 294 314 294C276 294 266 198 264 156C227 97 184 68 133 68C78 68 51 104 51 175C51 195 54 216 59 238C70 282 99 337 146 402C150 407 152 412 152 417C152 430 145 437 130 437C123 437 116 434 110 427C61 360 13 242 13 133C13 37 49-11 121-11C178-11 227 22 270 87C284 22 322-11 383-11C416-11 447 2 475 28C522 72 557 142 581 238C596 299 604 342 604 369C604 398 597 419 583 432C576 439 567 442 558 442C532 442 505 417 505 391Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(622,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="r" transform="translate(1011,0)"><path data-c="1D45F" d="M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(1462,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])])),s[61]||(s[61]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",ds,[...s[57]||(s[57]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(r) = ω₀ \\, δ(r - a)"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="ω" transform="translate(1055.8,0)"><path data-c="1D714" d="M505 391C505 380 509 370 517 363C542 342 554 314 554 280C554 267 553 255 550 244C530 168 477 68 396 68C344 68 313 96 303 152C316 179 326 207 333 238C336 249 337 258 337 264C337 284 329 294 314 294C276 294 266 198 264 156C227 97 184 68 133 68C78 68 51 104 51 175C51 195 54 216 59 238C70 282 99 337 146 402C150 407 152 412 152 417C152 430 145 437 130 437C123 437 116 434 110 427C61 360 13 242 13 133C13 37 49-11 121-11C178-11 227 22 270 87C284 22 322-11 383-11C416-11 447 2 475 28C522 72 557 142 581 238C596 299 604 342 604 369C604 398 597 419 583 432C576 439 567 442 558 442C532 442 505 417 505 391Z"></path></g></g></g>',1)])])),s[62]||(s[62]=a("mjx-break",{size:"0"}," ",-1)),(t(),e("svg",os,[...s[58]||(s[58]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(r) = ω₀ \\, δ(r - a)"><g data-mml-node="mo" data-latex="₀"><path data-c="2080" d="M55 146C55 21 131-55 202-55C280-55 332 41 332 145C332 253 278 347 202 347C130 347 55 269 55 146M118 139L118 146C118 293 171 324 204 324C244 324 307 269 307 145C307 32 249-32 203-32C169-32 118 0 118 139Z"></path></g><g data-mml-node="mspace" data-latex="\\," transform="translate(389,0)"></g></g></g>',1)])])),s[63]||(s[63]=a("mjx-break",{size:"0"}," ",-1)),(t(),e("svg",Cs,[...s[59]||(s[59]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(r) = ω₀ \\, δ(r - a)"><g data-mml-node="mspace" data-latex="\\,"></g><g data-mml-node="mi" data-latex="δ" transform="translate(167,0)"><path data-c="1D6FF" d="M452 664C452 679 444 689 428 693C377 706 339 712 315 712C244 712 201 672 201 606C201 567 220 511 259 438C156 412 76 321 51 220C46 199 43 178 43 159C43 121 52 87 71 58C101 12 145-11 202-11C244-11 282 8 317 47C372 110 400 190 400 285C400 346 380 402 339 453L332 462C267 546 235 602 235 630C235 636 236 641 239 645C249 663 265 672 288 671C305 671 326 663 351 648C382 629 401 620 408 620C430 620 452 638 452 664M111 131C111 188 125 243 154 297C185 357 225 395 274 410C296 372 311 333 320 294C323 279 324 262 324 245C324 217 321 191 315 166C290 68 252 19 203 19C146 19 111 66 111 131Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(619,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="r" transform="translate(1008,0)"><path data-c="1D45F" d="M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"></path></g></g></g>',1)])])),s[64]||(s[64]=a("mjx-break",{size:"3"}," ",-1)),(t(),e("svg",gs,[...s[60]||(s[60]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(r) = ω₀ \\, δ(r - a)"><g data-mml-node="mo" data-latex="-"><path data-c="2212" d="M698 270L80 270C64 270 56 263 56 250C56 237 64 230 80 230L698 230C714 230 722 237 722 250C722 262 710 270 698 270Z"></path></g><g data-mml-node="mi" data-latex="a" transform="translate(1000.2,0)"><path data-c="1D44E" d="M498 144C498 153 493 158 482 158C474 158 468 151 465 137C445 58 421 18 394 18C377 18 368 32 368 60C368 73 372 97 381 132L438 357C443 376 445 387 445 392C445 412 434 422 412 422C391 422 377 410 370 387C349 424 319 442 281 442C216 442 159 409 109 343C63 281 40 217 40 150C40 63 91-11 175-11C218-11 260 12 300 58C311 20 345-11 392-11C461-11 482 70 498 144M341 374C350 353 355 339 355 330C355 326 354 321 353 314L304 122C301 111 294 99 285 87C248 41 212 18 177 18C138 18 118 48 118 107C118 131 124 167 136 215C157 300 187 357 224 388C244 405 263 413 282 413C309 413 329 400 341 374Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(1529.2,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])]))]),s[68]||(s[68]=i(";",-1))])]),a("li",null,[a("p",null,[a("mjx-container",ms,[(t(),e("svg",Es,[...s[69]||(s[69]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Δ = 1/4"},[a("g",{"data-mml-node":"mi","data-latex":"Δ"},[a("path",{"data-c":"394",d:"M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"})])])],-1)])])),s[71]||(s[71]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",cs,[...s[70]||(s[70]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Δ = 1/4"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mn" data-latex="1" transform="translate(1055.8,0)"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(1555.8,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mn" data-latex="4" transform="translate(2055.8,0)"><path data-c="34" d="M353 677C344 677 336 672 330 663L28 199L28 163L289 163L289 81C289 63 285 51 278 46C271 41 252 39 219 39L194 39L194 0C223 2 269 3 331 3C393 3 439 2 468 0L468 39L443 39C410 39 391 41 384 46C377 51 373 63 373 81L373 163L471 163L471 202L373 202L373 660C373 670 366 677 353 677M295 553L295 202L67 202Z"></path></g></g></g>',1)])]))]),s[80]||(s[80]=i(" for a ",-1)),s[81]||(s[81]=a("strong",null,"uniform vorticity distribution",-1)),s[82]||(s[82]=i(": ",-1)),a("mjx-container",ys,[(t(),e("svg",us,[...s[72]||(s[72]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(r) = ω₀"><g data-mml-node="mi" data-latex="ω"><path data-c="1D714" d="M505 391C505 380 509 370 517 363C542 342 554 314 554 280C554 267 553 255 550 244C530 168 477 68 396 68C344 68 313 96 303 152C316 179 326 207 333 238C336 249 337 258 337 264C337 284 329 294 314 294C276 294 266 198 264 156C227 97 184 68 133 68C78 68 51 104 51 175C51 195 54 216 59 238C70 282 99 337 146 402C150 407 152 412 152 417C152 430 145 437 130 437C123 437 116 434 110 427C61 360 13 242 13 133C13 37 49-11 121-11C178-11 227 22 270 87C284 22 322-11 383-11C416-11 447 2 475 28C522 72 557 142 581 238C596 299 604 342 604 369C604 398 597 419 583 432C576 439 567 442 558 442C532 442 505 417 505 391Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(622,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="r" transform="translate(1011,0)"><path data-c="1D45F" d="M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(1462,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])])),s[75]||(s[75]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",Fs,[...s[73]||(s[73]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(r) = ω₀"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="ω" transform="translate(1055.8,0)"><path data-c="1D714" d="M505 391C505 380 509 370 517 363C542 342 554 314 554 280C554 267 553 255 550 244C530 168 477 68 396 68C344 68 313 96 303 152C316 179 326 207 333 238C336 249 337 258 337 264C337 284 329 294 314 294C276 294 266 198 264 156C227 97 184 68 133 68C78 68 51 104 51 175C51 195 54 216 59 238C70 282 99 337 146 402C150 407 152 412 152 417C152 430 145 437 130 437C123 437 116 434 110 427C61 360 13 242 13 133C13 37 49-11 121-11C178-11 227 22 270 87C284 22 322-11 383-11C416-11 447 2 475 28C522 72 557 142 581 238C596 299 604 342 604 369C604 398 597 419 583 432C576 439 567 442 558 442C532 442 505 417 505 391Z"></path></g></g></g>',1)])])),s[76]||(s[76]=a("mjx-break",{size:"0"}," ",-1)),(t(),e("svg",vs,[...s[74]||(s[74]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"ω(r) = ω₀"},[a("g",{"data-mml-node":"mo","data-latex":"₀"},[a("path",{"data-c":"2080",d:"M55 146C55 21 131-55 202-55C280-55 332 41 332 145C332 253 278 347 202 347C130 347 55 269 55 146M118 139L118 146C118 293 171 324 204 324C244 324 307 269 307 145C307 32 249-32 203-32C169-32 118 0 118 139Z"})])])],-1)])]))]),s[83]||(s[83]=i(" for ",-1)),a("mjx-container",xs,[(t(),e("svg",fs,[...s[77]||(s[77]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"r < a"},[a("g",{"data-mml-node":"mi","data-latex":"r"},[a("path",{"data-c":"1D45F",d:"M436 374C436 416 395 442 351 442C302 442 261 419 227 372C217 411 183 442 136 442C95 442 65 410 44 345C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C150 413 159 399 159 371C159 358 154 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 110-11C130-11 143-1 150 19L169 91C180 134 187 162 190 175L221 303C223 311 231 324 244 343C271 381 302 413 351 413C363 413 373 411 382 406C352 397 337 378 337 351C337 325 351 312 378 312C411 312 436 341 436 374Z"})])])],-1)])])),s[79]||(s[79]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",Ls,[...s[78]||(s[78]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="r &lt; a"><g data-mml-node="mo" data-latex="&lt;"><path data-c="3C" d="M666-45C683-52 701-39 701-23C701-13 696-6 687-2L153 250L687 502C696 506 701 513 701 522C701 539 693 547 677 547C673 547 669 546 666 545L92 273C82 268 77 261 77 250C77 239 82 232 92 227Z"></path></g><g data-mml-node="mi" data-latex="a" transform="translate(1055.8,0)"><path data-c="1D44E" d="M498 144C498 153 493 158 482 158C474 158 468 151 465 137C445 58 421 18 394 18C377 18 368 32 368 60C368 73 372 97 381 132L438 357C443 376 445 387 445 392C445 412 434 422 412 422C391 422 377 410 370 387C349 424 319 442 281 442C216 442 159 409 109 343C63 281 40 217 40 150C40 63 91-11 175-11C218-11 260 12 300 58C311 20 345-11 392-11C461-11 482 70 498 144M341 374C350 353 355 339 355 330C355 326 354 321 353 314L304 122C301 111 294 99 285 87C248 41 212 18 177 18C138 18 118 48 118 107C118 131 124 167 136 215C157 300 187 357 224 388C244 405 263 413 282 413C309 413 329 400 341 374Z"></path></g></g></g>',1)])]))]),s[84]||(s[84]=i(".",-1))])])])]),a("p",null,[s[87]||(s[87]=i("This velocity can be derived by computing the Biot–Savart integral along the circular vortex ring and excluding a very small region (proportional to ",-1)),a("mjx-container",ws,[(t(),e("svg",bs,[...s[86]||(s[86]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"a"},[a("g",{"data-mml-node":"mi","data-latex":"a"},[a("path",{"data-c":"1D44E",d:"M498 144C498 153 493 158 482 158C474 158 468 151 465 137C445 58 421 18 394 18C377 18 368 32 368 60C368 73 372 97 381 132L438 357C443 376 445 387 445 392C445 412 434 422 412 422C391 422 377 410 370 387C349 424 319 442 281 442C216 442 159 409 109 343C63 281 40 217 40 150C40 63 91-11 175-11C218-11 260 12 300 58C311 20 345-11 392-11C461-11 482 70 498 144M341 374C350 353 355 339 355 330C355 326 354 321 353 314L304 122C301 111 294 99 285 87C248 41 212 18 177 18C138 18 118 48 118 107C118 131 124 167 136 215C157 300 187 357 224 388C244 405 263 413 282 413C309 413 329 400 341 374Z"})])])],-1)])]))]),s[88]||(s[88]=i(") from the integral, in the vicinity of the point of interest, thus avoiding the singularity.",-1))]),s[211]||(s[211]=n('<p>In VortexPasta, the velocity induced by one or more vortex filaments is computed by the <a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart"><code>VortexPasta.BiotSavart</code></a> submodule. The basic steps for computing the velocity induced by a set of vortices on itself is:</p><ol><li><p>Set physical and numerical parameters (<a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.ParamsBiotSavart"><code>ParamsBiotSavart</code></a>),</p></li><li><p>initialise a &quot;cache&quot; containing arrays and data needed for computations (<a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.init_cache"><code>BiotSavart.init_cache</code></a>),</p></li><li><p>compute filament velocities from their positions (<a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.velocity_on_nodes"><code>velocity_on_nodes</code></a>).</p></li></ol><h3 id="Physical-and-numerical-parameters" tabindex="-1">Physical and numerical parameters <a class="header-anchor" href="#Physical-and-numerical-parameters" aria-label="Permalink to &quot;Physical and numerical parameters {#Physical-and-numerical-parameters}&quot;">​</a></h3><p>Before being able to estimate the vortex ring velocity, we need to set the parameters needed to estimate Biot–Savart integrals. All of the required and optional parameters are described in <a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.ParamsBiotSavart"><code>ParamsBiotSavart</code></a>.</p><p>Relevant <strong>physical parameters</strong> are of two types:</p>',5)),a("ul",null,[a("li",null,[a("p",null,[s[92]||(s[92]=a("strong",null,"vortex properties",-1)),s[93]||(s[93]=i(": circulation ",-1)),a("mjx-container",_s,[(t(),e("svg",Ds,[...s[89]||(s[89]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Γ"},[a("g",{"data-mml-node":"mi","data-latex":"Γ"},[a("path",{"data-c":"393",d:"M274 641L376 641C443 641 487 626 509 596C538 555 541 520 550 450L583 450L554 680L33 680L33 641L61 641C96 641 117 639 124 634C131 629 135 617 135 599L135 81C135 63 131 51 124 46C117 41 96 39 61 39L33 39L33 0C59 2 110 3 187 3C274 3 330 2 356 0L356 39L320 39C267 39 238 44 233 55C231 60 230 69 230 82L230 606C230 641 236 641 274 641Z"})])])],-1)])]))]),s[94]||(s[94]=i(", core radius ",-1)),a("mjx-container",As,[(t(),e("svg",Bs,[...s[90]||(s[90]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"a"},[a("g",{"data-mml-node":"mi","data-latex":"a"},[a("path",{"data-c":"1D44E",d:"M498 144C498 153 493 158 482 158C474 158 468 151 465 137C445 58 421 18 394 18C377 18 368 32 368 60C368 73 372 97 381 132L438 357C443 376 445 387 445 392C445 412 434 422 412 422C391 422 377 410 370 387C349 424 319 442 281 442C216 442 159 409 109 343C63 281 40 217 40 150C40 63 91-11 175-11C218-11 260 12 300 58C311 20 345-11 392-11C461-11 482 70 498 144M341 374C350 353 355 339 355 330C355 326 354 321 353 314L304 122C301 111 294 99 285 87C248 41 212 18 177 18C138 18 118 48 118 107C118 131 124 167 136 215C157 300 187 357 224 388C244 405 263 413 282 413C309 413 329 400 341 374Z"})])])],-1)])]))]),s[95]||(s[95]=i(" and core parameter ",-1)),a("mjx-container",Ts,[(t(),e("svg",Vs,[...s[91]||(s[91]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Δ"},[a("g",{"data-mml-node":"mi","data-latex":"Δ"},[a("path",{"data-c":"394",d:"M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"})])])],-1)])]))]),s[96]||(s[96]=i(";",-1))])]),a("li",null,[a("p",null,[s[98]||(s[98]=a("strong",null,"domain size",-1)),s[99]||(s[99]=i(" (or period) ",-1)),a("mjx-container",Ms,[(t(),e("svg",Ss,[...s[97]||(s[97]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"L"},[a("g",{"data-mml-node":"mi","data-latex":"L"},[a("path",{"data-c":"1D43F",d:"M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"})])])],-1)])]))]),s[100]||(s[100]=i(".",-1))])])]),s[212]||(s[212]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Γ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # vortex circulation                              || &quot;Γ&quot; can be typed by \\Gamma&lt;tab&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-8</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # vortex core size</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Δ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # vortex core parameter (1/2 for a hollow vortex) || &quot;Δ&quot; can be typed by \\Delta&lt;tab&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2π</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # domain period (same in all directions in this case)</span></span></code></pre></div>`,1)),a("p",null,[s[120]||(s[120]=i("Note that here we work with nondimensional quantities, but we could try to relate these physical parameters to actual properties of, say, liquid helium-4. In this case, the vortex core size is ",-1)),a("mjx-container",Ps,[(t(),e("svg",js,[...s[101]||(s[101]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"a ≈ 10^{-8}\\,\\text{cm}"},[a("g",{"data-mml-node":"mi","data-latex":"a"},[a("path",{"data-c":"1D44E",d:"M498 144C498 153 493 158 482 158C474 158 468 151 465 137C445 58 421 18 394 18C377 18 368 32 368 60C368 73 372 97 381 132L438 357C443 376 445 387 445 392C445 412 434 422 412 422C391 422 377 410 370 387C349 424 319 442 281 442C216 442 159 409 109 343C63 281 40 217 40 150C40 63 91-11 175-11C218-11 260 12 300 58C311 20 345-11 392-11C461-11 482 70 498 144M341 374C350 353 355 339 355 330C355 326 354 321 353 314L304 122C301 111 294 99 285 87C248 41 212 18 177 18C138 18 118 48 118 107C118 131 124 167 136 215C157 300 187 357 224 388C244 405 263 413 282 413C309 413 329 400 341 374Z"})])])],-1)])])),s[104]||(s[104]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",Zs,[...s[102]||(s[102]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="a ≈ 10^{-8}\\,\\text{cm}"><g data-mml-node="mo" data-latex="≈"><path data-c="2248" d="M717 432L717 434C717 445 712 450 701 450C694 450 689 446 686 439C679 404 665 377 645 360C612 331 577 317 539 317C510 317 480 328 449 349C392 390 358 413 347 420C304 445 266 457 232 457C125 457 77 382 56 284L56 281C56 271 61 266 72 266C81 266 86 270 88 278C95 313 108 339 128 356C161 385 196 399 235 399C264 399 293 388 324 366C381 326 415 303 426 296C469 271 507 259 541 259C648 259 696 334 717 432M717 216L717 219C717 229 712 234 701 234C694 234 689 230 686 223C679 188 665 162 645 144C612 115 577 101 539 101C510 101 480 112 449 134C392 174 358 197 347 204C304 229 266 241 232 241C125 241 77 166 56 68L56 66C56 55 61 50 72 50C81 50 86 54 88 62C95 97 108 123 128 140C161 169 196 183 235 183C264 183 293 172 324 151C381 110 415 87 426 80C469 55 507 43 541 43C648 43 696 118 717 216Z"></path></g><g data-mml-node="msup" data-latex="10^{-8}" transform="translate(1050.8,0)"><g data-mml-node="mn" data-latex="10"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z" transform="translate(500,0)"></path></g><g data-mml-node="TeXAtom" transform="translate(1033,393.1) scale(0.707)" data-latex="{-8}" data-mjx-texclass="ORD"><g data-mml-node="mo" data-latex="-"><path data-c="2212" d="M698 270L80 270C64 270 56 263 56 250C56 237 64 230 80 230L698 230C714 230 722 237 722 250C722 262 710 270 698 270Z"></path></g><g data-mml-node="mn" data-latex="8" transform="translate(778,0)"><path data-c="38" d="M250 666C201 666 158 650 122 618C86 586 68 546 68 497C68 456 83 419 113 386C120 378 142 361 179 335C88 288 42 227 42 153C42 100 64 57 107 24C147-7 194-22 249-22C305-22 354-4 395 32C436 68 457 115 457 170C457 216 441 257 408 294C396 307 365 330 316 361C393 402 431 454 431 515C431 606 344 666 250 666M379 515C379 463 348 418 286 381L167 459C136 479 120 505 120 536C120 596 185 633 249 633C318 633 379 584 379 515M250 14C168 14 99 73 99 153C99 220 136 274 210 315L328 240C376 209 400 174 400 134C400 62 325 14 250 14Z"></path></g></g></g><g data-mml-node="mspace" data-latex="\\," transform="translate(3037.5,0)"></g></g></g>',1)])])),s[105]||(s[105]=a("mjx-break",{size:"0"}," ",-1)),(t(),e("svg",Is,[...s[103]||(s[103]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="a ≈ 10^{-8}\\,\\text{cm}"><g data-mml-node="mspace" data-latex="\\,"></g><g data-mml-node="mtext" data-latex="\\text{cm}" transform="translate(167,0)"><path data-c="63" d="M251 416C293 416 325 406 347 386C323 383 306 361 306 338C306 305 322 289 355 289C388 289 404 306 404 339C404 410 327 448 250 448C188 448 137 426 96 380C55 334 34 279 34 216C34 155 55 101 96 56C137 11 187-11 248-11C298-11 337 3 365 32C388 55 403 78 411 102C414 111 415 117 415 121C415 130 409 134 398 134C390 134 385 130 382 122C361 55 320 21 257 21C228 21 200 34 172 61C139 92 123 144 123 218C123 318 161 416 251 416Z"></path><path data-c="6D" d="M315 413C361 413 384 378 384 307L384 79C384 60 381 48 374 44C367 40 344 38 307 38L307 0L423 3L538 0L538 38C501 38 479 40 472 44C465 48 461 60 461 79L461 259C461 339 513 413 590 413C637 413 660 378 660 307L660 79C660 60 656 48 649 44C642 40 619 38 582 38L582 0L698 3L813 0L813 38C781 38 760 39 750 42C740 45 736 52 736 64L736 251C736 298 734 331 731 350C721 411 676 442 597 442C534 442 487 413 455 354C441 413 397 442 322 442C259 442 211 412 179 352L179 442L32 431L32 393C68 393 90 390 98 384C106 378 109 365 109 342L109 79C109 60 105 48 98 44C91 40 69 38 32 38L32 0L148 3L263 0L263 38C226 38 203 40 196 44C189 48 185 60 185 79L185 259C185 340 238 413 315 413Z" transform="translate(444,0)"></path></g></g></g>',1)])]))]),s[121]||(s[121]=i(" and the quantum of circulation is ",-1)),a("mjx-container",qs,[(t(),e("svg",Rs,[...s[106]||(s[106]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"Γ = κ = h/m ≈ 0.997 × 10^{-3}\\,\\text{cm}^2/\\text{s}"},[a("g",{"data-mml-node":"mi","data-latex":"Γ"},[a("path",{"data-c":"393",d:"M274 641L376 641C443 641 487 626 509 596C538 555 541 520 550 450L583 450L554 680L33 680L33 641L61 641C96 641 117 639 124 634C131 629 135 617 135 599L135 81C135 63 131 51 124 46C117 41 96 39 61 39L33 39L33 0C59 2 110 3 187 3C274 3 330 2 356 0L356 39L320 39C267 39 238 44 233 55C231 60 230 69 230 82L230 606C230 641 236 641 274 641Z"})])])],-1)])])),s[112]||(s[112]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",Ns,[...s[107]||(s[107]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Γ = κ = h/m ≈ 0.997 × 10^{-3}\\,\\text{cm}^2/\\text{s}"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="κ" transform="translate(1055.8,0)"><path data-c="1D705" d="M515 393C515 416 496 431 471 431C452 431 432 426 409 415C380 401 346 378 307 345C256 301 217 274 190 264C202 313 214 362 225 411C225 432 214 442 193 442C170 442 156 429 150 404L59 43C56 32 55 24 55 19C55-1 66-11 87-11C127-11 131 34 140 68L145 88C148 97 152 113 158 137L180 226C287 221 341 195 341 146C341 135 334 101 334 90C334 33 372-11 429-11C486-11 525 41 546 144C546 153 541 158 530 158C522 158 516 151 513 137C492 58 465 18 431 18C412 18 403 33 403 62C403 75 406 93 411 116C414 131 416 142 416 149C416 212 356 247 235 254C254 266 281 286 314 314C357 350 391 375 418 388C417 383 416 379 416 374C416 349 430 336 457 336C487 336 515 363 515 393Z"></path></g></g></g>',1)])])),s[113]||(s[113]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",Gs,[...s[108]||(s[108]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Γ = κ = h/m ≈ 0.997 × 10^{-3}\\,\\text{cm}^2/\\text{s}"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="h" transform="translate(1055.8,0)"><path data-c="210E" d="M512 138C489 59 457 19 415 19C402 19 395 28 395 47C395 62 401 85 413 116C453 223 473 296 473 335C473 406 427 445 356 445C303 445 257 423 218 380L291 679C289 688 287 694 274 694C241 694 168 685 155 684C140 682 132 675 132 660C132 650 141 645 159 645C180 645 203 646 205 632L59 43C56 32 55 25 55 21C55 0 66-11 87-11C107-11 121-1 128 18L168 182C180 231 189 268 196 293C199 300 207 314 220 334C256 388 300 415 353 415C386 415 402 393 402 350C402 309 382 236 342 130C333 107 329 89 329 74C329 26 365-11 413-11C457-11 492 14 517 65C536 105 546 132 546 145C546 154 541 159 530 159C527 159 512 150 512 138Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(1631.8,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mi" data-latex="m" transform="translate(2131.8,0)"><path data-c="1D45A" d="M657 442C596 442 543 412 498 353C489 412 451 442 383 442C324 442 273 416 231 363C223 407 188 442 137 442C96 442 66 409 45 344C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 66 299C84 375 107 413 134 413C152 413 161 399 161 371C161 358 156 331 145 290L88 63C84 51 79 25 79 19C79-1 90-11 111-11C131-11 145-1 152 19C153 24 160 49 171 92L192 181L222 295C233 318 250 341 272 365C301 397 337 413 380 413C413 413 429 391 429 348C429 335 424 308 414 267L387 153C380 124 364 64 356 32C355 25 354 21 354 19C354-1 365-11 387-11C398-11 406-8 413-1C428 14 429 21 435 48L494 285C497 298 511 321 535 353C565 393 605 413 654 413C687 413 703 391 703 348C703 309 683 236 642 129C633 106 629 87 629 74C629 25 666-11 714-11C759-11 793 14 818 64C838 104 848 131 848 144C848 153 843 158 832 158C825 157 818 148 813 137C791 58 759 18 716 18C703 18 696 28 696 47C696 62 702 84 714 115C755 222 775 295 775 333C775 404 728 442 657 442Z"></path></g></g></g>',1)])])),s[114]||(s[114]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",zs,[...s[109]||(s[109]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Γ = κ = h/m ≈ 0.997 × 10^{-3}\\,\\text{cm}^2/\\text{s}"><g data-mml-node="mo" data-latex="≈"><path data-c="2248" d="M717 432L717 434C717 445 712 450 701 450C694 450 689 446 686 439C679 404 665 377 645 360C612 331 577 317 539 317C510 317 480 328 449 349C392 390 358 413 347 420C304 445 266 457 232 457C125 457 77 382 56 284L56 281C56 271 61 266 72 266C81 266 86 270 88 278C95 313 108 339 128 356C161 385 196 399 235 399C264 399 293 388 324 366C381 326 415 303 426 296C469 271 507 259 541 259C648 259 696 334 717 432M717 216L717 219C717 229 712 234 701 234C694 234 689 230 686 223C679 188 665 162 645 144C612 115 577 101 539 101C510 101 480 112 449 134C392 174 358 197 347 204C304 229 266 241 232 241C125 241 77 166 56 68L56 66C56 55 61 50 72 50C81 50 86 54 88 62C95 97 108 123 128 140C161 169 196 183 235 183C264 183 293 172 324 151C381 110 415 87 426 80C469 55 507 43 541 43C648 43 696 118 717 216Z"></path></g><g data-mml-node="mn" data-latex="0.997" transform="translate(1050.8,0)"><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z"></path><path data-c="2E" d="M192 53C192 82 168 106 139 106C110 106 86 82 86 53C86 24 110 0 139 0C168 0 192 24 192 53Z" transform="translate(500,0)"></path><path data-c="39" d="M116 140C83 140 67 123 67 89C67 14 128-22 207-22C287-22 351 18 398 99C437 166 457 243 457 329C457 456 434 546 388 599C349 644 304 666 253 666C194 666 145 645 106 602C63 557 42 503 42 440C42 379 60 327 96 284C134 238 183 215 242 215C294 215 334 243 361 299L361 286C361 177 342 103 303 63C272 30 239 14 206 14C166 14 137 23 118 42C149 42 165 60 165 91C165 119 144 140 116 140M243 246C204 246 175 266 155 306C144 329 138 374 138 439C138 504 145 548 158 573C180 613 212 633 253 633C294 633 324 608 343 558C354 531 361 485 361 420C361 333 322 246 243 246Z" transform="translate(778,0)"></path><path data-c="39" d="M116 140C83 140 67 123 67 89C67 14 128-22 207-22C287-22 351 18 398 99C437 166 457 243 457 329C457 456 434 546 388 599C349 644 304 666 253 666C194 666 145 645 106 602C63 557 42 503 42 440C42 379 60 327 96 284C134 238 183 215 242 215C294 215 334 243 361 299L361 286C361 177 342 103 303 63C272 30 239 14 206 14C166 14 137 23 118 42C149 42 165 60 165 91C165 119 144 140 116 140M243 246C204 246 175 266 155 306C144 329 138 374 138 439C138 504 145 548 158 573C180 613 212 633 253 633C294 633 324 608 343 558C354 531 361 485 361 420C361 333 322 246 243 246Z" transform="translate(1278,0)"></path><path data-c="37" d="M475 604C482 613 485 626 485 644L243 644C174 644 135 648 128 657C125 660 122 667 120 676L89 676L55 464L88 464C98 520 106 550 112 555C115 558 146 560 205 560L401 560L295 410C214 295 174 171 174 36C174-3 190-22 223-22C256-22 272-3 272 36L272 87C272 239 296 349 343 416Z" transform="translate(1778,0)"></path></g></g></g>',1)])])),s[115]||(s[115]=a("mjx-break",{size:"3"}," ",-1)),(t(),e("svg",Js,[...s[110]||(s[110]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Γ = κ = h/m ≈ 0.997 × 10^{-3}\\,\\text{cm}^2/\\text{s}"><g data-mml-node="mo" data-latex="×"><path data-c="D7" d="M630 32C630 39 628 44 623 49L422 250L623 451C628 456 630 461 630 468C630 481 620 491 607 491C600 491 595 489 590 484L389 283L188 484C183 489 178 491 171 491C158 491 148 481 148 468C148 461 150 456 155 451L356 250L155 49C150 44 148 39 148 32C148 19 158 9 171 9C178 9 183 11 188 16L389 217L590 16C595 11 600 9 607 9C620 9 630 19 630 32Z"></path></g><g data-mml-node="msup" data-latex="10^{-3}" transform="translate(1000.2,0)"><g data-mml-node="mn" data-latex="10"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z" transform="translate(500,0)"></path></g><g data-mml-node="TeXAtom" transform="translate(1033,393.1) scale(0.707)" data-latex="{-3}" data-mjx-texclass="ORD"><g data-mml-node="mo" data-latex="-"><path data-c="2212" d="M698 270L80 270C64 270 56 263 56 250C56 237 64 230 80 230L698 230C714 230 722 237 722 250C722 262 710 270 698 270Z"></path></g><g data-mml-node="mn" data-latex="3" transform="translate(778,0)"><path data-c="33" d="M303 353C369 378 431 441 431 526C431 569 410 604 369 631C333 654 292 666 246 666C201 666 162 654 127 631C88 605 68 571 68 528C68 495 90 472 122 472C154 472 176 495 176 527C176 560 157 578 119 580C145 615 186 633 242 633C302 633 332 598 332 527C332 485 324 450 309 421C282 373 245 364 183 364C171 362 165 357 165 348C165 333 172 333 192 333L235 333C310 333 348 280 348 173C348 88 317 14 241 14C176 14 128 36 99 80C134 79 160 105 160 139C160 173 135 198 101 198C62 198 42 178 42 137C42 88 64 49 108 18C147-9 193-22 244-22C301-22 350-3 393 34C436 71 457 117 457 173C457 267 383 332 303 353Z"></path></g></g></g><g data-mml-node="mspace" data-latex="\\," transform="translate(2986.9,0)"></g></g></g>',1)])])),s[116]||(s[116]=a("mjx-break",{size:"0"}," ",-1)),(t(),e("svg",Os,[...s[111]||(s[111]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="Γ = κ = h/m ≈ 0.997 × 10^{-3}\\,\\text{cm}^2/\\text{s}"><g data-mml-node="mspace" data-latex="\\,"></g><g data-mml-node="msup" data-latex="\\text{cm}^2" transform="translate(167,0)"><g data-mml-node="mtext" data-latex="\\text{cm}"><path data-c="63" d="M251 416C293 416 325 406 347 386C323 383 306 361 306 338C306 305 322 289 355 289C388 289 404 306 404 339C404 410 327 448 250 448C188 448 137 426 96 380C55 334 34 279 34 216C34 155 55 101 96 56C137 11 187-11 248-11C298-11 337 3 365 32C388 55 403 78 411 102C414 111 415 117 415 121C415 130 409 134 398 134C390 134 385 130 382 122C361 55 320 21 257 21C228 21 200 34 172 61C139 92 123 144 123 218C123 318 161 416 251 416Z"></path><path data-c="6D" d="M315 413C361 413 384 378 384 307L384 79C384 60 381 48 374 44C367 40 344 38 307 38L307 0L423 3L538 0L538 38C501 38 479 40 472 44C465 48 461 60 461 79L461 259C461 339 513 413 590 413C637 413 660 378 660 307L660 79C660 60 656 48 649 44C642 40 619 38 582 38L582 0L698 3L813 0L813 38C781 38 760 39 750 42C740 45 736 52 736 64L736 251C736 298 734 331 731 350C721 411 676 442 597 442C534 442 487 413 455 354C441 413 397 442 322 442C259 442 211 412 179 352L179 442L32 431L32 393C68 393 90 390 98 384C106 378 109 365 109 342L109 79C109 60 105 48 98 44C91 40 69 38 32 38L32 0L148 3L263 0L263 38C226 38 203 40 196 44C189 48 185 60 185 79L185 259C185 340 238 413 315 413Z" transform="translate(444,0)"></path></g><g data-mml-node="mn" transform="translate(1310,363) scale(0.707)" data-latex="2"><path data-c="32" d="M237 666C186 666 143 648 106 612C69 576 50 534 50 483C50 449 75 424 106 424C136 424 161 450 161 480C161 513 137 536 105 536C102 536 100 536 98 535C117 584 161 627 224 627C306 627 352 556 352 470C352 403 318 331 250 255L62 43C49 28 50 29 50 0L421 0L450 180L417 180C409 129 402 100 396 91C391 86 361 84 306 84L139 84L236 179C304 243 390 312 419 365C439 400 449 435 449 470C449 588 357 666 237 666Z"></path></g></g><g data-mml-node="mo" data-latex="/" transform="translate(1880.6,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mtext" data-latex="\\text{s}" transform="translate(2380.6,0)"><path data-c="73" d="M360 130C360 206 308 254 205 274C158 283 128 294 112 305C96 316 88 332 88 351C88 398 123 421 193 421C261 421 298 383 303 306C304 298 309 294 319 294C330 294 336 303 336 321L336 420C336 439 331 448 321 448C310 448 295 430 285 422C260 439 229 448 193 448C104 448 33 408 33 323C33 289 47 260 76 237C111 208 144 202 207 191C272 178 305 149 305 104C305 47 270 18 199 18C130 18 86 64 67 155C64 168 59 175 50 175C39 175 33 165 33 146L33 17C33-2 38-11 48-11C51-11 56-8 64-1C82 15 74 12 92 30C121 3 157-11 199-11C294-11 360 38 360 130Z"></path></g></g></g>',1)])]))]),s[122]||(s[122]=i(", where ",-1)),a("mjx-container",Hs,[(t(),e("svg",Ks,[...s[117]||(s[117]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"h"},[a("g",{"data-mml-node":"mi","data-latex":"h"},[a("path",{"data-c":"210E",d:"M512 138C489 59 457 19 415 19C402 19 395 28 395 47C395 62 401 85 413 116C453 223 473 296 473 335C473 406 427 445 356 445C303 445 257 423 218 380L291 679C289 688 287 694 274 694C241 694 168 685 155 684C140 682 132 675 132 660C132 650 141 645 159 645C180 645 203 646 205 632L59 43C56 32 55 25 55 21C55 0 66-11 87-11C107-11 121-1 128 18L168 182C180 231 189 268 196 293C199 300 207 314 220 334C256 388 300 415 353 415C386 415 402 393 402 350C402 309 382 236 342 130C333 107 329 89 329 74C329 26 365-11 413-11C457-11 492 14 517 65C536 105 546 132 546 145C546 154 541 159 530 159C527 159 512 150 512 138Z"})])])],-1)])]))]),s[123]||(s[123]=i(" is Planck's constant and ",-1)),a("mjx-container",Ws,[(t(),e("svg",Us,[...s[118]||(s[118]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"m"},[a("g",{"data-mml-node":"mi","data-latex":"m"},[a("path",{"data-c":"1D45A",d:"M657 442C596 442 543 412 498 353C489 412 451 442 383 442C324 442 273 416 231 363C223 407 188 442 137 442C96 442 66 409 45 344C34 312 29 293 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 66 299C84 375 107 413 134 413C152 413 161 399 161 371C161 358 156 331 145 290L88 63C84 51 79 25 79 19C79-1 90-11 111-11C131-11 145-1 152 19C153 24 160 49 171 92L192 181L222 295C233 318 250 341 272 365C301 397 337 413 380 413C413 413 429 391 429 348C429 335 424 308 414 267L387 153C380 124 364 64 356 32C355 25 354 21 354 19C354-1 365-11 387-11C398-11 406-8 413-1C428 14 429 21 435 48L494 285C497 298 511 321 535 353C565 393 605 413 654 413C687 413 703 391 703 348C703 309 683 236 642 129C633 106 629 87 629 74C629 25 666-11 714-11C759-11 793 14 818 64C838 104 848 131 848 144C848 153 843 158 832 158C825 157 818 148 813 137C791 58 759 18 716 18C703 18 696 28 696 47C696 62 702 84 714 115C755 222 775 295 775 333C775 404 728 442 657 442Z"})])])],-1)])]))]),s[124]||(s[124]=i(" the mass of a helium atom. So the above parameters can be relevant to ",-1)),a("mjx-container",Qs,[(t(),e("svg",$s,[...s[119]||(s[119]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="^4\\text{He}"><g data-mml-node="msup" data-latex="^4"><g data-mml-node="mi"></g><g data-mml-node="mn" transform="translate(33,363) scale(0.707)" data-latex="4"><path data-c="34" d="M353 677C344 677 336 672 330 663L28 199L28 163L289 163L289 81C289 63 285 51 278 46C271 41 252 39 219 39L194 39L194 0C223 2 269 3 331 3C393 3 439 2 468 0L468 39L443 39C410 39 391 41 384 46C377 51 373 63 373 81L373 163L471 163L471 202L373 202L373 660C373 670 366 677 353 677M295 553L295 202L67 202Z"></path></g></g><g data-mml-node="mtext" data-latex="\\text{He}" transform="translate(436.6,0)"><path data-c="48" d="M566 3C640 3 690 2 716 0L716 39L688 39C653 39 632 41 625 46C618 51 614 63 614 81L614 602C614 620 618 631 625 636C632 641 653 644 688 644L716 644L716 683C690 681 640 680 567 680C492 680 442 681 417 683L417 644L444 644C479 644 500 641 507 636C514 631 518 620 518 602L518 375L231 375L231 602C231 620 235 631 242 636C249 641 270 644 305 644L332 644L332 683C307 681 257 680 183 680C109 680 59 681 33 683L33 644L61 644C96 644 117 641 124 636C131 631 135 620 135 602L135 81C135 63 131 51 124 46C117 41 96 39 61 39L33 39L33 0C59 2 109 3 182 3C257 3 307 2 332 0L332 39L305 39C270 39 249 41 242 46C235 51 231 63 231 81L231 336L518 336L518 81C518 63 514 51 507 46C500 41 479 39 444 39L417 39L417 0C442 2 492 3 566 3Z"></path><path data-c="65" d="M415 251C415 366 348 448 236 448C176 448 126 425 85 378C47 334 28 281 28 220C28 157 49 104 91 58C133 12 185-11 247-11C304-11 348 9 378 48C403 81 415 105 415 121C415 131 409 136 398 136C390 136 385 131 382 120C360 54 317 21 253 21C208 21 173 42 146 85C127 116 118 163 117 227L387 227C409 227 415 229 415 251M326 349C337 316 342 284 342 255L118 255C121 321 138 366 168 389C193 409 215 419 236 419C281 419 311 396 326 349Z" transform="translate(750,0)"></path></g></g></g>',1)])]))]),s[125]||(s[125]=i(" if one interprets lengths in centimetres and the time unit is about 1000 seconds.",-1))]),s[213]||(s[213]=a("p",null,[i("There are also important "),a("strong",null,"numerical parameters"),i(" which need to be set. See the "),a("a",{href:"/VortexPasta.jl/dev/methods/Ewald#Ewald-parameters"},"Parameter selection"),i(" section for an advice on how to set them.")],-1)),a("p",null,[s[128]||(s[128]=i("Following that page, we start by setting the resolution ",-1)),a("mjx-container",Xs,[(t(),e("svg",Ys,[...s[126]||(s[126]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"M"},[a("g",{"data-mml-node":"mi","data-latex":"M"},[a("path",{"data-c":"1D440",d:"M594 16C594 5 600 0 613 0L736 3C759 4 840 0 859 0C874 0 882 8 882 24C882 34 872 39 851 39C810 39 790 43 790 52C790 55 792 62 795 75L927 602C932 623 942 636 955 641C961 643 979 644 1008 644C1033 644 1044 645 1044 668C1044 678 1034 683 1013 683L882 683C853 683 853 681 840 662L484 108L408 657C404 682 402 683 373 683L237 683C215 683 204 682 204 660C204 649 215 644 236 644C256 644 297 647 297 631C297 629 296 623 293 613L167 110C158 72 135 49 100 42C75 39 42 43 42 16C42 5 48 0 60 0C78 0 141 3 159 3C178 3 242 0 261 0C276 0 283 8 283 24C283 33 276 38 261 39C219 39 198 52 198 78C198 82 199 89 202 100L332 621L415 26C418 9 424 0 434 0C442 0 450 7 459 20L848 627L712 82C706 60 696 47 681 42C675 40 656 39 625 39C604 39 594 37 594 16Z"})])])],-1)])]))]),s[129]||(s[129]=i(" of the numerical grid used for long-range computations and the accuracy parameter ",-1)),a("mjx-container",sa,[(t(),e("svg",aa,[...s[127]||(s[127]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"β"},[a("g",{"data-mml-node":"mi","data-latex":"β"},[a("path",{"data-c":"1D6FD",d:"M427 706C298 706 212 553 182 432L30-178C30-189 35-194 44-194L49-194C56-194 61-191 62-184L126 74C148 16 191-13 255-13C317-13 374 6 425 45C496 98 532 167 532 250C532 317 509 367 463 400C520 435 556 480 569 534C572 547 574 560 574 571C574 654 507 706 427 706M306 399C311 402 329 403 358 403C365 403 371 402 378 401C368 399 359 398 350 398L332 398C321 398 312 398 306 399M148 138C148 154 150 170 154 186L213 426C240 534 312 675 426 675C483 675 511 646 511 589C511 575 509 559 504 540C490 484 464 444 425 421C403 429 381 433 359 433C315 433 270 432 270 396C270 389 273 383 278 379C287 372 310 368 349 368C374 368 399 372 422 380C449 358 463 324 463 278C463 253 459 224 451 193C428 103 360 17 256 17C188 17 148 68 148 138Z"})])])],-1)])]))]),s[130]||(s[130]=i(", and we set the other parameters based on that:",-1))]),s[214]||(s[214]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">M </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> floor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Int, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># we prefer if the FFT size is a power of 2, here M′ = σM = 32 (where σ = 1.5)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kmax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> π</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> M </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> L          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># this is the maximum resolved wavenumber (the Nyquist frequency)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">β </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3.5</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # non-dimensional accuracy parameter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">α </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kmax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">β)           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ewald splitting parameter || &quot;α&quot; can be typed by &quot;\\alpha&lt;tab&gt;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rcut </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> β </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> α              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cut-off distance for short-range computations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rcut </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> L                  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># note: the cut-off distance should be less than half the period L</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">0.37136153388108917</span></span></code></pre></div><p>Additionally, we can optionally set the parameters for numerical integration. In particular, we can set the quadrature rule used to approximate line integrals within each filament segment (see <a href="/VortexPasta.jl/dev/methods/Ewald#Numerical-integration">Numerical integration</a>):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">quadrature </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GaussLegendre</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># use 3-point Gauss–Legendre quadrature</span></span></code></pre></div><p>See <a href="/VortexPasta.jl/dev/modules/Quadratures#VortexPasta.Quadratures.GaussLegendre"><code>GaussLegendre</code></a> or the <a href="https://en.wikipedia.org/wiki/Gaussian_quadrature#Gauss%E2%80%93Legendre_quadrature" target="_blank" rel="noreferrer">Wikipedia page</a> for more details.</p><p>Finally, we put all these parameters together in a <a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.ParamsBiotSavart"><code>ParamsBiotSavart</code></a> object:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VortexPasta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BiotSavart</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">params </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ParamsBiotSavart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Γ, α, Δ, a,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Ls </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (L, L, L),  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># same domain size in all directions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Ns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (M, M, M),  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># same long-range resolution in all directions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rcut,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    quadrature,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ParamsBiotSavart{Float64} with:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> - Physical parameters:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Vortex circulation:         Γ  = 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Vortex core radius:         a  = 1.0e-8</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Vortex core parameter:      Δ  = 0.5</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Domain period:              Ls = (6.283185307179586, 6.283185307179586, 6.283185307179586)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> - Numerical parameters:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Ewald splitting parameter:  α = 1.5 (σ = 1/α√2 = 0.4714045207910316)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Quadrature rule:            GaussLegendre{3}()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Quadrature rule (alt.):     GaussLegendre{3}() (used near singularities)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Avoid explicit erf:         true</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Short-range backend:        CellListsBackend{2}(CPU(false); device = 1)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Short-range cut-off:        r_cut = 2.3333333333333335 (r_cut/L = 0.37136153388108917)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Short-range cut-off coeff.: β_shortrange = 3.5</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Local segment fraction:     1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Short-range uses SIMD:      true</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Long-range backend:         NonuniformFFTsBackend(CPU(false); device = 1, m = HalfSupport(4), σ = 1.5)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Long-range resolution:      Ns = (21, 21, 21) (kmax = 10.0)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Long-range cut-off coeff.:  β_longrange = 3.3333333333333335</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Long-range spherical truncation: false</span></span></code></pre></div><p>Note that there are a few parameters, namely the short-range and long-range backends, which haven&#39;t been discussed yet. These correspond to different ways of computing both components. We leave them here at their default values. See <a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.CellListsBackend"><code>CellListsBackend</code></a> and <a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.NonuniformFFTsBackend"><code>NonuniformFFTsBackend</code></a> for details on the defaults and their parameters.</p><h3 id="Computing-the-velocity-on-filament-nodes" tabindex="-1">Computing the velocity on filament nodes <a class="header-anchor" href="#Computing-the-velocity-on-filament-nodes" aria-label="Permalink to &quot;Computing the velocity on filament nodes {#Computing-the-velocity-on-filament-nodes}&quot;">​</a></h3><p>The last thing to do before launching computations is to create a &quot;cache&quot; where all data (arrays, …) required for computations are kept. This is in part to avoid making large allocations every time we wish to compute Biot–Savart integrals, which would be quite bad for performance. Luckily, creating a cache is very simple:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cache </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BiotSavart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init_cache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(params)</span></span></code></pre></div><p>We can now compute the velocity of all filament nodes using <a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.velocity_on_nodes"><code>velocity_on_nodes</code></a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [f]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># note: we need to pass a *vector* of filaments</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> velocity_on_nodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cache, fs)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> summary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vs) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">summary</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">summary(vs) = &quot;1-element Vector{VortexPasta.PaddedArrays.PaddedVector{5, SVector{3, Float64}, Vector{SVector{3, Float64}}}}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">summary(vs[1]) = &quot;16-element VortexPasta.PaddedArrays.PaddedVector{5, SVector{3, Float64}, Vector{SVector{3, Float64}}}&quot;</span></span></code></pre></div><p>We have done our first Biot–Savart calculation! Note that <code>vs</code> is a 1-element vector (because we only have 1 filament). Moreover, the element <code>vs[1]</code> is a vector of <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.Vec3"><code>Vec3</code></a> (3-element vectors, specifically velocity vectors in this case), in which the element <code>vs[1][i]</code> is the velocity of the filament node <code>fs[1][i]</code>.</p><p>We can now print the velocity of all nodes of the ring:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">16-element VortexPasta.PaddedArrays.PaddedVector{5, SVector{3, Float64}, Vector{SVector{3, Float64}}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [8.96445209577436e-17, 8.010125847725488e-17, 0.775263386138947]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [8.390396574949614e-16, 1.5765754822731613e-16, 0.7768440071494348]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-8.90317141074657e-16, -9.58664755973424e-16, 0.7782866995113858]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.2208527736898675e-17, 5.055478718659944e-16, 0.7768440397416712]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-2.5538972127650998e-18, 1.787956571364365e-16, 0.7752635648065435]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-5.4397231547704297e-17, 5.971348407677865e-16, 0.7768440774612606]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [9.536463547928462e-16, -9.194841631535215e-16, 0.7782867348715213]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-2.580832059607224e-16, -2.5115900130654412e-16, 0.7768439828114041]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-1.4455979227586023e-15, 1.4375238696672925e-16, 0.775263407128983]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.4262988704187707e-15, 6.390583646426783e-16, 0.7768440205308483]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-7.442245534238991e-16, -8.545760373285201e-16, 0.7782867702312061]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.6821822371191525e-16, 6.713581284361462e-16, 0.7768440531233505]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.5064499461146466e-16, 3.900560124766895e-17, 0.7752635857959113]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.262565588830191e-16, -7.616470881743957e-16, 0.7768440154037477]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-5.601254911168006e-16, 4.2157167089272703e-16, 0.7782867348710766]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.3776254003912925e-17, 8.497857427793957e-17, 0.7768440448688575]</span></span></code></pre></div>`,19)),a("p",null,[s[134]||(s[134]=i("We see that all nodes have practically zero velocity in the ",-1)),a("mjx-container",ia,[(t(),e("svg",ta,[...s[131]||(s[131]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"x"},[a("g",{"data-mml-node":"mi","data-latex":"x"},[a("path",{"data-c":"1D465",d:"M527 373C527 419 482 442 432 442C389 442 355 419 329 373C308 419 273 442 222 442C173 442 133 419 101 374C74 335 60 306 60 287C60 278 65 273 75 273C84 273 90 278 92 287C111 345 153 413 220 413C253 413 269 392 269 351C269 330 251 252 216 118C199 51 169 18 126 18C112 18 99 21 88 26C114 36 127 54 127 80C127 106 114 119 87 119C54 119 29 91 29 58C29 12 76-11 125-11C167-11 201 12 228 58C247 12 283-11 335-11C383-11 423 12 455 57C482 96 496 125 496 144C496 153 491 158 481 158C472 158 467 153 464 144C447 87 402 18 337 18C304 18 287 38 287 79C287 92 292 120 303 165L337 300C356 375 387 413 431 413C445 413 458 410 469 405C442 396 429 378 429 351C429 325 443 312 470 312C502 312 527 341 527 373Z"})])])],-1)])]))]),s[135]||(s[135]=i(" and ",-1)),a("mjx-container",ea,[(t(),e("svg",na,[...s[132]||(s[132]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"y"},[a("g",{"data-mml-node":"mi","data-latex":"y"},[a("path",{"data-c":"1D466",d:"M163 442C118 442 83 417 58 367C39 328 29 301 29 286C29 277 34 272 45 272C59 272 60 278 64 293C87 372 119 412 160 412C173 412 180 403 180 385C180 369 175 346 164 317C126 214 107 145 107 108C107 32 154-13 231-13C264-13 295-1 323 23C288-109 233-175 158-175C124-175 101-164 89-142C129-140 149-121 149-85C149-60 136-47 109-47C72-47 50-78 50-115C50-170 100-205 158-205C273-205 367-99 392-1L486 377C489 388 490 396 490 401C490 421 479 431 458 431C442 431 429 423 420 408C414 387 409 369 406 354L342 97C332 61 279 16 234 16C196 16 177 41 177 92C177 134 194 198 227 284C240 319 247 343 247 357C247 406 212 442 163 442Z"})])])],-1)])]))]),s[136]||(s[136]=i(" directions, while they all have approximately the same velocity in the ",-1)),a("mjx-container",la,[(t(),e("svg",ha,[...s[133]||(s[133]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"z"},[a("g",{"data-mml-node":"mi","data-latex":"z"},[a("path",{"data-c":"1D467",d:"M162 92L145 90C193 137 230 171 255 194L351 283C374 304 398 330 421 359C452 397 467 420 467 428C467 437 462 442 452 442C445 442 439 438 434 429C409 388 386 368 364 368C342 368 326 386 317 398C293 427 269 442 246 442C220 442 193 430 165 404C137 378 123 352 123 326C123 316 128 311 139 311C146 311 152 316 156 325C167 354 194 368 235 368C249 368 269 363 296 354C320 345 343 340 364 339C308 284 265 244 234 217L145 134C130 119 111 99 90 74C59 35 43 12 43 3C43-6 48-11 59-11C65-11 71-6 78 4C103 43 130 63 158 63C174 63 192 51 212 26C232 1 255-11 278-11C312-11 346 7 382 42C418 77 436 111 436 144C436 153 431 158 420 158C413 158 407 153 402 143C387 100 344 63 288 63C264 63 186 92 162 92Z"})])])],-1)])]))]),s[137]||(s[137]=i(" direction. Good news, this is exactly what we expect for a vortex ring!",-1))]),s[215]||(s[215]=n(`<p>We can compute the mean velocity and quantify the velocity variation along the filament:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Statistics</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mean, std</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v_mean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v_std </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v_std_normalised </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_std </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> norm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v_mean)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># normalised standard deviation</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_mean v_std v_std_normalised</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">v_mean = [-3.4728425302261306e-18, -1.4160571437357978e-17, 0.7768095702778844]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">v_std = [7.107950308989902e-16, 5.701698252269098e-16, 0.0011045079633929466]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">v_std_normalised = [9.150183752817576e-16, 7.339891873666614e-16, 0.0014218516424789104]</span></span></code></pre></div><p>Note that there are some (very small) fluctuations of the velocity about the mean. As discussed and verified further below, this is explained by periodicity effects, as the vortex ring is affected by its periodic images. Furthermore, different points along the ring are at different distances from the images, and therefore the velocity induced by the images varies slightly as we move along the vortex ring. In other words, periodicity introduces a slight anisotropy on the behaviour of the vortex ring.</p><p>To visualise things, it is easy to plot the filament with the node velocities:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlims!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax, fs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], vs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    refinement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    arrows3d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (lengthscale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+k+`" alt=""></p><h3 id="Comparison-with-analytical-expression" tabindex="-1">Comparison with analytical expression <a class="header-anchor" href="#Comparison-with-analytical-expression" aria-label="Permalink to &quot;Comparison with analytical expression {#Comparison-with-analytical-expression}&quot;">​</a></h3><p>We can finally compare the filament velocity with the analytical vortex ring velocity according to the expression at the <a href="/VortexPasta.jl/dev/tutorials/01-vortex_ring#Computing-the-vortex-ring-velocity">start of this section</a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v_ring </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Γ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4π</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> R) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">R </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Δ)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_mean[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">relative_difference </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (v_ring </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vz) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_ring</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_ring vz relative_difference</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">v_ring = 0.8233590310692667</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">vz = 0.7768095702778844</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">relative_difference = 0.05653604203615781</span></span></code></pre></div><p>We can see that we&#39;re quite close, and that the relative difference between the two is of the order of 5%. This is already nice, but note that most of the difference may be explained by <strong>periodicity effects</strong>, as shown in more detail in the <a href="/VortexPasta.jl/dev/tutorials/01-vortex_ring#ring-disabling-periodicity">next section</a>. Indeed, the vortex ring is not alone, but is also affected by its periodic images.</p><p>We can visualise this by plotting the ring and its nearest 26 periodic images (actually there&#39;s an infinity of them!):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidespines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidexdecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax; label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hideydecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax; label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidezdecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax; label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fimage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, f; refinement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, markersize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :OrangeRed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> I </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">∈</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CartesianIndices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> widths </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (L, L, L)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offset </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Vec3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(I) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> widths)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> box </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Rect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, widths</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    wireframe!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, box; color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:white</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># plot cube</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    iszero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(I) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> continue</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # don&#39;t replot the &quot;original&quot; filament</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    fimage .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(offset)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    update_coefficients!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fimage)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># updates interpolation coefficients</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, fimage; refinement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, markersize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :LightBlue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+d+'" alt=""></p>',15)),a("p",null,[s[140]||(s[140]=i("One can show that the images have the tendency to slow the vortex down, which is consistent with our results (since ",-1)),s[141]||(s[141]=a("code",null,"vz < v_ring",-1)),s[142]||(s[142]=i("). The effect here is relatively important because the ring diameter ",-1)),a("mjx-container",pa,[(t(),e("svg",ra,[...s[138]||(s[138]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="2R"><g data-mml-node="mn" data-latex="2"><path data-c="32" d="M237 666C186 666 143 648 106 612C69 576 50 534 50 483C50 449 75 424 106 424C136 424 161 450 161 480C161 513 137 536 105 536C102 536 100 536 98 535C117 584 161 627 224 627C306 627 352 556 352 470C352 403 318 331 250 255L62 43C49 28 50 29 50 0L421 0L450 180L417 180C409 129 402 100 396 91C391 86 361 84 306 84L139 84L236 179C304 243 390 312 419 365C439 400 449 435 449 470C449 588 357 666 237 666Z"></path></g><g data-mml-node="mi" data-latex="R" transform="translate(500,0)"><path data-c="1D445" d="M739 531C739 582 713 621 662 649C621 672 572 683 517 683L235 683C212 683 202 682 202 659C202 652 205 647 211 646C221 645 229 644 234 644C264 643 281 641 286 640C291 639 294 636 294 631C294 629 293 623 290 613L158 82C153 60 143 46 128 41C121 39 103 38 72 38C50 38 41 37 41 15C41 4 47-1 59 0L183 3L309 0C325-1 333 8 333 23C333 33 322 38 301 38C261 38 241 43 241 52C241 52 242 54 244 68L308 327L423 327C492 327 527 298 527 241C527 232 522 210 513 174C502 132 497 104 497 89C497 13 556-22 632-22C660-22 687-9 714 16C741 41 755 68 755 96C755 106 750 111 739 111C732 111 726 106 723 95C712 64 698 41 682 28C666 15 651 8 636 8C613 8 601 27 601 64C601 88 604 125 611 176C614 197 615 212 615 223C615 276 587 315 531 339C625 362 739 429 739 531M609 616C629 603 639 581 639 550C639 530 635 507 626 480C599 398 531 357 422 357L316 357L379 610C384 631 392 642 403 643C408 644 428 644 463 644C528 644 566 642 609 616Z"></path></g></g></g>',1)])]))]),s[143]||(s[143]=i(" is comparable to the domain period ",-1)),a("mjx-container",ka,[(t(),e("svg",da,[...s[139]||(s[139]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"L"},[a("g",{"data-mml-node":"mi","data-latex":"L"},[a("path",{"data-c":"1D43F",d:"M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"})])])],-1)])]))]),s[144]||(s[144]=i(":",-1))]),s[216]||(s[216]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">R</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">0.6366197723675814</span></span></code></pre></div><p>We can expect the periodicity effect on the ring to be much weaker for smaller rings.</p><h3 id="ring-disabling-periodicity" tabindex="-1">Side note: disabling periodicity <a class="header-anchor" href="#ring-disabling-periodicity" aria-label="Permalink to &quot;Side note: disabling periodicity {#ring-disabling-periodicity}&quot;">​</a></h3><p>It is actually possible to disable the periodic boundary conditions, effectively leading to an open domain with a unique vortex ring.</p><p>In VortexPasta.jl, disabling periodicity amounts to disabling the long-range part of Ewald summation, so that <strong>all</strong> scales are computed by the &quot;short&quot;-range component. The cut-off distance is therefore infinity, and it makes no sense to use cell lists to accelerate the computations. Other methods exist (and are now standard) to accelerate this kind of computation, but these are not implemented here. So, while it is possible to disable periodicity, this should only be used for testing or for small calculations.</p><p>To disable periodicity, one should pass <code>α = Zero()</code> and <code>Ls = Infinity()</code> to <a href="/VortexPasta.jl/dev/modules/BiotSavart#VortexPasta.BiotSavart.ParamsBiotSavart"><code>ParamsBiotSavart</code></a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">params_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ParamsBiotSavart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Γ, α </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), Δ, a,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Ls </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Infinity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    quadrature,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ParamsBiotSavart{Float64} with:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> - Physical parameters:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Vortex circulation:         Γ  = 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Vortex core radius:         a  = 1.0e-8</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Vortex core parameter:      Δ  = 0.5</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Domain period:              Ls = (Infinity(), Infinity(), Infinity())</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> - Numerical parameters:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Ewald splitting parameter:  α = Zero() (σ = 1/α√2 = Infinity())</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Quadrature rule:            GaussLegendre{3}()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Quadrature rule (alt.):     GaussLegendre{3}() (used near singularities)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Avoid explicit erf:         true</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Short-range backend:        NaiveShortRangeBackend()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Short-range cut-off:        r_cut = Infinity() (r_cut/L = Infinity())</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Short-range cut-off coeff.: β_shortrange = Infinity()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Local segment fraction:     1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Short-range uses SIMD:      true</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Long-range backend:         VortexPasta.BiotSavart.NullLongRangeBackend()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Long-range resolution:      Ns = (0, 0, 0) (kmax = 0.0)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Long-range cut-off coeff.:  β_longrange = Infinity()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">   * Long-range spherical truncation: false</span></span></code></pre></div>`,9)),a("p",null,[s[147]||(s[147]=i("Here ",-1)),s[148]||(s[148]=a("a",{href:"/VortexPasta.jl/dev/modules/Constants#VortexPasta.Constants.Zero"},[a("code",null,"Zero")],-1)),s[149]||(s[149]=i(" and ",-1)),s[150]||(s[150]=a("a",{href:"/VortexPasta.jl/dev/modules/Constants#VortexPasta.Constants.Infinity"},[a("code",null,"Infinity")],-1)),s[151]||(s[151]=i(" are custom types that, as one may expect, represent ",-1)),a("mjx-container",oa,[(t(),e("svg",Ca,[...s[145]||(s[145]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"0"},[a("g",{"data-mml-node":"mn","data-latex":"0"},[a("path",{"data-c":"30",d:"M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z"})])])],-1)])]))]),s[152]||(s[152]=i(" and ",-1)),a("mjx-container",ga,[(t(),e("svg",ma,[...s[146]||(s[146]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="+∞"><g data-mml-node="mo" data-latex="+"><path data-c="2B" d="M698 274L413 274L413 559C413 575 405 583 389 583C373 583 365 575 365 559L365 274L80 274C64 274 56 266 56 250C56 234 64 226 80 226L365 226L365-59C365-75 373-83 389-83C405-83 413-75 413-59L413 226L698 226C714 226 722 234 722 250C722 263 711 274 698 274Z"></path></g><g data-mml-node="mo" data-latex="∞" transform="translate(778,0)"><path data-c="221E" d="M749-11C807-11 855 13 892 60C926 104 943 156 943 216C943 275 926 327 893 371C856 418 809 442 752 442C684 442 625 416 576 364C547 332 524 303 507 278C464 329 435 361 421 373C367 419 310 442 250 442C192 442 144 418 107 371C73 327 56 275 56 215C56 156 73 104 106 60C143 13 190-11 247-11C315-11 374 15 423 67C452 99 475 128 492 153C535 102 564 70 578 58C632 12 689-11 749-11M913 216C913 188 911 168 908 156C903 137 890 117 869 94C840 61 805 44 765 44C722 44 680 67 637 113C592 168 559 209 538 237C601 348 675 403 759 403C852 403 913 314 913 216M86 215C86 260 100 299 128 334C156 369 191 387 234 387C277 387 319 364 362 318C407 263 440 222 461 194C398 83 324 28 240 28C147 28 86 117 86 215Z"></path></g></g></g>',1)])]))]),s[153]||(s[153]=i(".",-1))]),s[217]||(s[217]=n(`<p>We can now compute the vortex ring velocity in the absence of periodic effects:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cache_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BiotSavart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init_cache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(params_inf, fs)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vs_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> velocity_on_nodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cache_inf, fs)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v_mean_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vs_inf[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v_std_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(vs_inf[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v_std_normalised_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_std_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> norm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v_mean_inf)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_mean_inf v_std_inf v_std_normalised_inf</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">v_mean_inf = [-2.306367252617012e-18, -1.0682373101594364e-17, 0.823255945580826]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">v_std_inf = [7.108548907868636e-16, 5.710968952197168e-16, 6.7306746275938655e-15]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">v_std_normalised_inf = [8.634676671364203e-16, 6.937051572907801e-16, 8.175676912779802e-15]</span></span></code></pre></div>`,3)),a("p",null,[s[155]||(s[155]=i("The velocity fluctuations along the filament are now practically zero! This should be contrasted with the standard deviation of about ",-1)),a("mjx-container",Ea,[(t(),e("svg",ca,[...s[154]||(s[154]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="0.001"><g data-mml-node="mn" data-latex="0.001"><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z"></path><path data-c="2E" d="M192 53C192 82 168 106 139 106C110 106 86 82 86 53C86 24 110 0 139 0C168 0 192 24 192 53Z" transform="translate(500,0)"></path><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z" transform="translate(778,0)"></path><path data-c="30" d="M249-22C390-22 460 92 460 320C460 473 428 575 365 625C330 652 291 666 250 666C109 666 39 551 39 320C39 136 88-22 249-22M361 524C368 489 371 425 371 332C371 240 367 172 360 128C347 48 310 8 249 8C226 8 203 17 182 34C155 57 139 104 132 176C129 201 128 253 128 332C128 419 131 480 136 513C145 568 163 603 191 618C213 630 232 636 249 636C314 636 350 583 361 524Z" transform="translate(1278,0)"></path><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z" transform="translate(1778,0)"></path></g></g></g>',1)])]))]),s[156]||(s[156]=i(' we obtained in the periodic case. This is consistent with what was explained on the anisotropy introduced by periodicity, in the sense that not all points on the filament "feel" the effect of the periodic images in the same way.',-1))]),s[218]||(s[218]=n(`<p>Moreover, the mean velocity is even closer to the analytical velocity:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vz_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_mean_inf[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">relative_difference_inf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (v_ring </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vz_inf) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v_ring</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">0.00012520113893297634</span></span></code></pre></div><p>The relative difference is reduced from 5% to about 0.01%! Once again, this clearly shows that periodic images have some (very minor) impact on the effective vortex ring velocity.</p>`,4)),a("p",null,[s[158]||(s[158]=i("Note that we could further reduce the difference with the analytical result by increasing the filament resolution ",-1)),a("mjx-container",ya,[(t(),e("svg",ua,[...s[157]||(s[157]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"N"},[a("g",{"data-mml-node":"mi","data-latex":"N"},[a("path",{"data-c":"1D441",d:"M864 683C845 683 783 680 764 680C745 680 682 683 663 683C648 683 641 675 641 659C641 650 648 645 663 644C705 644 726 631 726 605C726 599 725 592 724 585L616 157L401 662C393 681 391 683 366 683L233 683C209 683 200 681 200 659C200 649 211 644 232 644C274 644 295 643 296 640L163 110C154 71 131 49 95 42C69 39 39 43 39 15C39 5 45 0 56 0C74 0 136 3 155 3C174 3 238 0 257 0C272 0 279 8 279 24C279 33 271 38 255 39C214 40 194 53 194 78C194 83 195 90 197 100L326 611L576 21C582 7 590 0 599 0C608 0 614 8 618 24L757 574C770 625 798 643 860 644C874 645 881 653 881 669C878 678 877 683 864 683Z"})])])],-1)])]))]),s[159]||(s[159]=i(". The results also depend on the chosen discretisation scheme: ",-1)),s[160]||(s[160]=a("a",{href:"/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.QuinticSplineMethod"},[a("code",null,"QuinticSplineMethod")],-1)),s[161]||(s[161]=i(" allows to accurately describe the circular vortex ring geometry (and ",-1)),s[162]||(s[162]=a("a",{href:"/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.FourierMethod"},[a("code",null,"FourierMethod")],-1)),s[163]||(s[163]=i(" even more so), while methods like ",-1)),s[164]||(s[164]=a("a",{href:"/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.CubicSplineMethod"},[a("code",null,"CubicSplineMethod")],-1)),s[165]||(s[165]=i(" and ",-1)),s[166]||(s[166]=a("a",{href:"/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.FiniteDiffMethod"},[a("code",null,"FiniteDiffMethod")],-1)),s[167]||(s[167]=i(" are less accurate.",-1))]),s[219]||(s[219]=n(`<h2 id="Making-the-ring-move" tabindex="-1">Making the ring move <a class="header-anchor" href="#Making-the-ring-move" aria-label="Permalink to &quot;Making the ring move {#Making-the-ring-move}&quot;">​</a></h2><p>Up to now we have shown how to compute the velocity self-induced by a vortex filament on its discretisation points. We now want to use this velocity to advect the vortex filament over time. In the case of a vortex ring, its displacement is very simple and boring (the vortex ring moves with constant velocity), but this case is still useful for instance for testing the stability of timestepping schemes.</p><p>For running temporal simulations, we want to use the <a href="/VortexPasta.jl/dev/modules/Timestepping#VortexPasta.Timestepping"><code>VortexPasta.Timestepping</code></a> submodule. The syntax is somewhat inspired from the popular <a href="https://docs.sciml.ai/DiffEqDocs/stable/" target="_blank" rel="noreferrer">DifferentialEquations.jl</a> ecosystem.</p><h3 id="A-basic-simulation" tabindex="-1">A basic simulation <a class="header-anchor" href="#A-basic-simulation" aria-label="Permalink to &quot;A basic simulation {#A-basic-simulation}&quot;">​</a></h3><p>We start by defining a <a href="/VortexPasta.jl/dev/modules/Timestepping#VortexPasta.Timestepping.VortexFilamentProblem"><code>VortexFilamentProblem</code></a>, which takes (1) an initial condition (in our case, the initial vortex ring we already defined); (2) the time span of the simulation; and (3) parameters for Biot–Savart computations (which we already defined as well):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VortexPasta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Timestepping</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> L </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vz       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># time it should take for the ring to cross half the periodic box</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tspan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, T)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># time span; this basically determines when to stop the simulation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> VortexFilamentProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fs, tspan, params)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">VortexFilamentProblem with fields:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ p: ParamsBiotSavart{Float64}(Γ = 1.0, a = 1.0e-8, Δ = 0.5, α = 1.5, …)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ tspan: (0.0, 4.044224960392759) -- simulation timespan</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> └─ fs: 1-element VectorOfVectors -- vortex filaments at t = 0.0</span></span></code></pre></div><p>The second step is to &quot;initialise&quot; the problem using <a href="/VortexPasta.jl/dev/modules/Timestepping#CommonSolve.init"><code>init</code></a>. This means choosing a <a href="/VortexPasta.jl/dev/modules/Timestepping#Temporal-schemes">temporal scheme</a>, an initial timestep, as well as optional parameters related for instance to <a href="/VortexPasta.jl/dev/modules/Timestepping#Adaptivity">temporal adaptivity</a>, <a href="/VortexPasta.jl/dev/modules/Filaments#Refinement">spatial refinement</a> of the filaments, or <a href="/VortexPasta.jl/dev/modules/Reconnections#Reconnections">vortex reconnections</a>.</p><p>For now, we use the explicit <a href="/VortexPasta.jl/dev/modules/Timestepping#VortexPasta.Timestepping.RK4"><code>RK4</code></a> timestepping scheme, set a constant timestep <code>dt</code>, and leave the defaults for everything else:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum_knot_increment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fs)       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># this is an estimate for the minimum distance between discretisation points</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> l_min</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Γ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(l_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a))  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># we set the timestep to be proportional to some characteristic &quot;fast&quot; timescale</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RK4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); dt)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">VortexFilamentSolver with fields:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ prob: VortexFilamentProblem with fields:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> │  ├─ p: ParamsBiotSavart{Float64}(Γ = 1.0, a = 1.0e-8, Δ = 0.5, α = 1.5, …)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> │  ├─ tspan: (0.0, 4.044224960392759) -- simulation timespan</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> │  └─ fs: 1-element VectorOfVectors -- vortex filaments at t = 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ fs: 1-element VectorOfVectors -- vortex filaments</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ vL: 1-element VectorOfVectors -- vortex line velocity (vs + mutual friction + forcing)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ vs: 1-element VectorOfVectors -- self-induced superfluid velocity</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ ψs: 1-element VectorOfVectors -- streamfunction vector</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ time: TimeInfo(nstep = 0, t = 0.0, dt = 0.10052952958498958, dt_prev = 0.10052952958498958, nrejected = 0)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ stats: VortexPasta.Timestepping.SimulationStats{Float64}(...)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ dtmin: 0.0</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ refinement: NoRefinement()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ adaptivity: NoAdaptivity()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ reconnect: NoReconnections()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ fast_term: LocalTerm()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ LIA: false</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ fold_periodic: true</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ cache_bs: BiotSavartCache</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ cache_timestepper: TemporalSchemeCache(RK4())</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ step_diagnostics: 1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ step_refinement: 1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ├─ step_reconnect: 1</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> └─ to: TimerOutputs.TimerOutput</span></span></code></pre></div>`,11)),a("p",null,[s[172]||(s[172]=i("Note that the maximum possible timestep to avoid numerical instability is mainly limited by the filament resolution ",-1)),a("mjx-container",Fa,[(t(),e("svg",va,[...s[168]||(s[168]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ℓ_{\\text{min}}"><g data-mml-node="msub" data-latex="ℓ_{\\text{min}}"><g data-mml-node="mo" data-latex="ℓ"><path data-c="2113" d="M317 392C371 473 398 551 398 624C398 678 377 705 336 705C297 705 260 676 223 617C200 580 182 547 169 517C117 398 91 284 91 176L17 104C13 99 11 95 11 92C11 81 16 75 27 75C31 75 53 95 94 135C108 37 146-12 207-12C244-12 289 11 341 58C357 72 365 82 365 88C365 99 360 104 349 104C346 104 341 101 334 94C282 43 240 18 209 18C172 18 153 59 153 142C153 202 152 195 178 221C227 270 274 327 317 392M337 675C357 675 367 659 367 628C367 521 300 396 165 252C179 331 229 515 262 585C291 645 316 675 337 675Z"></path></g><g data-mml-node="TeXAtom" transform="translate(450,-150) scale(0.707)" data-latex="{\\text{min}}" data-mjx-texclass="ORD"><g data-mml-node="mtext" data-latex="\\text{min}"><path data-c="6D" d="M315 413C361 413 384 378 384 307L384 79C384 60 381 48 374 44C367 40 344 38 307 38L307 0L423 3L538 0L538 38C501 38 479 40 472 44C465 48 461 60 461 79L461 259C461 339 513 413 590 413C637 413 660 378 660 307L660 79C660 60 656 48 649 44C642 40 619 38 582 38L582 0L698 3L813 0L813 38C781 38 760 39 750 42C740 45 736 52 736 64L736 251C736 298 734 331 731 350C721 411 676 442 597 442C534 442 487 413 455 354C441 413 397 442 322 442C259 442 211 412 179 352L179 442L32 431L32 393C68 393 90 390 98 384C106 378 109 365 109 342L109 79C109 60 105 48 98 44C91 40 69 38 32 38L32 0L148 3L263 0L263 38C226 38 203 40 196 44C189 48 185 60 185 79L185 259C185 340 238 413 315 413Z"></path><path data-c="69" d="M194 601C194 631 169 657 139 657C109 657 83 631 83 601C83 571 108 544 138 544C169 544 194 570 194 601M143 3L247 0L247 39C214 39 194 41 188 45C182 49 180 60 180 78L180 445L37 433L37 395C70 395 91 392 98 387C105 382 108 368 108 345L108 79C108 60 105 48 98 44C91 40 69 39 33 39L33 0Z" transform="translate(833,0)"></path><path data-c="6E" d="M314 413C359 413 382 378 382 307L382 79C382 60 379 48 372 44C365 40 343 38 306 38L306 0L421 3L535 0L535 38C503 38 482 39 472 42C462 45 458 52 458 64L458 251C458 298 457 331 454 350C444 411 399 442 320 442C257 442 210 412 179 352L179 442L32 431L32 393C68 393 90 390 98 384C106 378 109 365 109 342L109 79C109 60 105 48 98 44C91 40 69 38 32 38L32 0L147 3L261 0L261 38C224 38 203 40 196 44C189 48 185 60 185 79L185 259C185 340 236 413 314 413Z" transform="translate(1111,0)"></path></g></g></g></g></g>',1)])]))]),s[173]||(s[173]=i(". More precisely, the limit is the frequency of spurious oscillations associated to that length scale. These correspond to Kelvin waves, whose frequency roughly scales as ",-1)),a("mjx-container",xa,[(t(),e("svg",fa,[...s[169]||(s[169]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(ℓ) ∼ Γ \\ln (ℓ / a) / ℓ^2"><g data-mml-node="mi" data-latex="ω"><path data-c="1D714" d="M505 391C505 380 509 370 517 363C542 342 554 314 554 280C554 267 553 255 550 244C530 168 477 68 396 68C344 68 313 96 303 152C316 179 326 207 333 238C336 249 337 258 337 264C337 284 329 294 314 294C276 294 266 198 264 156C227 97 184 68 133 68C78 68 51 104 51 175C51 195 54 216 59 238C70 282 99 337 146 402C150 407 152 412 152 417C152 430 145 437 130 437C123 437 116 434 110 427C61 360 13 242 13 133C13 37 49-11 121-11C178-11 227 22 270 87C284 22 322-11 383-11C416-11 447 2 475 28C522 72 557 142 581 238C596 299 604 342 604 369C604 398 597 419 583 432C576 439 567 442 558 442C532 442 505 417 505 391Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(622,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mo" data-latex="ℓ" transform="translate(1011,0)"><path data-c="2113" d="M317 392C371 473 398 551 398 624C398 678 377 705 336 705C297 705 260 676 223 617C200 580 182 547 169 517C117 398 91 284 91 176L17 104C13 99 11 95 11 92C11 81 16 75 27 75C31 75 53 95 94 135C108 37 146-12 207-12C244-12 289 11 341 58C357 72 365 82 365 88C365 99 360 104 349 104C346 104 341 101 334 94C282 43 240 18 209 18C172 18 153 59 153 142C153 202 152 195 178 221C227 270 274 327 317 392M337 675C357 675 367 659 367 628C367 521 300 396 165 252C179 331 229 515 262 585C291 645 316 675 337 675Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(1428,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])])),s[171]||(s[171]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",La,[...s[170]||(s[170]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="ω(ℓ) ∼ Γ \\ln (ℓ / a) / ℓ^2"><g data-mml-node="mo" data-latex="∼"><path data-c="223C" d="M597 143C674 166 714 235 717 350C717 361 712 366 701 366C691 366 686 361 685 351C684 308 675 275 657 251C637 224 592 194 548 194C518 194 486 207 453 233C434 248 418 261 406 271C335 333 274 364 222 364C207 364 192 362 177 357C92 332 59 262 56 150C56 139 61 134 72 134C82 134 87 139 88 149C89 192 98 225 116 249C135 275 182 306 225 306C255 306 287 293 320 267C339 252 355 239 367 229C438 167 499 136 551 136C566 136 582 138 597 143Z"></path></g><g data-mml-node="mi" data-latex="Γ" transform="translate(1050.8,0)"><path data-c="393" d="M274 641L376 641C443 641 487 626 509 596C538 555 541 520 550 450L583 450L554 680L33 680L33 641L61 641C96 641 117 639 124 634C131 629 135 617 135 599L135 81C135 63 131 51 124 46C117 41 96 39 61 39L33 39L33 0C59 2 110 3 187 3C274 3 330 2 356 0L356 39L320 39C267 39 238 44 233 55C231 60 230 69 230 82L230 606C230 641 236 641 274 641Z"></path></g><g data-mml-node="mi" data-latex="\\ln" transform="translate(1842.4,0)"><path data-c="6C" d="M144 3L255 0L255 39C219 39 197 40 190 44C183 48 180 60 180 79L180 694L33 683L33 645C68 645 90 642 97 636C104 630 108 616 108 593L108 79C108 60 105 48 98 44C91 40 69 39 33 39L33 0Z"></path><path data-c="6E" d="M314 413C359 413 382 378 382 307L382 79C382 60 379 48 372 44C365 40 343 38 306 38L306 0L421 3L535 0L535 38C503 38 482 39 472 42C462 45 458 52 458 64L458 251C458 298 457 331 454 350C444 411 399 442 320 442C257 442 210 412 179 352L179 442L32 431L32 393C68 393 90 390 98 384C106 378 109 365 109 342L109 79C109 60 105 48 98 44C91 40 69 38 32 38L32 0L147 3L261 0L261 38C224 38 203 40 196 44C189 48 185 60 185 79L185 259C185 340 236 413 314 413Z" transform="translate(278,0)"></path></g><g data-mml-node="mo" transform="translate(2676.4,0)"><path data-c="2061" d=""></path></g><g data-mml-node="mo" data-latex="(" transform="translate(2676.4,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mo" data-latex="ℓ" transform="translate(3065.4,0)"><path data-c="2113" d="M317 392C371 473 398 551 398 624C398 678 377 705 336 705C297 705 260 676 223 617C200 580 182 547 169 517C117 398 91 284 91 176L17 104C13 99 11 95 11 92C11 81 16 75 27 75C31 75 53 95 94 135C108 37 146-12 207-12C244-12 289 11 341 58C357 72 365 82 365 88C365 99 360 104 349 104C346 104 341 101 334 94C282 43 240 18 209 18C172 18 153 59 153 142C153 202 152 195 178 221C227 270 274 327 317 392M337 675C357 675 367 659 367 628C367 521 300 396 165 252C179 331 229 515 262 585C291 645 316 675 337 675Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(3482.4,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mi" data-latex="a" transform="translate(3982.4,0)"><path data-c="1D44E" d="M498 144C498 153 493 158 482 158C474 158 468 151 465 137C445 58 421 18 394 18C377 18 368 32 368 60C368 73 372 97 381 132L438 357C443 376 445 387 445 392C445 412 434 422 412 422C391 422 377 410 370 387C349 424 319 442 281 442C216 442 159 409 109 343C63 281 40 217 40 150C40 63 91-11 175-11C218-11 260 12 300 58C311 20 345-11 392-11C461-11 482 70 498 144M341 374C350 353 355 339 355 330C355 326 354 321 353 314L304 122C301 111 294 99 285 87C248 41 212 18 177 18C138 18 118 48 118 107C118 131 124 167 136 215C157 300 187 357 224 388C244 405 263 413 282 413C309 413 329 400 341 374Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(4511.4,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(4900.4,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="msup" data-latex="ℓ^2" transform="translate(5400.4,0)"><g data-mml-node="mo" data-latex="ℓ"><path data-c="2113" d="M317 392C371 473 398 551 398 624C398 678 377 705 336 705C297 705 260 676 223 617C200 580 182 547 169 517C117 398 91 284 91 176L17 104C13 99 11 95 11 92C11 81 16 75 27 75C31 75 53 95 94 135C108 37 146-12 207-12C244-12 289 11 341 58C357 72 365 82 365 88C365 99 360 104 349 104C346 104 341 101 334 94C282 43 240 18 209 18C172 18 153 59 153 142C153 202 152 195 178 221C227 270 274 327 317 392M337 675C357 675 367 659 367 628C367 521 300 396 165 252C179 331 229 515 262 585C291 645 316 675 337 675Z"></path></g><g data-mml-node="mn" transform="translate(450,363) scale(0.707)" data-latex="2"><path data-c="32" d="M237 666C186 666 143 648 106 612C69 576 50 534 50 483C50 449 75 424 106 424C136 424 161 450 161 480C161 513 137 536 105 536C102 536 100 536 98 535C117 584 161 627 224 627C306 627 352 556 352 470C352 403 318 331 250 255L62 43C49 28 50 29 50 0L421 0L450 180L417 180C409 129 402 100 396 91C391 86 361 84 306 84L139 84L236 179C304 243 390 312 419 365C439 400 449 435 449 470C449 588 357 666 237 666Z"></path></g></g></g></g>',1)])]))]),s[174]||(s[174]=i(". See the ",-1)),s[175]||(s[175]=a("a",{href:"/VortexPasta.jl/dev/tutorials/02-kelvin_waves#tutorial-kelvin-waves-timestep"},"Kelvin wave tutorial",-1)),s[176]||(s[176]=i(" for more details.",-1))]),s[220]||(s[220]=a("div",{class:"tip custom-block"},[a("p",{class:"custom-block-title"},"Adaptive timestepping"),a("p",null,[i("One can use adaptive timestepping with the "),a("a",{href:"/VortexPasta.jl/dev/modules/Timestepping#VortexPasta.Timestepping.AdaptBasedOnSegmentLength"},[a("code",null,"AdaptBasedOnSegmentLength")]),i(" criterion, which automatically updates the timestep based on the current minimal distance between filament nodes.")])],-1)),a("p",null,[s[182]||(s[182]=i("We now call ",-1)),s[183]||(s[183]=a("a",{href:"/VortexPasta.jl/dev/modules/Timestepping#CommonSolve.solve!"},[a("code",null,"solve!")],-1)),s[184]||(s[184]=i(" to run the simulation until ",-1)),a("mjx-container",wa,[(t(),e("svg",ba,[...s[177]||(s[177]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"t = T = L / 2 v_{\\text{ring}}"},[a("g",{"data-mml-node":"mi","data-latex":"t"},[a("path",{"data-c":"1D461",d:"M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"})])])],-1)])])),s[180]||(s[180]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",_a,[...s[178]||(s[178]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="t = T = L / 2 v_{\\text{ring}}"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="T" transform="translate(1055.8,0)"><path data-c="1D447" d="M344 631C344 628 343 621 340 611L208 83C204 68 200 59 197 55C188 44 154 39 94 39C63 39 49 42 49 16C49 5 56 0 69 0C120 0 192 4 235 3L317 2C331 2 386 0 403 0C420 0 428 8 428 24C428 34 416 39 391 39C339 39 309 41 300 46C297 48 295 52 295 58L430 603C433 617 436 626 439 629C443 635 467 638 511 638C566 638 604 634 623 625C642 616 652 595 652 561C652 543 649 517 644 483C642 475 641 469 641 464C641 453 646 447 657 447C666 447 672 456 675 473L702 645C703 650 704 656 704 662C704 672 694 677 673 677L125 677C99 677 97 674 89 655L30 481C27 472 25 466 24 462C24 452 29 447 40 447C48 447 55 455 60 470C85 543 110 588 133 607C159 628 209 638 282 638L321 638C332 638 344 639 344 631Z"></path></g></g></g>',1)])])),s[181]||(s[181]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",Da,[...s[179]||(s[179]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="t = T = L / 2 v_{\\text{ring}}"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="L" transform="translate(1055.8,0)"><path data-c="1D43F" d="M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(1736.8,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mn" data-latex="2" transform="translate(2236.8,0)"><path data-c="32" d="M237 666C186 666 143 648 106 612C69 576 50 534 50 483C50 449 75 424 106 424C136 424 161 450 161 480C161 513 137 536 105 536C102 536 100 536 98 535C117 584 161 627 224 627C306 627 352 556 352 470C352 403 318 331 250 255L62 43C49 28 50 29 50 0L421 0L450 180L417 180C409 129 402 100 396 91C391 86 361 84 306 84L139 84L236 179C304 243 390 312 419 365C439 400 449 435 449 470C449 588 357 666 237 666Z"></path></g><g data-mml-node="msub" data-latex="v_{\\text{ring}}" transform="translate(2736.8,0)"><g data-mml-node="mi" data-latex="v"><path data-c="1D463" d="M369 391C369 383 378 370 394 350C410 330 418 307 418 281C418 252 404 203 375 134C354 86 306 18 247 18C201 18 178 45 178 100C178 139 197 208 235 307C243 328 247 345 247 357C247 407 213 442 163 442C119 442 84 417 59 367C39 326 29 300 29 287C29 278 34 273 45 273C58 273 60 279 64 293C87 373 119 413 160 413C173 413 180 404 180 385C180 369 175 347 164 318C127 219 108 152 108 115C108 64 125 29 159 10C186-4 214-11 243-11C332-11 394 85 420 162C452 256 468 325 468 369C468 418 452 442 421 442C396 442 369 416 369 391Z"></path></g><g data-mml-node="TeXAtom" transform="translate(518,-150) scale(0.707)" data-latex="{\\text{ring}}" data-mjx-texclass="ORD"><g data-mml-node="mtext" data-latex="\\text{ring}"><path data-c="72" d="M364 378C364 417 327 442 288 442C237 442 198 412 172 351L172 442L28 431L28 393C63 393 84 390 92 384C100 378 104 365 104 342L104 79C104 60 101 48 94 44C87 40 65 38 28 38L28 0L143 3C185 4 228 3 271 0L271 38L247 38C214 38 193 41 186 46C179 51 176 63 176 81L176 232C176 275 184 314 199 347C219 390 248 412 287 413C277 403 272 391 272 377C272 346 287 331 318 331C345 331 364 352 364 378Z"></path><path data-c="69" d="M194 601C194 631 169 657 139 657C109 657 83 631 83 601C83 571 108 544 138 544C169 544 194 570 194 601M143 3L247 0L247 39C214 39 194 41 188 45C182 49 180 60 180 78L180 445L37 433L37 395C70 395 91 392 98 387C105 382 108 368 108 345L108 79C108 60 105 48 98 44C91 40 69 39 33 39L33 0Z" transform="translate(392,0)"></path><path data-c="6E" d="M314 413C359 413 382 378 382 307L382 79C382 60 379 48 372 44C365 40 343 38 306 38L306 0L421 3L535 0L535 38C503 38 482 39 472 42C462 45 458 52 458 64L458 251C458 298 457 331 454 350C444 411 399 442 320 442C257 442 210 412 179 352L179 442L32 431L32 393C68 393 90 390 98 384C106 378 109 365 109 342L109 79C109 60 105 48 98 44C91 40 69 38 32 38L32 0L147 3L261 0L261 38C224 38 203 40 196 44C189 48 185 60 185 79L185 259C185 340 236 413 314 413Z" transform="translate(670,0)"></path><path data-c="67" d="M431 453C393 453 358 438 326 408C296 431 262 442 223 442C137 442 59 378 59 294C59 252 74 218 104 192C85 168 75 141 75 110C75 72 88 43 113 24C71 10 28-26 28-77C28-120 56-154 111-178C153-197 199-206 249-206C300-206 347-197 389-178C444-154 471-120 471-75C471-22 449 17 405 42C359 67 308 70 234 70C190 70 166 70 161 71C133 75 113 102 113 133C113 148 117 162 126 174C154 155 186 145 223 145C309 145 386 209 386 293C386 332 373 364 347 389C372 412 399 423 428 423C423 418 420 410 420 400C420 378 431 367 453 367C474 367 485 378 485 401C485 432 461 453 431 453M223 411C277 411 304 372 304 294C304 215 277 175 223 175C168 175 141 214 141 293C141 372 168 411 223 411M164 4L222 4C274 4 316 1 348-6C391-15 412-39 412-77C412-109 392-134 352-153C321-168 287-175 250-175C214-175 180-168 148-153C107-134 87-109 87-77C87-35 123 4 164 4Z" transform="translate(1226,0)"></path></g></g></g></g></g>',1)])]))]),s[185]||(s[185]=i(":",-1))]),s[221]||(s[221]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># run the simulation until t = T</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># check that the current time is t == T</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">1.01915960495538</span></span></code></pre></div><p>We can check that, as expected, the ring has crossed half the periodic box:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">displacement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prob</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> L</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">displacement[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># prints displacement of the first (and only) filament</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">16-element ClosedFilament{SVector{3, Float64}, QuinticSplineMethod}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [4.2541894038224303e-5, 3.6704695841689335e-9, 0.5096209800951895]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.939177912137546e-6, -1.0115871188946196e-5, 0.5095790816353369]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-2.9727611188456215e-5, -2.9730317279440295e-5, 0.5095371776375774]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-1.0115092604426837e-5, 3.933597751364935e-6, 0.509579073232987]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.670532205756662e-9, 4.253351681171916e-5, 0.5096209684327327]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.0122515852887059e-5, 3.933425880126983e-6, 0.5095790772297913]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.973520176741783e-5, -2.9730523405958957e-5, 0.5095371842145722]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-3.931726012922697e-6, -1.0115772743498869e-5, 0.50957908969423]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-4.253406751318857e-5, 3.6704700789218842e-9, 0.5096209887432396]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-3.931554145183356e-6, 1.0123195865938448e-5, 0.5095790936909744]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [2.9735407890119825e-5, 2.9738113856072765e-5, 0.5095371907914622]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [1.0122417408853311e-5, -3.925974107250834e-6, 0.5095790852885529]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.6705327711886055e-9, -4.2525690419895656e-5, 0.5096209770806394]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-1.0114994159262224e-5, -3.926145978700822e-6, 0.5095790812917494]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [-2.9727817310027347e-5, 2.9737907728246542e-5, 0.5095371842144695]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [3.939006044857619e-6, 1.0123294310184231e-5, 0.5095790856320818]</span></span></code></pre></div>`,5)),a("p",null,[s[188]||(s[188]=i("As we can see, the filament nodes have basically only moved in the ",-1)),a("mjx-container",Aa,[(t(),e("svg",Ba,[...s[186]||(s[186]=[a("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[a("g",{"data-mml-node":"math","data-latex":"z"},[a("g",{"data-mml-node":"mi","data-latex":"z"},[a("path",{"data-c":"1D467",d:"M162 92L145 90C193 137 230 171 255 194L351 283C374 304 398 330 421 359C452 397 467 420 467 428C467 437 462 442 452 442C445 442 439 438 434 429C409 388 386 368 364 368C342 368 326 386 317 398C293 427 269 442 246 442C220 442 193 430 165 404C137 378 123 352 123 326C123 316 128 311 139 311C146 311 152 316 156 325C167 354 194 368 235 368C249 368 269 363 296 354C320 345 343 340 364 339C308 284 265 244 234 217L145 134C130 119 111 99 90 74C59 35 43 12 43 3C43-6 48-11 59-11C65-11 71-6 78 4C103 43 130 63 158 63C174 63 192 51 212 26C232 1 255-11 278-11C312-11 346 7 382 42C418 77 436 111 436 144C436 153 431 158 420 158C413 158 407 153 402 143C387 100 344 63 288 63C264 63 186 92 162 92Z"})])])],-1)])]))]),s[189]||(s[189]=i(" direction by almost exactly ",-1)),a("mjx-container",Ta,[(t(),e("svg",Va,[...s[187]||(s[187]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="L / 2"><g data-mml-node="mi" data-latex="L"><path data-c="1D43F" d="M520 667C520 678 513 683 500 683L354 680L223 683C208 684 200 676 200 659C200 652 203 647 209 646C218 645 226 644 231 644C262 643 279 641 284 640C289 639 292 636 292 631C292 629 291 623 288 613L156 82C150 60 140 47 125 42C119 40 101 39 70 39C49 39 39 31 39 15C39 5 49 0 70 0L527 0C552 0 554 0 561 19L639 233C642 240 643 245 643 248C643 258 638 263 627 263C617 263 612 254 607 240C588 191 570 154 555 131C518 75 455 39 363 39L270 39C259 39 252 39 249 40C242 40 239 42 239 45C239 47 241 54 244 67L377 601C383 624 396 637 415 642C421 643 442 644 478 644C506 644 520 644 520 667Z"></path></g><g data-mml-node="mo" data-latex="/" transform="translate(681,0)"><path data-c="2F" d="M444 718C445 720 445 723 445 726C445 742 437 750 421 750C410 750 403 745 399 734L57-218C56-220 56-223 56-226C56-242 64-250 80-250C91-250 98-245 102-234Z"></path></g><g data-mml-node="mn" data-latex="2" transform="translate(1181,0)"><path data-c="32" d="M237 666C186 666 143 648 106 612C69 576 50 534 50 483C50 449 75 424 106 424C136 424 161 450 161 480C161 513 137 536 105 536C102 536 100 536 98 535C117 584 161 627 224 627C306 627 352 556 352 470C352 403 318 331 250 255L62 43C49 28 50 29 50 0L421 0L450 180L417 180C409 129 402 100 396 91C391 86 361 84 306 84L139 84L236 179C304 243 390 312 419 365C439 400 449 435 449 470C449 588 357 666 237 666Z"></path></g></g></g>',1)])]))]),s[190]||(s[190]=i(".",-1))]),s[222]||(s[222]=n('<h3 id="tutorial-vortex-ring-simulation-state" tabindex="-1">Accessing the instantaneous simulation state <a class="header-anchor" href="#tutorial-vortex-ring-simulation-state" aria-label="Permalink to &quot;Accessing the instantaneous simulation state {#tutorial-vortex-ring-simulation-state}&quot;">​</a></h3><p>Above we have simply run a simulation from start to finish, without caring about what happened in-between. In reality, one usually wants to be able to do things with the intermediate states, for instance, to track the evolution of the total vortex length, the energy, or simply to make nice movies.</p><p>There are two ways of doing this, both inspired by DifferentialEquations.jl (see <a href="https://docs.sciml.ai/DiffEqDocs/stable/basics/integrator/" target="_blank" rel="noreferrer">here</a> and <a href="https://docs.sciml.ai/DiffEqDocs/stable/features/callback_functions/#Using-Callbacks" target="_blank" rel="noreferrer">here</a>):</p><h4 id="1.-Using-the-integrator-interface" tabindex="-1">1. Using the integrator interface <a class="header-anchor" href="#1.-Using-the-integrator-interface" aria-label="Permalink to &quot;1. Using the integrator interface {#1.-Using-the-integrator-interface}&quot;">​</a></h4>',4)),a("p",null,[s[197]||(s[197]=i("This option is actually quite intuitive. The idea is to explicitly iterate timestep by timestep (typically using a ",-1)),s[198]||(s[198]=a("code",null,"for",-1)),s[199]||(s[199]=i(" or ",-1)),s[200]||(s[200]=a("code",null,"while",-1)),s[201]||(s[201]=i(" loop) until we decide it's time to stop. At each iteration we perform a simulation timestep (going from ",-1)),a("mjx-container",Ma,[(t(),e("svg",Sa,[...s[191]||(s[191]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="t_n"><g data-mml-node="msub" data-latex="t_n"><g data-mml-node="mi" data-latex="t"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)" data-latex="n"><path data-c="1D45B" d="M537 137C514 58 481 18 440 18C427 18 420 28 420 47C420 61 426 84 438 115C478 224 498 296 498 333C498 403 451 442 381 442C322 442 271 416 230 363C222 407 187 442 136 442C80 442 58 390 44 345C34 313 29 294 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C151 413 160 399 160 371C160 358 155 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 111-11C130-11 144-1 151 19C153 24 159 49 170 92L191 181L221 295C232 318 249 341 270 365C299 397 335 413 378 413C411 413 427 391 427 348C427 310 406 234 363 120C356 102 353 87 353 74C353 25 390-11 438-11C482-11 517 14 542 64C561 104 571 131 571 144C571 153 566 158 555 158C552 158 537 149 537 137Z"></path></g></g></g></g>',1)])]))]),s[202]||(s[202]=i(" to ",-1)),a("mjx-container",Pa,[(t(),e("svg",ja,[...s[192]||(s[192]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="t_{n + 1} = t_n + Δt"><g data-mml-node="msub" data-latex="t_{n+1}"><g data-mml-node="mi" data-latex="t"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="TeXAtom" transform="translate(394,-150) scale(0.707)" data-latex="{n+1}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="n"><path data-c="1D45B" d="M537 137C514 58 481 18 440 18C427 18 420 28 420 47C420 61 426 84 438 115C478 224 498 296 498 333C498 403 451 442 381 442C322 442 271 416 230 363C222 407 187 442 136 442C80 442 58 390 44 345C34 313 29 294 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C151 413 160 399 160 371C160 358 155 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 111-11C130-11 144-1 151 19C153 24 159 49 170 92L191 181L221 295C232 318 249 341 270 365C299 397 335 413 378 413C411 413 427 391 427 348C427 310 406 234 363 120C356 102 353 87 353 74C353 25 390-11 438-11C482-11 517 14 542 64C561 104 571 131 571 144C571 153 566 158 555 158C552 158 537 149 537 137Z"></path></g><g data-mml-node="mo" data-latex="+" transform="translate(600,0)"><path data-c="2B" d="M698 274L413 274L413 559C413 575 405 583 389 583C373 583 365 575 365 559L365 274L80 274C64 274 56 266 56 250C56 234 64 226 80 226L365 226L365-59C365-75 373-83 389-83C405-83 413-75 413-59L413 226L698 226C714 226 722 234 722 250C722 263 711 274 698 274Z"></path></g><g data-mml-node="mn" data-latex="1" transform="translate(1378,0)"><path data-c="31" d="M269 666C228 624 168 603 89 603L89 564C141 564 184 572 217 588L217 82C217 64 213 52 204 47C195 42 170 39 130 39L95 39L95 0C120 2 174 3 257 3C340 3 394 2 419 0L419 39L384 39C343 39 318 42 310 47C302 52 297 64 297 82L297 636C297 660 295 666 269 666Z"></path></g></g></g></g></g>',1)])])),s[195]||(s[195]=a("mjx-break",{size:"4"}," ",-1)),(t(),e("svg",Za,[...s[193]||(s[193]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="t_{n + 1} = t_n + Δt"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="msub" data-latex="t_n" transform="translate(1055.8,0)"><g data-mml-node="mi" data-latex="t"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)" data-latex="n"><path data-c="1D45B" d="M537 137C514 58 481 18 440 18C427 18 420 28 420 47C420 61 426 84 438 115C478 224 498 296 498 333C498 403 451 442 381 442C322 442 271 416 230 363C222 407 187 442 136 442C80 442 58 390 44 345C34 313 29 294 29 287C29 278 34 273 45 273C50 273 53 274 56 276C61 285 64 292 65 299C83 375 106 413 133 413C151 413 160 399 160 371C160 358 155 331 144 290L87 63C84 50 78 24 78 19C78-1 89-11 111-11C130-11 144-1 151 19C153 24 159 49 170 92L191 181L221 295C232 318 249 341 270 365C299 397 335 413 378 413C411 413 427 391 427 348C427 310 406 234 363 120C356 102 353 87 353 74C353 25 390-11 438-11C482-11 517 14 542 64C561 104 571 131 571 144C571 153 566 158 555 158C552 158 537 149 537 137Z"></path></g></g></g></g>',1)])])),s[196]||(s[196]=a("mjx-break",{size:"3"}," ",-1)),(t(),e("svg",Ia,[...s[194]||(s[194]=[n('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="t_{n + 1} = t_n + Δt"><g data-mml-node="mo" data-latex="+"><path data-c="2B" d="M698 274L413 274L413 559C413 575 405 583 389 583C373 583 365 575 365 559L365 274L80 274C64 274 56 266 56 250C56 234 64 226 80 226L365 226L365-59C365-75 373-83 389-83C405-83 413-75 413-59L413 226L698 226C714 226 722 234 722 250C722 263 711 274 698 274Z"></path></g><g data-mml-node="mi" data-latex="Δ" transform="translate(1000.2,0)"><path data-c="394" d="M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(1833.2,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g></g></g>',1)])]))]),s[203]||(s[203]=i("), and then we can do whatever we want with the instantaneous solution contained in ",-1)),s[204]||(s[204]=a("code",null,"iter",-1)),s[205]||(s[205]=i(".",-1))]),s[223]||(s[223]=n(`<p>Note that, in this case, the time span defined in the <a href="/VortexPasta.jl/dev/modules/Timestepping#VortexPasta.Timestepping.VortexFilamentProblem"><code>VortexFilamentProblem</code></a> is completely ignored, meaning that we can stop the simulation whenever we want.</p><p>To use this interface, we create the solver in the same way as before, and then we advance the solver one timestep at a time using <a href="/VortexPasta.jl/dev/modules/Timestepping#CommonSolve.step!"><code>step!</code></a>. For instance, we can choose to stop when we have performed 20 timesteps. And every 5 timestep we print some information:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RK4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); dt)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nstep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">≤</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Print the time and the mean location of the vortex ring every 5 solver iterations.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dt  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># avoid &quot;soft scope&quot; warning</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (; nstep, t, dt,) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nstep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Xavg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;- step = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$nstep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, t = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, dt = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$dt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;  Average ring location: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Xavg)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># run a single timestep</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 0, t = 0.0, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0, 3.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 5, t = 0.5026476479249479, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0000000003366756, 3.000000000336668, 1.390461016247372]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 10, t = 1.005295295849896, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.000000001381583, 3.000000001381552, 1.780921856183972]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 15, t = 1.5079429437748435, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.000000003146817, 3.00000000314675, 2.171383038539117]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 20, t = 2.010590591699791, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.000000005615942, 3.0000000056158282, 2.5618437401871037]</span></span></code></pre></div><h4 id="2.-Using-callbacks" tabindex="-1">2. Using callbacks <a class="header-anchor" href="#2.-Using-callbacks" aria-label="Permalink to &quot;2. Using callbacks {#2.-Using-callbacks}&quot;">​</a></h4><p>We can do the same using a callback. This is a function which gets called at each solver iteration with the current state of the solver.</p><p>The idea is to create such a function which receives a single <code>iter</code> argument. Then we tell <a href="/VortexPasta.jl/dev/modules/Timestepping#CommonSolve.init"><code>init</code></a> to use this function as a callback, and use <a href="/VortexPasta.jl/dev/modules/Timestepping#CommonSolve.solve!"><code>solve!</code></a> as we did earlier to run the simulation until the end time:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Prints the time and the mean location of the vortex ring every 5 solver iterations.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> print_solver_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (; nstep, t, dt,) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nstep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Xavg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;- step = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$nstep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, t = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, dt = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$dt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;  Average ring location: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Xavg)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RK4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); dt, callback </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> print_solver_info)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 0, t = 0.0, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0, 3.0, 1.0]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 5, t = 0.5026476479249479, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0000000003366756, 3.000000000336668, 1.390461016247372]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 10, t = 1.005295295849896, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.000000001381583, 3.000000001381552, 1.7809218561839721]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 15, t = 1.5079429437748435, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0000000031468166, 3.00000000314675, 2.171383038539117]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 20, t = 2.010590591699791, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0000000056159415, 3.0000000056158287, 2.5618437401871037]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 25, t = 2.5132382396247386, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0000000087604355, 3.000000008760268, 2.9523050310651238]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 30, t = 3.015885887549686, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0000000126110744, 3.0000000126108435, 3.3427656681942235]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 35, t = 3.5185335354746337, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.000000017188594, 3.000000017188291, 3.7332269777130396]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">- step = 40, t = 4.021181183399581, dt = 0.10052952958498958</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Average ring location: [3.0000000224639165, 3.000000022463531, 4.12368763982232]</span></span></code></pre></div><p>Note that the callback is also called once when the solver is initialised (when <code>nstep = 0</code>).</p><h3 id="Making-an-animation" tabindex="-1">Making an animation <a class="header-anchor" href="#Making-an-animation" aria-label="Permalink to &quot;Making an animation {#Making-an-animation}&quot;">​</a></h3><p>We can use either of the two methods above to create a video of the moving vortex. Here we will use Makie to create the animation. See the <a href="https://docs.makie.org/stable/explanations/animation/" target="_blank" rel="noreferrer">Makie docs on animations</a> for more details.</p><p>In this example we will use the integrator interface. We start by initialising the solver and creating a plot with to the initial condition:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prob, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RK4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); dt)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f_obs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Observable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># variable to be updated over time</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t_obs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Observable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># variable to be updated over time</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> @lift</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">t_obs)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hidespines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">box </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Rect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, L, L, L)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># periodic domain limits</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wireframe!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, box; color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:white</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, f_obs; markersize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, refinement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="`+o+`" alt=""></p><p>Note that we have wrapped the vortex ring filament <code>iter.fs[1]</code> in an <a href="https://docs.makie.org/stable/explanations/nodes/index.html#observables_interaction" target="_blank" rel="noreferrer"><code>Observable</code></a>. The plot will be automatically updated each time we modify this <code>Observable</code> object:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vortex_ring.mp4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> io</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    recordframe!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io)      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># add initial frame (initial condition) to movie</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        step!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(iter)       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># run a single timestep</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        notify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f_obs)     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># tell Makie that filament positions have been updated</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        t_obs[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># update displayed time</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        yield</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># allows to see the updated plot</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        recordframe!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># add current frame to movie</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div>`,17)),s[224]||(s[224]=a("p",null,[i("Note that here we have used "),a("a",{href:"https://docs.makie.org/stable/api/#record",target:"_blank",rel:"noreferrer"},[a("code",null,"record")]),i(" and "),a("a",{href:"https://docs.makie.org/stable/api/#recordframe!",target:"_blank",rel:"noreferrer"},[a("code",null,"recordframe!")]),i(" to generate a movie file, but these are not needed if one just wants to see things moving in real time as the simulation runs. "),a("video",{autoplay:"",loop:"",muted:"",playsinline:"",controls:"",src:C})],-1)),s[225]||(s[225]=n(`<h2 id="Saving-state-to-disk" tabindex="-1">Saving state to disk <a class="header-anchor" href="#Saving-state-to-disk" aria-label="Permalink to &quot;Saving state to disk {#Saving-state-to-disk}&quot;">​</a></h2><p>It is often useful to be able to save the solver state to disk, for instance to be able to restart a simulation from that state or to analyse the data. In VortexPasta this is possible using the <a href="/VortexPasta.jl/dev/modules/Timestepping#VortexPasta.Timestepping.save_checkpoint"><code>save_checkpoint</code></a> function (included in <code>VortexPasta.Timestepping</code>).</p><p>Data is written in the HDF5 format, which is a binary format that can be easily explored using command-line tools or the HDF5 interfaces available in many different programming languages. More precisely, data is written to <a href="https://docs.vtk.org/en/latest/design_documents/VTKFileFormats.html#vtkhdf-file-format" target="_blank" rel="noreferrer">VTKHDF files</a>, which are HDF5 files with a specific organisation that can be readily understood by visualisation tools such as ParaView. In other words, simulation outputs can be readily visualised without the need to convert them or to have a &quot;translation&quot; file explaining how to visualise the binary data.</p><div class="tip custom-block"><p class="custom-block-title">VTKHDF file extension</p><p>ParaView doesn&#39;t recognise the usual <code>.h5</code> file extension as a VTKHDF file. For this reason, it is recommended to use <code>.vtkhdf</code> if one wants to visualise the data.</p></div><h3 id="Writing-filament-data-and-reading-it-back" tabindex="-1">Writing filament data and reading it back <a class="header-anchor" href="#Writing-filament-data-and-reading-it-back" aria-label="Permalink to &quot;Writing filament data and reading it back {#Writing-filament-data-and-reading-it-back}&quot;">​</a></h3><p>We write filament locations and other solver data to disk:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_checkpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vortex_ring.vtkhdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, iter)</span></span></code></pre></div><p>This creates an HDF5 file with the following structure:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> h5ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vortex_ring.vtkhdf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                     Group</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                               Group</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Lines/Connectivity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Lines/NumberOfCells</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Lines/NumberOfConnectivityIds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Lines/Offsets</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/NumberOfPoints</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Points</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {17,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/RefinementLevel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {SCALAR}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[+ other stuff needed by ParaView...]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VortexPasta</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                          Group</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VortexPasta/BiotSavartParams</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         Group</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[...]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VortexPasta/VortexFilamentSolver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     Group</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[...]</span></span></code></pre></div><p>The filament locations and everything else to be visualised is written to a <code>/VTKHDF</code> group (which is some sort of subdirectory in the HDF5 file). In this case, we have a single cell which corresponds to our vortex ring (one VTK cell corresponds to one vortex filament). The important datasets here are <code>Points</code>, which contains the discretisation points of all filaments, and <code>Lines/Offsets</code>, which allows to identify which point corresponds to which vortex. See <a href="/VortexPasta.jl/dev/modules/FilamentIO#VortexPasta.FilamentIO.write_vtkhdf"><code>FilamentIO.write_vtkhdf</code></a> for more details.</p><p>There is also a <code>/VortexPasta</code> group with different subgroups. It contains Biot–Savart and solver parameters, as well as some of the solver state at the end of the simulation (time, timestep, ...).</p><p>The filament locations can be read back using <a href="/VortexPasta.jl/dev/modules/FilamentIO#VortexPasta.FilamentIO.read_vtkhdf"><code>FilamentIO.read_vtkhdf</code></a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> VortexPasta</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FilamentIO  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># includes read_vtkhdf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> read_vtkhdf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vortex_ring.vtkhdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Float64, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CubicSplineMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">true</span></span></code></pre></div><p>Alternatively, one can use <a href="/VortexPasta.jl/dev/modules/Timestepping#VortexPasta.Timestepping.load_checkpoint"><code>load_checkpoint</code></a>, which also loads part of the solver state:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">checkpoint </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> load_checkpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vortex_ring.vtkhdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Float64, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CubicSplineMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">checkpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">true</span></span></code></pre></div><h3 id="Visualising-VTKHDF-files" tabindex="-1">Visualising VTKHDF files <a class="header-anchor" href="#Visualising-VTKHDF-files" aria-label="Permalink to &quot;Visualising VTKHDF files {#Visualising-VTKHDF-files}&quot;">​</a></h3><p>Opening this file in ParaView should produce something like this:</p><p><img src="`+g+'" alt=""></p><p>Things look quite rough since, by default, we only export the discretisation points, which ParaView connects by straight lines. As with Makie plots, we can make things look nicer by passing the <code>refinement</code> argument:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_checkpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vortex_ring_refined.vtkhdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, iter; refinement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="'+m+`" alt=""></p><h3 id="Attaching-more-data" tabindex="-1">Attaching more data <a class="header-anchor" href="#Attaching-more-data" aria-label="Permalink to &quot;Attaching more data {#Attaching-more-data}&quot;">​</a></h3><p>It can also be useful to include other data associated to the filaments, such as the velocity of the discretisation points. One can also easily add geometric quantities along filaments (see <a href="/VortexPasta.jl/dev/modules/Filaments#VortexPasta.Filaments.GeometricQuantity"><code>GeometricQuantity</code></a> for a list of possible options).</p><p>As an example, we can save the positions, velocities, streamfunction, local curvature vector and time values corresponding to the final state of our last simulation:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_checkpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vortex_ring_with_data.vtkhdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, iter; refinement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> io</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    io[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;velocity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    io[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;streamfunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ψs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    io[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;curvatures&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CurvatureVector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># note: no need to explicitly compute curvatures!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    io[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>The HDF5 file structure now looks like:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> h5ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vortex_ring_with_data.vtkhdf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                     Group</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                               Group</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/FieldData</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     Group</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/FieldData/time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Lines/Connectivity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">65</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Lines/NumberOfCells</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Lines/NumberOfConnectivityIds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Lines/Offsets</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                 Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/NumberOfPoints</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/PointData</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     Group</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/PointData/curvatures</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {65,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/PointData/streamfunction</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {65,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/PointData/velocity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {65,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/Points</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {65,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VTKHDF/RefinementLevel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               Dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {SCALAR}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[...]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/VortexPasta</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[...]</span></span></code></pre></div><p>Note that a <code>PointData</code> group has been created with two datasets: <code>streamfunction</code> and <code>velocity</code>. These correspond to data attached to the filaments, and have the same dimensions as the <code>Points</code> dataset. These can be readily visualised in ParaView. Besides, a <code>FieldData</code> group has been created with the <code>time</code> dataset. In VTK, &quot;field data&quot; corresponds to values that are not directly attached to the geometry, such as scalar quantities in this case.</p><p>Loading the attached data is done in a similar way (see <a href="/VortexPasta.jl/dev/modules/FilamentIO#VortexPasta.FilamentIO.read_vtkhdf"><code>read_vtkhdf</code></a> for details):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vs_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(similar </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">∘</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nodes, fs)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ψs_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(similar </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">∘</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nodes, fs)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> read_vtkhdf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vortex_ring_with_data.vtkhdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Float64, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CubicSplineMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> io</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    read!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io, vs_read, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;velocity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    read!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io, ψs_read, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;streamfunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> read</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FieldData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), Float64)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># note: this is read as an array</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    @show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> t_read</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (fs_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs) (vs_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vs) (ψs_read </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ψs)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">t_read = [8.142891896384167]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">fs_read == iter.fs = true</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">vs_read == iter.vs = true</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ψs_read == iter.ψs = true</span></span></code></pre></div><p>Note that, when reading &quot;refined&quot; datasets, only the original discretisation points and data on them are read back. The points and data added in-between nodes for refinement purposes are discarded.</p><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p>`,36))])}const Ka=l(E,[["render",qa]]);export{Ha as __pageData,Ka as default};
