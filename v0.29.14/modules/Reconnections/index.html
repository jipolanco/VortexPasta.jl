<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reconnections · VortexPasta</title><meta name="title" content="Reconnections · VortexPasta"/><meta property="og:title" content="Reconnections · VortexPasta"/><meta property="twitter:title" content="Reconnections · VortexPasta"/><meta name="description" content="Documentation for VortexPasta."/><meta property="og:description" content="Documentation for VortexPasta."/><meta property="twitter:description" content="Documentation for VortexPasta."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/fonts.css" rel="stylesheet" type="text/css"/><script src="../../assets/sa.js" data-collect-dnt="true" async></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">VortexPasta</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">VortexPasta.jl</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/01-vortex_ring/">Vortex ring</a></li><li><a class="tocitem" href="../../tutorials/02-kelvin_waves/">Kelvin waves</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../methods/VFM/">The vortex filament model</a></li><li><a class="tocitem" href="../../methods/Ewald/">Ewald summation for Biot–Savart</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tips and tricks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tips/parallelisation/">Parallelisation and clusters</a></li><li><a class="tocitem" href="../../tips/gpu/">GPU usage</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Modules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../PaddedArrays/">PaddedArrays</a></li><li><a class="tocitem" href="../PredefinedCurves/">PredefinedCurves</a></li><li><a class="tocitem" href="../CellLists/">CellLists</a></li><li><a class="tocitem" href="../Quadratures/">Quadratures</a></li><li><a class="tocitem" href="../Filaments/">Filaments</a></li><li><a class="tocitem" href="../FilamentIO/">FilamentIO</a></li><li><a class="tocitem" href="../FindNearbySegments/">FindNearbySegments</a></li><li><a class="tocitem" href="../Constants/">Constants</a></li><li><a class="tocitem" href="../BiotSavart/">BiotSavart</a></li><li><a class="tocitem" href="../SyntheticFields/">SyntheticFields</a></li><li><a class="tocitem" href="../Forcing/">Forcing</a></li><li><a class="tocitem" href="../Containers/">Containers</a></li><li class="is-active"><a class="tocitem" href>Reconnections</a><ul class="internal"><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Reconnection-criteria"><span>Reconnection criteria</span></a></li><li><a class="tocitem" href="#Internals"><span>Internals</span></a></li></ul></li><li><a class="tocitem" href="../Timestepping/">Timestepping</a></li><li><a class="tocitem" href="../Diagnostics/">Diagnostics</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Modules</a></li><li class="is-active"><a href>Reconnections</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reconnections</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jipolanco/VortexPasta.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jipolanco/VortexPasta.jl/blob/master/docs/src/modules/Reconnections.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reconnections"><a class="docs-heading-anchor" href="#Reconnections">Reconnections</a><a id="Reconnections-1"></a><a class="docs-heading-anchor-permalink" href="#Reconnections" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Reconnections" href="#VortexPasta.Reconnections"><code>VortexPasta.Reconnections</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Reconnections</code></pre><p>Module for dealing with the reconnection of filaments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/441a989a16ecf98015c12b44570f56eb2fc15ea6/src/Reconnections/Reconnections.jl#L1-L5">source</a></section></article><p>Reconnections are generally performed by choosing a <a href="#Reconnection-criteria">reconnection criterion</a> and then calling <a href="#VortexPasta.Reconnections.reconnect!"><code>reconnect!</code></a>.</p><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Reconnections.init_cache" href="#VortexPasta.Reconnections.init_cache"><code>VortexPasta.Reconnections.init_cache</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Reconnections.init_cache(
    crit::ReconnectionCriterion,
    fs::AbstractVector{&lt;:AbstractFilament},
    Ls::NTuple{3, Real} = (Infinity(), Infinity(), Infinity()),
) -&gt; AbstractReconnectionCache</code></pre><p>Initialise reconnection cache.</p><p>Required arguments are a reconnection criterion <code>crit</code> and the domain dimensions (or <em>periods</em>) <code>Ls</code>. The type of cache will vary depending on the chosen reconnection criterion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/441a989a16ecf98015c12b44570f56eb2fc15ea6/src/Reconnections/Reconnections.jl#L60-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Reconnections.reconnect!" href="#VortexPasta.Reconnections.reconnect!"><code>VortexPasta.Reconnections.reconnect!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reconnect!(
    [callback::Function],
    cache::AbstractReconnectionCache,
    fs::AbstractVector{&lt;:AbstractFilament},
    [vs::AbstractVector{&lt;:AbstractVector}],
) -&gt; NamedTuple</code></pre><p>Perform filament reconnections according to chosen criterion.</p><p>Note that, when a filament self-reconnects, this creates new filaments, which are appended at the end of <code>fs</code>.</p><p>Moreover, this function will remove reconnected filaments if their number of nodes is too small (typically <span>$&lt; 3$</span>, see <a href="../Filaments/#VortexPasta.Filaments.check_nodes"><code>check_nodes</code></a>).</p><p>Optionally, <code>vs</code> can be a vector containing all instantaneous filament velocities. In this case, this will be used to discard reconnections between filaments which are moving in opposite directions. This is required if the <a href="#VortexPasta.Reconnections.ReconnectBasedOnDistance"><code>ReconnectBasedOnDistance</code></a> criterion is used with its option <code>use_velocity = true</code> (default if <code>max_passes = 1</code>).</p><p><strong>Returns</strong></p><p>This function returns a <code>NamedTuple</code> with fields:</p><ul><li><p><code>reconnection_count</code>: <strong>number of reconnections</strong>;</p></li><li><p><code>reconnection_length_loss</code>: <strong>decrease of filament length due to reconnections</strong>. This is simply an estimate for the difference in filament length before and after a reconnection. It is unrelated to (and does not include) filament removal (see below). Uses the straight segment approximation;</p></li><li><p><code>filaments_removed_count</code>: <strong>number of filaments removed after reconnection</strong>. This happens when a filament reconnects with itself, splitting into two new filaments, and one or both of these filaments have an insufficient number of discretisation nodes;</p></li><li><p><code>filaments_removed_length</code>: <strong>length of removed filaments</strong>. We use a straight segment approximation (no quadratures) to estimate the filament lengths.</p></li></ul><p><strong>Callback function</strong></p><p>Optionally, one may pass a callback which will be called whenever the vector of filaments <code>fs</code> is modified. Its signature must be the following:</p><pre><code class="nohighlight hljs">callback(f::AbstractFilament, i::Int, mode::Symbol)</code></pre><p>where <code>f</code> is the modified filament, <code>i</code> is its index in <code>fs</code>, and <code>mode</code> is one of:</p><ul><li><code>:modified</code> if the filament <code>fs[i]</code> was modified;</li><li><code>:appended</code> if the filament was appended at the end of <code>fs</code> (at index <code>i</code>);</li><li><code>:removed</code> if the filament previously located at index <code>i</code> was removed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/441a989a16ecf98015c12b44570f56eb2fc15ea6/src/Reconnections/Reconnections.jl#L91-L143">source</a></section></article><h2 id="Reconnection-criteria"><a class="docs-heading-anchor" href="#Reconnection-criteria">Reconnection criteria</a><a id="Reconnection-criteria-1"></a><a class="docs-heading-anchor-permalink" href="#Reconnection-criteria" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Reconnections.ReconnectionCriterion" href="#VortexPasta.Reconnections.ReconnectionCriterion"><code>VortexPasta.Reconnections.ReconnectionCriterion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReconnectionCriterion</code></pre><p>Abstract type describing a criterion for filament reconnections.</p><p>Implemented reconnection criteria include:</p><ul><li><p><a href="#VortexPasta.Reconnections.NoReconnections"><code>NoReconnections</code></a>: disables reconnections;</p></li><li><p><a href="#VortexPasta.Reconnections.ReconnectBasedOnDistance"><code>ReconnectBasedOnDistance</code></a>: reconnects filament segments which are closer than a critical distance;</p></li><li><p><a href="#VortexPasta.Reconnections.ReconnectFast"><code>ReconnectFast</code></a>: considers segments as straight lines, enabling to perform all required reconnections in a single pass.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/441a989a16ecf98015c12b44570f56eb2fc15ea6/src/Reconnections/Reconnections.jl#L39-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Reconnections.NoReconnections" href="#VortexPasta.Reconnections.NoReconnections"><code>VortexPasta.Reconnections.NoReconnections</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NoReconnections &lt;: ReconnectionCriterion</code></pre><p>Used to disable filament reconnections.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/441a989a16ecf98015c12b44570f56eb2fc15ea6/src/Reconnections/criteria/no_reconnections.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Reconnections.ReconnectBasedOnDistance" href="#VortexPasta.Reconnections.ReconnectBasedOnDistance"><code>VortexPasta.Reconnections.ReconnectBasedOnDistance</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReconnectBasedOnDistance &lt;: ReconnectionCriterion
ReconnectBasedOnDistance(d_crit; max_passes = 1, use_velocity = (max_passes == 1), decrease_length = true, cos_max = 0.97)</code></pre><p>Reconnects filament segments which are at a distance <code>d &lt; d_crit</code>.</p><p><strong>Optional keyword arguments</strong></p><ul><li><p><code>use_velocity</code>: if <code>true</code> (default), use filament velocity information in reconnections. For now, this is used to discard a reconnection between two points if they are instantaneously getting away from each other. If <code>max_passes &gt; 1</code>, then <code>use_velocity</code> <strong>must</strong> be set to <code>false</code>.</p></li><li><p><code>max_passes</code>: maximum number of scans through all segment pairs to detect and perform reconnections. In a single pass, a filament can only be reconnected at most once. Therefore, this parameter can be useful to make sure that all required reconnections have been performed. <strong>Setting <code>max_passes &gt; 1</code> also requires <code>use_velocity = false</code>.</strong></p></li><li><p><code>decrease_length</code>: if <code>true</code> (default), a reconnection will only be performed if it will decrease the total filament length. Since, for vortices, the total energy is roughly related to the vortex length, this means that reconnections should always tend to dissipate energy.</p></li><li><p><code>cos_max</code>: allows to disable reconnections of nearly parallel segments. Two segments are considered to be &quot;nearly parallel&quot; if <code>cos(θ) &gt; cos_max</code>. The default value <code>cos_max = 0.97</code> disables reconnections when the angle between lines is <span>$θ &lt; \arccos(0.97) ≈ 14°$</span>. Note that the angle <span>$θ$</span> is signed (it takes values in <span>$[-1, 1]$</span>). Negative angles mean that the segments are antiparallel, and in this case reconnections are always performed.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/441a989a16ecf98015c12b44570f56eb2fc15ea6/src/Reconnections/criteria/based_on_distance.jl#L12-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Reconnections.ReconnectFast" href="#VortexPasta.Reconnections.ReconnectFast"><code>VortexPasta.Reconnections.ReconnectFast</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReconnectFast &lt;: ReconnectionCriterion
ReconnectFast(d_crit; max_passes = 1, nthreads = Threads.nthreads(), use_velocity = false, decrease_length = true, cos_max = 0.97)</code></pre><p>Reconnects filament segments which are at a distance <code>d &lt; d_crit</code>.</p><p>This criterion is similar to <a href="#VortexPasta.Reconnections.ReconnectBasedOnDistance"><code>ReconnectBasedOnDistance</code></a> but with important differences:</p><ul><li><p>filament segments are considered as straight lines (which may be less accurate);</p></li><li><p>each filament can be reconnected multiple times, meaning that fewer passes are needed to perform all required reconnections;</p></li><li><p>one can combine <code>use_velocity = true</code> with <code>max_passes &gt; 1</code>.</p></li></ul><p>Moreover, this criterion accepts an <code>nthreads</code> option which allows to manually choose the number of threads to use. In particular, if <code>nthreads = 1</code>, a serial implementation will be used which generally needs a small number of passes (so it can in fact be faster if running with a small number of threads).</p><p>This criterion only supports periodic domains.</p><p>See <a href="#VortexPasta.Reconnections.ReconnectBasedOnDistance"><code>ReconnectBasedOnDistance</code></a> for details on criterion parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/441a989a16ecf98015c12b44570f56eb2fc15ea6/src/Reconnections/criteria/reconnect_fast.jl#L4-L26">source</a></section></article><h2 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="VortexPasta.Reconnections.should_reconnect" href="#VortexPasta.Reconnections.should_reconnect"><code>VortexPasta.Reconnections.should_reconnect</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">should_reconnect(
    c::ReconnectBasedOnDistance,
    fx::AbstractFilament, fy::AbstractFilament, i::Int, j::Int;
    periods,
) -&gt; Union{Nothing, NamedTuple}</code></pre><p>Check whether two filaments should reconnect according to the chosen criterion.</p><p>Checks for a possible reconnection between filament segments <code>fx[i:i+1]</code> and <code>fy[j:j+1]</code>.</p><p>If the filament segments should reconnect, this function returns a <code>NamedTuple</code> with reconnection information, which includes in particular all the fields returned by <a href="../Filaments/#VortexPasta.Filaments.find_min_distance"><code>find_min_distance</code></a>.</p><p>Otherwise, returns <code>nothing</code> if the filament segments should not reconnect.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jipolanco/VortexPasta.jl/blob/441a989a16ecf98015c12b44570f56eb2fc15ea6/src/Reconnections/criteria/based_on_distance.jl#L64-L80">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Containers/">« Containers</a><a class="docs-footer-nextpage" href="../Timestepping/">Timestepping »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 17 September 2025 10:18">Wednesday 17 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
